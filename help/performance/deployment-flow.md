---
title: デプロイメントフロー
description: 実稼動環境にAdobe Commerceをデプロイするために必要な手順について説明します。
feature: Best Practices, Deploy
exl-id: 88da0b1b-5aa7-4f1c-9d01-ae58324b2754
source-git-commit: ddf988826c29b4ebf054a4d4fb5f4c285662ef4e
workflow-type: tm+mt
source-wordcount: '467'
ht-degree: 0%

---

# デプロイメントフロー

この [!DNL Commerce] 実稼動デプロイメントフローは、ストアが最大パフォーマンスに到達するのに役立ちます。

## 依存関係のインストール

この `composer.json` および `composer.lock` ファイル管理 [!DNL Commerce] 依存関係を作成し、各パッケージに適したバージョンをインストールする。 前に依存関係をインストールしてください [依存関係挿入命令の前処理](#preprocess-dependency-injection-instructions) を更新する場合 [オートローダー](#update-the-autoloader).

をインストールするには [!DNL Commerce] 依存関係：

```bash
composer install --no-dev
```

## 依存関係挿入手順の前処理

依存関係の挿入（DI）手順を前処理してコンパイルする場合、Magentoは次の操作を実行します。

* 現在のすべての設定を読み取って処理します
* クラス間の依存関係を分析します
* 自動生成されたファイル（プロキシ、ファクトリなどを含む）を作成
* コンパイル済みのデータと設定をキャッシュに格納することで、リクエストの処理に最大 25% の時間を節約

DI 命令を前処理およびコンパイルする手順は、次のとおりです。

```bash
bin/magento setup:di:compile
```

## オートローダーの更新

コンパイルが完了したら、次のことを確認します [APCu は有効です](../performance/software.md#php-settings) オートローダーを更新します。

オートローダーを更新するには：

>[!INFO]
>
>この `-o` オプションは PSR-0/4 自動読み込みをクラスマップに変換して、より高速なオートローダーを実現します。 この `--apcu` オプションは、見つかった/見つからなかったクラスをキャッシュするために APCu を使用します。

```bash
composer dump-autoload -o --apcu
```

オートローダーを更新する場合は、次のコマンドを順番に実行する必要があります。

```bash
composer install --no-dev
```

```bash
bin/magento setup:di:compile
```

```bash
composer dump-autoload -o
```

```bash
bin/magento setup:static-content:deploy
```

## 静的コンテンツのデプロイ

静的コンテンツのデプロイが原因 [!DNL Commerce] 次の操作を実行します。

* すべての静的リソースの分析
* コンテンツの結合、最小化およびバンドルの実行
* テーマデータの読み取りと処理
* テーマのフォールバックの分析
* さらに使用するために、処理および具体化されたすべてのコンテンツを特定のフォルダーに保存します

静的コンテンツがデプロイされていない場合は、 [!DNL Commerce] リストされているすべての操作をその場で実行し、応答時間が大幅に増加します。

様々なオプションを使用して、ストアのサイズとフルフィルメントのニーズに基づいてデプロイメント操作をカスタマイズできます。 最も一般的なのは、コンパクトなデプロイ戦略です。 参照： [静的ファイルのデプロイメント戦略](../configuration/cli/static-view-file-strategy.md)

静的コンテンツをデプロイするには：

```bash
bin/magento setup:static-content:deploy
```

このコマンドを使用すると、Composer はプロジェクト ファイルへのマッピングを再構築して、ファイルのロードを高速化できます。

## 実稼動モードを設定

>[!INFO]
>
>モードを実稼動環境に設定すると、自動的に実行されます `setup:di:compile` および `setup:static-content:deploy`.

最後に、ストアを実稼動モードに設定する必要があります。 実稼動モードは、ストアのパフォーマンスを最大限に高めるために特別に最適化されています。 また、開発者固有の機能がすべて非アクティブになります。 これは、 `.htaccess` または `nginx.conf` ファイル：

`SetEnv MAGE_MODE production`

また、静的なコンテンツをデプロイし、コンテンツをコンパイルして、1 つの CLI コマンドでモードを設定することもできます。

```bash
bin/magento deploy:mode:set production
```

コマンドはバックグラウンドで実行されるので、特定の手順ごとに追加のオプションを設定することはできません。

## その他のローンチ前のアクション

これらの手順は推奨されますが、必須ではありません。 実稼動モードでストアを起動する直前に実行できます。 リストには、次が含まれます。

* インデックスに一貫性のないデータが存在しないように、データのインデックスを再作成します。
* キャッシュをフラッシュして、古いデータや間違ったデータがキャッシュに残らないようにします。
* 最も人気のあるまたは重要なストアページを事前に呼び出すキャッシュをウォームアップして、それらのキャッシュが生成および保存されます。 この操作は、任意のインターネットクローラーで、または小さな店舗がある場合は手動で実行できます。
