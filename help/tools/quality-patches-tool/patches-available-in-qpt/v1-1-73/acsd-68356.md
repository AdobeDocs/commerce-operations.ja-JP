---
title: 'ACSD-68356: [!DNL GraphQL] cart クエリで、仮想引用符に対して誤った割引額が返される'
description: ACSD-68356 パッチを適用すると、Adobe Commerceの問題を修正できます。この問題では、買い物かごクエリが  [!DNL GraphQL]  仮想見積もりについて誤った割引額を返します。
feature: Shopping Cart, GraphQL
role: Admin, Developer
type: Troubleshooting
source-git-commit: de86326804ad0d27b3580d9cede964a59bfa77fe
workflow-type: tm+mt
source-wordcount: '338'
ht-degree: 0%

---

# ACSD-68356：買い物かごクエリ [!DNL GraphQL]、仮想の引用符に対して誤った割引額を返す

ACSD-68356 パッチを適用すると、買い物かごクエリが仮想見積もり [!DNL GraphQL] 対して誤った割引額を返す問題が修正されます。 このパッチは、[[!DNL Quality Patches Tool (QPT)]](/help/tools/quality-patches-tool/quality-patches-tool-to-self-serve-quality-patches.md) 1.1.73 がインストールされている場合に使用できます。 パッチ ID は ACSD-68356 です。 この問題はAdobe Commerce 2.4.9 で修正される予定であることに注意してください。

## 影響を受ける製品とバージョン

**Adobe Commerce バージョン用のパッチが作成されます。**

* Adobe Commerce（すべてのデプロイメント方法） 2.4.8-p2

**Adobe Commerce バージョンとの互換性：**

* Adobe Commerce（すべてのデプロイメント方法） 2.4.8 - 2.4.8-p3

>[!NOTE]
>
>このパッチは、新しい [!DNL Quality Patches Tool] リリースを含む他のバージョンにも適用される可能性があります。 パッチがAdobe Commerceのバージョンと互換性があるかどうかを確認するには、`magento/quality-patches` パッケージを最新バージョンに更新し、[[!DNL Quality Patches Tool]: Search for patches page](https://experienceleague.adobe.com/tools/commerce-quality-patches/index.html?lang=ja) で互換性を確認します。 パッチ ID を検索キーワードとして使用して、パッチを見つけます。

## 問題

買い物かごクエリ [!DNL GraphQL]、仮想見積に対して誤った割引額を返し、不適格な仮想製品に割引を適用します。

<u> 再現手順 </u>:

1. 次の 2 つの仮想製品を作成します。
   1. `virtual1` SKU
   1. `virtual2` SKU
1. 買い物かご価格ルールを作成します。
   1. クーポンなしで自動的に適用するように設定します。
   1. アクション：
   1. 製品価格割引の割合 – 20%。
   1. SKU が `virtual2` 定されている買い物かご項目にのみ適用されます。
1. ストアフロントを通じて、新しい空の引用符に製品を追加します。
   1. 最初に SKU`virtual1` 追加します。
   1. SKU を 2 番目 `virtual2` 追加します。
1. 次の [!DNL GraphQL] クエリを使用して、買い物かごの詳細を取得します。

   ```
   {
     cart(cart_id: "cart_id") {
       email
       itemsV2 {
         total_count
         items {
           uid
           prices {
             total_item_discount {
               value
             }
             price {
               value
             }
             discounts {
               label
               amount {
                 value
               }
             }
           }
           product {
             name
             sku
           }
           quantity
         },
         page_info {
             page_size
             current_page
             total_pages
         }
       }
       applied_coupons {
         code
       }
       prices {
         discounts {
           amount {
             value
           }
           applied_to
           label
         }
         grand_total {
           value
         }
       }
     }
   }
   ```

1. **[!UICONTROL cart]**/**[!UICONTROL items]**/**[!UICONTROL prices]**/**[!UICONTROL discounts]** をチェックします。

<u> 期待される結果 </u>:

* SKU`virtual1` は、[!DNL GraphQL] にリストされている割引はありません
* `virtual2` SKU に [!DNL GraphQL] にリストされている割引があります

<u> 実際の結果 </u>:

* `virtual1` と `virtual2` は、[!DNL GraphQL] 応答で同じ割引額を誤って表示します。

## パッチの適用

個々のパッチを適用するには、デプロイメント方法に応じて、次のリンクを使用します。

* Adobe CommerceまたはMagento Open Source オンプレミス：[[!DNL Quality Patches Tool] > 使用状況 &#x200B;](/help/tools/quality-patches-tool/usage.md) [!DNL Quality Patches Tool] ガイドに記載されています。
* クラウドインフラストラクチャー上のAdobe Commerce：クラウドインフラストラクチャー上のCommerce ガイドの [&#x200B; アップグレードとパッチ &#x200B;](https://experienceleague.adobe.com/docs/commerce-cloud-service/user-guide/develop/upgrade/apply-patches.html?lang=ja)/ パッチの適用」を参照してください。

## 関連資料

[!DNL Quality Patches Tool] について詳しくは、以下を参照してください。

* [[!DNL Quality Patches Tool]: 『ツールガイド』にあるクオリティパッチ &#x200B;](/help/tools/quality-patches-tool/quality-patches-tool-to-self-serve-quality-patches.md) セルフサービスツール。
