---
title: データ移行計画の作成
description: Magento 1 からMagento 2 にアップグレードするためのデータ移行プランを作成する方法を説明します。 問題を回避するために、移行を計画およびテストします。
exl-id: a14237f3-c5fe-4f5f-86eb-ed4c39507bff
topic: Commerce, Migration
source-git-commit: 6896d31a202957d7354c3dd5eb6459eda426e8d7
workflow-type: tm+mt
source-wordcount: '889'
ht-degree: 0%

---

# データ移行計画の作成

正常に移行し問題を回避するには、十分に計画して移行をテストする必要があります。

## 開始する前に：アップグレードを検討する

移行は、重大な変更を加え、次のレベルの成長に向けてサイトを準備するための良い機会です。 新しいサイトを追加のハードウェアで設計するか、より優れたキャッシュ層を持つより高度なトポロジで設計する必要があるかを検討します。

## 手順 1：現在のサイトで拡張機能を確認する

* どの拡張機能をインストールしましたか？

* 新しいサイトでこれらの拡張機能がすべて必要かどうかを特定しましたか？ 安全に削除できる古いバージョンが存在する可能性があります。

* お使いの拡張機能にMagento 2 バージョンが存在するかどうかを確認しましたか？ [Commerce Marketplace](https://commercemarketplace.adobe.com/) にアクセスして最新バージョンを確認するか、拡張機能プロバイダーにお問い合わせください。

* 拡張機能のどのデータベースアセットを移行しますか？

## 手順 2：ストアを構築して移行の準備をする

* 既存のMagento 1 システムと少なくとも一致するトポロジおよびデザインを使用して、Magento 2 ハードウェアシステムをセットアップします

* [!DNL Data Migration Tool] 必要システム構成 [ を満たすシステムに、Magento 2 （このリリースのすべてのモジュールを含む）および ](../../installation/system-requirements.md) をインストールします

* [!DNL Data Migration Tool] コードをカスタマイズして、特定のデータ（CMS ページ、営業ルールなど）をスキップしたり、移行中にカスタマイズを変換したりします。 移行の仕組みについて詳しくは、[!DNL Data Migration Tool] の [ 技術仕様 ](technical-specification.md) を参照してください

## 手順 3：ドライラン

実稼動環境で移行を開始する前に、テスト環境でのすべての移行手順を完了します。

移行テストでは、次の手順に従います。

* Magento 1 ストアをステージングサーバーにコピーします

* レプリケートされたMagento 1 ストアのMagento 2 への完全移行

* 新しいストアを徹底的にテストする

## 手順 4：移行の開始

1. [!DNL Data Migration Tool] に、Magento 1 およびMagento 2 データベースに接続するためのネットワークアクセスがあることを確認します。 対応するポートをファイアウォールで開きます。

1. Magento 1 管理パネル内のすべてのアクティビティ（Order Managementを除く）を停止します。例えば、配送、請求書の作成、クレジットメモなどです。 許可されるアクティビティのリストを拡張するには、リストで差分モードの設定を調整し [!DNL Data Migration Tool] す。

   >[!NOTE]
   >
   >Magento 2 ストアが公開されるまで、これらのアクティビティを再開しないでください。

1. Magento 1 cron ジョブをすべて停止することをお勧めします。

   移行中に一部のジョブを実行する必要がある場合は、デルタモードで処理できないような方法でデータベースエンティティが作成または変更されないようにしてください。

   例えば、`enterprise_salesarchive_archive_orders` cron ジョブは、古い注文をアーカイブに移動します。 差分モードでこのジョブを認識し、アーカイブされた注文を適切に処理するため、移行中にこのジョブを実行しても安全です。

1. [!DNL Data Migration Tool] を使用して、設定と web サイトを移行します。

1. Magento 1 メディアファイルをMagento 2 にコピーします。

   これらのファイルを `magento1-root/media` ディレクトリから `magento2-root/pub/media` に手動でコピーします。

1. [!DNL Data Migration Tool] を使用して、Magento 1 データベースからMagento 2 データベースにデータを一括コピーします。

   一部の拡張機能に移行するデータがある場合は、Magento 2 に適合したこれらの拡張機能をインストールする必要がある可能性があります。 Magento 2 データベース内で拡張機能の構造が異なる場合は、[!DNL Data Migration Tool] に用意されているマッピングファイルを使用します。

1. すべてのMagento 2 インデクサーのインデックスを再作成します。 詳しくは、『 [ 設定ガイド ](../../configuration/cli/manage-indexers.md) の _インデクサーの管理_ を参照してください。

## 手順 5：移行したデータに変更を加える（必要な場合）

場合によっては、移行後に、Magento 2 ストアを別のカタログ構造、販売ルール、CMS ページに設定する必要があります。

手動でデータを変更する場合は、注意が必要です。 エラーが発生すると、その後の増分データ移行手順でエラーが発生します。

例えば、Magento 2 から削除された商品について考えてみます。この商品は、ライブのMagento 1 ストアで購入され、Magento 2 ストアでは使用できなくなりました。 このような購入に関するデータを転送すると、[!DNL Data Migration Tool] を差分モードで実行する際にエラーが発生する場合があります。

## 手順 6：増分データの更新

データの移行後、差分モードを使用して、Magento 1 からMagento 2 に増分更新（新規注文、レビュー、顧客プロファイルの変更など）をキャプチャして転送します。

* 増分移行を開始します。更新は継続的に実行されます。 `Ctrl+C` キーを押すと、いつでも更新の転送を停止できます。

* この間にMagento 2 サイトをテストして、問題をできるだけ早く特定します。 問題が発生した場合は、`Ctrl+C` キーを押して増分移行を停止し、問題を解決した後で再開してください。

>[!NOTE]
>
>Magento 2 サイトのテストを実施し、移行プロセスを同時に実行すると、ボリュームチェックの警告が表示される場合があります。 この問題が発生するのは、Magento 2 で、Magento 1 インスタンスに存在しないエンティティを作成するためです。

## 手順 7：運用開始

Magento 2 サイトが完全に移行され、正常に機能したら、カットオーバーを完了します。

1. Magento 1 システムをメンテナンスモードにします（ダウンタイム開始）。

1. 移行ツールのコマンドウィンドウで Control + C キーを押して、増分更新を停止します。

1. Magento 2 cron ジョブを開始します。

1. Magento 2 システムで、Stock インデクサーのインデックスを再作成します。 詳しくは、『 [ 設定ガイド ](../../configuration/cli/manage-indexers.md) の _インデクサーの管理_ を参照してください。

1. 任意のツールを使用して、Magento 2 システムでページをヒットすると、ストアフロントを使用するお客様の前にページがキャッシュされます。

1. Magento 2 サイトの最終検証を行います。

1. DNS、ロードバランサーなどを変更して、新しい実稼動ハードウェアを指すようにします（ダウンタイム終了）。

1. これで、Magento 2 ストアが使用できるようになりました。 ユーザーとその顧客は、すべてのアクティビティを再開できます。
