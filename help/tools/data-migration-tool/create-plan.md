---
title: データ移行プランの作成
description: 次の手順に従って、データ移行計画を作成し、Magento1 からMagento2 へのアップグレードを確実に成功させます。
source-git-commit: d263e412022a89255b7d33b267b696a8bb1bc8a2
workflow-type: tm+mt
source-wordcount: '902'
ht-degree: 0%

---


# データ移行プランの作成

問題を正常に移行して回避するには、移行を十分に計画し、テストする必要があります。

## 事前準備：アップグレードを検討

移行は、深刻な変更を加え、サイトを次のレベルの成長に備える最適な瞬間です。 新しいサイトで、より多くのハードウェアを使用して設計する必要があるか、より高度なトポロジを使用してより優れたキャッシュ層を構築する必要があるかを検討します。

## 手順 1:現在のサイトでの拡張機能の確認

* どの拡張機能がインストールされていますか？

* 新しいサイトでこれらの拡張機能がすべて必要かどうかを特定しているか。 安全に取り外せる古いものがあるかもしれません。

* 拡張機能のMagento2 バージョンが存在するかどうかを確認したか。 訪問 [Commerce Marketplace] 最新バージョンを見つけるには、拡張機能プロバイダーにお問い合わせください。

* 拡張機能のどのデータベースアセットを移行しますか？

## 手順 2:ストアをビルドして移行の準備をします

* 既存のMagento1 システムと少なくとも一致するトポロジと設計を使用して、Magento2 ハードウェアシステムをセットアップします

* Magento2.x（このリリースのすべてのモジュール）と [!DNL Data Migration Tool] に会うシステムで [Magentoの必要システム構成]

* カスタムで [!DNL Data Migration Tool] 一部のデータ（CMS ページ、セールスルールなど）を移行する必要がない場合や、移行中にMagentoのカスタマイズを変換する場合に使用するコード。 詳しくは、 [!DNL Data Migration Tool]&#39;s [技術仕様](technical-specification.md) 移行が内部からどのように動作するかをより深く理解する

## 手順 3:ドライラン

実稼動環境で移行を開始する前に、テスト環境ですべての移行手順を実行することをお勧めします。

このような移行テストでは、次の手順に従います。

* Magento1 ストアをステージングサーバーにコピーする

* レプリケートされたMagento1 ストアをMagento2 に完全に移行

* 新しいストアを十分にテストします

## 手順 4:移行を開始

1. 必ず [!DNL Data Migration Tool] は、Magento1 およびMagento2 データベースに接続するためのネットワークアクセス権を持ちます。 ファイアウォールの対応するポートを開きます。

1. Magento1.x の管理パネルで、発送、請求書の作成、クレジットメモなど、すべてのアクティビティを停止します（オーダー管理を除く）。 許可されたアクティビティのリストは、 [!DNL Data Migration Tool].

   >[!NOTE]
   >
   >Magento2 のストアがライブになるまで、これらのアクティビティを再開しないでください。

1. すべてのMagento1.x の cron ジョブを停止することをお勧めします。

   ただし、移行中に一部のジョブを実行する必要がある場合は、新しいデータベースエンティティを作成しないようにするか、既存のエンティティを変更して、差分モードで処理できないようにしてください。

   例えば、 `enterprise_salesarchive_archive_orders` cron ジョブは古い注文をアーカイブに移動します。 差分モードでこのジョブが認識され、アーカイブされたオーダーが適切に処理されるので、移行中にこのジョブを実行しても安全です。

1. 以下を使用： [!DNL Data Migration Tool] 設定と web サイトを移行するには

1. Magento1.x のメディアファイルをMagento2.x にコピーします。

   これらのファイルは、 `magento1-root/media` ディレクトリ `magento2-root/pub/media`.

1. 以下を使用： [!DNL Data Migration Tool] データをMagento1 データベースからMagento2 データベースに一括コピーするには

   一部の拡張機能に移行するデータが含まれている場合は、Magento2 に適合したこれらの拡張機能をインストールする必要が生じる場合があります。 Magento2 データベースで拡張子の構造が異なる場合は、 [!DNL Data Migration Tool].

1. すべてのMagento2.x のインデクサーを再インデックス化します。 詳しくは、 [設定ガイド].

## 手順 5:移行されたデータに変更を加えます（必要に応じて）。

移行後に、Magento2 のストアを異なるカタログ構造、販売ルール、CMS ページで使用する必要が生じる場合があります。

手動でデータを変更する際は注意が必要です。 エラーは、次の増分データ移行手順でエラーを作成します。

例えば、Magento2 から削除された製品の場合：ライブMagento1 のストアで購入され、Magento2 のストアでは使用できなくなったもの。 このような購入に関するデータを転送すると、 [!DNL Data Migration Tool] 差分モード。

## 手順 6:増分データを更新

データの移行後、Magento1 のストアに追加されたデータの更新（新しい注文、レビュー、顧客プロファイルの変更など）を段階的に取り込み、差分モードを使用してMagento2 のストアに更新を転送する必要があります。

* 増分移行を開始する。更新は継続的に実行されます。 を押すと、いつでも更新内容の転送を停止できます `Ctrl+C`.

* この間にMagento2 サイトをテストして、できるだけ早く問題を見つけてください。 問題が発生した場合は、 `Ctrl+C` ：増分移行を停止し、問題を解決した後で再度開始します。

>[!NOTE]
>
>Magento2 サイトのテストを実行し、移行プロセスを同時に実行した場合は、ボリュームチェックの警告が表示される場合があります。 これは、Magento2 では、Magento1 インスタンスに存在しないエンティティを作成するからです。

## 手順 7:運用開始

Magento2 のサイトがMagento1 の最新の状態になり、正常に機能するようになったので、次の手順を実行して新しいサイトに切り替えます。

1. Magento1 システムをメンテナンスモードにします（ダウンタイムが開始します）。

1. 移行ツールのコマンドウィンドウで Ctrl + C キーを押して、差分更新を停止します。

1. Magento2 cron ジョブを開始します。

1. Magento2 システムで、在庫インデクサーのインデックスを再作成します。 詳しくは、 [設定ガイド].

1. 任意のツールを使用して、Magento2 システムのページをヒットし、ストアフロントを使用するお客様の前にページをキャッシュします。

1. Magento2 サイトの最終検証を実行します。

1. DNS、ロードバランサーなどを、新しい実稼動ハードウェアを指すように変更します（ダウンタイムは終了します）。

1. Magento2 ストアを使用する準備が整いました。 自分と顧客は、すべてのアクティビティを再開できます。

<!-- LINK ADDRESSES -->
[Magentoの必要システム構成]: ../../installation/system-requirements.md
[Commerce Marketplace]: https://marketplace.magento.com
[設定ガイド]: ../../configuration/cli/manage-indexers.md
