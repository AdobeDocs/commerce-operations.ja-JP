---
title: データ移行計画の作成
description: 次の手順に従って、データ移行計画を作成し、Magento 1 からMagento 2 に正常にアップグレードできるようにします。
exl-id: a14237f3-c5fe-4f5f-86eb-ed4c39507bff
topic: Commerce, Migration
source-git-commit: e83e2359377f03506178c28f8b30993c172282c7
workflow-type: tm+mt
source-wordcount: '939'
ht-degree: 0%

---

# データ移行計画の作成

移行を成功させ問題を回避するには、移行の計画とテストを十分に行う必要があります。

## 開始する前に：アップグレードを検討する

移行は、重大な変更を加え、次のレベルの成長に向けてサイトを準備するのに最適な瞬間です。 新しいサイトを、より多くのハードウェアを使用して設計する必要があるか、より優れたキャッシュ層を持つより高度なトポロジで設計する必要があるかを検討します。

## 手順 1：現在のサイトで拡張機能を確認する

* どの拡張機能をインストールしましたか？

* 新しいサイトでこれらの拡張機能がすべて必要かどうかを特定しましたか？ 安全に削除できる古いバージョンが存在する可能性があります。

* お使いの拡張機能にMagento 2 バージョンが存在するかどうかを確認しましたか？ [Commerce Marketplace] にアクセスして最新バージョンを確認するか、拡張機能プロバイダーにお問い合わせください。

* 拡張機能のどのデータベースアセットを移行しますか？

## 手順 2：ストアを構築して移行の準備をする

* トポロジを使用してMagento 2 ハードウェアシステムをセットアップし、既存のMagento 1 システムと少なくとも一致するように設計します

* Magento 2.x （このリリースのすべてのモジュールを含む）と [!DNL Data Migration Tool] を、[ 必要システム構成 ](../../installation/system-requirements.md) を満たすシステムにインストールします。

* 一部のデータ（CMS Pages、Sales Rules など）を移行する必要がない場合や、移行中にMagentoのカスタマイズを変換する場合は、[!DNL Data Migration Tool] コードをカスタマイズします。 [!DNL Data Migration Tool] 内からの移行の仕組みについて詳しくは、アドビの [ 技術仕様 ](technical-specification.md) を参照してください

## 手順 3：ドライラン

実稼動環境で移行を開始する前に、テスト環境ですべての移行手順を実行することをお勧めします。

移行テストでは、次の手順に従います。

* Magento 1 ストアをステージングサーバーにコピーします

* レプリケートされたMagento 1 ストアのMagento 2 への完全移行

* 新しいストアを徹底的にテストする

## 手順 4：移行の開始

1. [!DNL Data Migration Tool] に、Magento 1 およびMagento 2 データベースに接続するためのネットワークアクセスがあることを確認します。 対応するポートをファイアウォールで開きます。

1. Magento 1.x の管理パネルで、配送、請求書の作成、クレジットメモなどのアクティビティ（注文管理を除く）をすべて停止します。 許可されるアクティビティのリストは、[!DNL Data Migration Tool] の差分モードの設定を調整することで拡張できます。

   >[!NOTE]
   >
   >Magento 2 ストアが公開されるまで、これらのアクティビティを再開しないでください。

1. Magento 1.x cron ジョブをすべて停止することをお勧めします。

   移行中に一部のジョブを実行する必要がある場合は、新しいデータベースエンティティを作成したり、デルタモードで処理できないような方法で既存のエンティティを変更したりしないでください。

   例えば、`enterprise_salesarchive_archive_orders` cron ジョブは、古い注文をアーカイブに移動します。 差分モードでこのジョブを認識し、アーカイブされた注文を適切に処理するため、移行中にこのジョブを実行しても安全です。

1. [!DNL Data Migration Tool] を使用して、設定と web サイトを移行します。

1. Magento 1.x メディアファイルをMagento 2.x にコピーします。

   これらのファイルを `magento1-root/media` ディレクトリから `magento2-root/pub/media` に手動でコピーする必要があります。

1. [!DNL Data Migration Tool] を使用すると、Magento 1 データベースからMagento 2 データベースにデータを一括コピーできます。

   一部の拡張機能に移行するデータがある場合は、Magento 2 に適合したこれらの拡張機能をインストールする必要がある可能性があります。 Magento 2 データベース内で拡張機能の構造が異なる場合は、[!DNL Data Migration Tool] に用意されているマッピングファイルを使用します。

1. すべてのMagento 2.x インデクサーのインデックスを再作成します。 詳しくは、『 [ 設定ガイド ](../../configuration/cli/manage-indexers.md) の _インデクサーの管理_ を参照してください。

## 手順 5：移行したデータに変更を加える（必要な場合）

場合によっては、移行後に、Magento 2 ストアを別のカタログ構造、販売ルール、CMS ページに設定する必要があります。

手動でデータを変更する場合は、注意が必要です。 エラーが発生すると、その後の増分データ移行手順でエラーが発生します。

例えば、Magento 2 から削除された商品について考えてみます。この商品は、ライブのMagento 1 ストアで購入され、Magento 2 ストアでは使用できなくなりました。 このような購入に関するデータを転送すると、[!DNL Data Migration Tool] を差分モードで実行する際にエラーが発生する場合があります。

## 手順 6：増分データの更新

データを移行した後、Magento 1 ストアに追加されたデータの更新（新しい注文、レビュー、顧客プロファイルの変更など）を増分的にキャプチャし、差分モードを使用してこれらの更新をMagento 2 ストアに転送する必要があります。

* 増分移行を開始します。更新は継続的に実行されます。 `Ctrl+C` キーを押すと、いつでも更新の転送を停止できます。

* この間にMagento 2 サイトをテストして、問題をできるだけ早く特定します。 問題が発生した場合は、`Ctrl+C` キーを押して増分移行を停止し、問題を解決した後で再開してください。

>[!NOTE]
>
>Magento 2 サイトのテストを実施し、移行プロセスを同時に実行すると、ボリュームチェックの警告が表示される場合があります。 この問題が発生するのは、Magento 2 で、Magento 1 インスタンスに存在しないエンティティを作成するためです。

## 手順 7：運用開始

Magento 2 サイトがMagento 1 で最新になり、正常に機能するようになったので、次の手順を実行して新しいサイトに切り替えます。

1. Magento 1 システムをメンテナンスモードにします（ダウンタイム開始）。

1. 移行ツールのコマンドウィンドウで Control + C キーを押して、増分更新を停止します。

1. Magento 2 cron ジョブを開始します。

1. Magento 2 システムで、Stock インデクサーのインデックスを再作成します。 詳しくは、[ 設定ガイド ] を参照してください。

1. 任意のツールを使用して、Magento 2 システムでページをヒットすると、ストアフロントを使用するお客様の前にページがキャッシュされます。

1. Magento 2 サイトの最終検証を行います。

1. DNS、ロードバランサーなどを変更して、新しい実稼動ハードウェアを指すようにします（ダウンタイム終了）。

1. これで、Magento 2 ストアが使用できるようになりました。 ユーザーとその顧客は、すべてのアクティビティを再開できます。

<!-- LINK ADDRESSES -->

[Commerce Marketplace]: https://marketplace.magento.com
