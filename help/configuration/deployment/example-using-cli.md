---
title: CLI コマンドの使用例
description: コマンドラインを使用して開発システムに共有された値、システム固有の値、機密性の高い値を設定する方法の例を参照してください。
exl-id: d0058e9f-a5a9-48a6-9c66-c61515666335
source-git-commit: 55512521254c49511100a557a4b00cf3ebee0311
workflow-type: tm+mt
source-wordcount: '1023'
ht-degree: 0%

---

# CLI コマンドの使用例

この例では、共有された値、システム固有の値、機密の値を開発システムに設定し、それらの値を実稼動システムにデプロイする方法を示します。
これを行うには、共有設定、`config.php` ファイル、Commerce CLI コマンドを組み合わせます。

この例では、次の設定を使用します。

- 共有構成設定の **VAT 番号** および **ストア名**。

  これらのプロパティは、**ストア**/設定/**設定**/一般/**一般** にあります。

- **機密性の高い設定値に対する** メールの送信先 &rbrack;。

  これは、**ストア**/設定/**設定**/一般/**連絡先** にあります。

- システム固有の設定値の **デフォルトのメールドメイン**。

  これは、**ストア**/設定/**設定**/顧客/**顧客設定**/**新しいアカウントオプションを作成** にあります。

この例に示す同じ手順を使用して、次のリファレンスの設定を構成できます。

- [機密およびシステム固有の設定パスのリファレンス](../reference/config-reference-sens.md)
- [支払構成パス参照](../reference/config-reference-payment.md)
- [その他の設定パスのリファレンス](../reference/config-reference-general.md)
- [Commerce Enterprise B2B Extension 設定パスのリファレンス](../reference/config-reference-b2b.md)

## 始める前に

開始する前に、「開発、ビルド、実稼働システムの前提条件 [ で説明されているように、ファイルシステムの権限と所有権を設定し ](../deployment/prerequisites.md) す。

## 前提

このトピックでは、実稼動システム設定を変更する例を示します。 必要に応じて、別の設定オプションを選択できます。

この例では、以下を想定しています。

- Git ソース管理を使用します
- 開発システムは、`mconfig` という名前の Git リモートリポジトリーで使用できます
- Git 作業ブランチの名前は `m2.2_deploy` です。

## 手順 1：開発システムでの設定

開発システムでデフォルトのロケールと重み付け単位を設定するには：

1. 管理者にログインします。
1. **ストア**/設定/**設定**/一般/**一般** をクリックします。
1. 複数の Web サイトを使用できる場合は、左上隅の **ストア表示** リストを使用して、次の図に示すように別の Web サイトに切り替えます。

   ![Web サイトの切り替え ](../../assets/configuration/split-deploy-switch-website.png)

1. 右側のペインで、「**Store Information**」を展開します。
1. 必要に応じて、「**VAT 番号** および **ストア名** フィールドの横にある「デフォルトを使用 **チェックボックスをオフにします**。
1. フィールドに数値を入力します（例：`12345`）。
1. **ストア名** フィールドに、値（`My Store` など）を入力します。
1. 「**設定を保存**」をクリックします。
1. 左側のナビゲーションの一般で、**連絡先** をクリックします。
1. 右側のパネルで「**メールオプション**」を展開します。
1. 必要に応じて、「**メールの送信先** フィールドの横にある **デフォルトを使用** チェックボックスをオフにします。
1. フィールドにメールアドレスを入力します。
1. 「**設定を保存**」をクリックします。
1. 次の図に示すように、「**ストア表示**」リストを使用して **デフォルト設定** を選択します。

   ![ デフォルト設定に切り替え ](../../assets/configuration/split-deploy-default-config.png)

1. 左側のウィンドウで、顧客/**顧客設定** をクリックします。
1. 右側のウィンドウで、「新しいアカウントのオプションの作成 **を展開し** す。
1. 必要に応じて、「**デフォルトのメールドメイン** フィールドの横にある **システム値を使用** チェックボックスをオフにします。
1. フィールドにドメイン名を入力します。
1. 「**設定を保存**」をクリックします。
1. プロンプトが表示されたら、キャッシュをフラッシュします。

## 手順 2：設定を更新

管理者の設定を変更したので、次の手順を使用して共有設定をファイルに書き込みます。

{{$include /help/_includes/config-save-config.md}}

`app/etc/env.php` （システム固有の設定）は更新されましたが、ソース管理にチェックインしないでください。
実稼動システムでも、この手順の後半で同じ設定を作成します。

## 手順 3：ビルドシステムを更新しファイルを生成する

共有設定への変更をソース管理にコミットしたので、ビルドシステムにそれらの変更を取り込み、コードをコンパイルし、静的ファイルを生成できます。

{{$include /help/_includes/config-update-build-system.md}}

## 手順 4：実稼動システムを更新する

プロセスの最後の手順は、実稼動システムを更新することです。 これは、次の 2 つの部分で行う必要があります。

- システム固有の機密情報の設定を更新する
- 共有設定を更新する

### システム固有の機密情報の設定を更新する

環境変数を使用して機密性の高いシステム固有の設定を行うには、次の点を知っておく必要があります。

- 各設定の範囲

  手順 1 の指示に従った場合、**メールの送信先** の範囲は web サイトであり、**デフォルトメールドメイン** の範囲はグローバル（デフォルト設定範囲）です。

  **Send Emails To** 設定値を設定するには、web サイトコードが必要です。

  この値について詳しくは、[ 環境変数を使用して設定を上書き ](../reference/override-config-settings.md#environment-variables) を参照してください。

- この例で使用する設定の設定パス：

  | 設定名 | 設定パス |
  | -------------------- | -------------------------------------- |
  | Send Emails To | `contact/email/recipient_email` |
  | デフォルトのメールドメイン | `customer/create_account/email_domain` |

  機密およびシステム固有のすべての設定パスについては、「[ 機密およびシステム固有の設定パスのリファレンス ](../reference/config-reference-sens.md)」を参照してください。

### CLI コマンドを使用して変数を設定する

次の CLI コマンドを使用して、システム固有の重要な構成設定を設定します。

- システム固有の設定の `magento config:set`
- 機密性の高い設定の `magento config:sensitive:set`

デフォルトの範囲にあるシステム固有の設定 **デフォルトのメールドメイン** を設定するには、次のコマンドを使用します。

```bash
bin/magento config:set customer/create_account/email_domain <email domain>
```

コマンドのスコープはデフォルトのスコープなので、使用する必要はありません。

ただし、**メールの送信先** の値を設定するには、範囲のタイプ（`website`）と範囲コードを知っておく必要があります。これは、サイトごとに異なる可能性があります。

例：

```unix
bin/magento config:sensitive:set contact/email/recipient_email --scope=website --scope-code=<website code> <email address>
```

### 共有設定を更新する

ここでは、開発環境およびビルドシステムで行ったすべての変更を実稼動環境に取り込む方法について説明します。この環境では、共有設定（ストア名と VAT 番号）を更新します。

{{$include /help/_includes/config-update-prod-system.md}}

### 管理者で設定を確認

設定を確認するには：

1. 実稼動システムの管理者にログインします。
1. **ストア**/設定/**設定**/一般/**一般** をクリックします。
1. 左上隅の **ストア表示** リストを使用して、別の web サイトに切り替えます。

   開発システムで設定した共有設定オプションが、次のように表示されます。

   ![ 実稼動システムでの設定の確認 ](../../assets/configuration/split-deploy-verify-storeinfo.png)

   >[!INFO]
   >
   >「**ストア名**」フィールドは web サイトスコープで編集できますが、デフォルトの設定スコープに切り替えると編集できなくなります。 これは、開発システムでのオプションの設定方法の結果です。 **VAT 番号** の値は、Web サイトの範囲では編集できません。

1. まだ行っていない場合は、デフォルト設定スコープに切り替えます。
1. 左側のナビゲーションの一般で、**連絡先** をクリックします。

   次の図に示すように、「**メールの送信先**」フィールドは編集できません。 この設定は慎重に行う必要があります。

   ![ 実稼動システムでの設定の確認 ](../../assets/configuration/split-deploy-verify-contacts.png)

1. 左側のウィンドウで、顧客/**顧客設定** をクリックします。
1. 右側のウィンドウで、「新しいアカウントのオプションの作成 **を展開し** す。

   「**デフォルトメールドメイン**」フィールドの値が次のように表示されます。 これは、システム固有の設定です。

   ![ 実稼動システムでの設定の確認 ](../../assets/configuration/split-default-domain.png)

<!-- Last updated from includes: 2024-07-18 15:50:54 -->
