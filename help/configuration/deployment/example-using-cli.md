---
title: CLI コマンドの使用例
description: コマンドラインを使用して、開発システムで共有、システム固有、機密の値を設定する方法の例を参照してください。
source-git-commit: 6a3995dd24f8e3e8686a8893be9693581d31712b
workflow-type: tm+mt
source-wordcount: '1019'
ht-degree: 0%

---


# CLI コマンドの使用例

この例では、開発システムで共有値、システム固有の値、機密値を設定し、それらの値を実稼動システムにデプロイする方法を示します。
これは、共有設定の組み合わせ ( `config.php` ファイル、および Commerce CLI コマンド

この例では、次の設定を使用します。

- **Vat 番号** および **ストア名** 共有構成設定の

   これらは、の下にあります。 **ストア** /設定/ **設定** /一般/ **一般**.

- **メール送信先** を設定します。

   これは、の下にあります。 **ストア** /設定/ **設定** /一般/ **連絡先**.

- **デフォルトの電子メールドメイン** を設定します。

   これは、の下にあります。 **ストア** /設定/ **設定** /顧客 > **顧客設定** > **新しいアカウントオプションの作成**.

この例と同じ手順を使用して、次の参照で設定を構成できます。

- [機密性の高いシステム固有の設定パスの参照](../reference/config-reference-sens.md)
- [支払設定パスの参照](../reference/config-reference-payment.md)
- [その他の設定パスの参照](../reference/config-reference-general.md)
- [Commerce Enterprise B2B 拡張機能の設定パスのリファレンス](../reference/config-reference-b2b.md)

## 始める前に

開始する前に、ファイルシステムの権限と所有権を設定します。詳しくは、 [開発、ビルド、実稼動システムの前提条件](../deployment/prerequisites.md).

## 前提

このトピックでは、実稼動システムの設定を変更する例を示します。 必要に応じて、別の設定オプションを選択できます。

この例では、次のような場合を想定しています。

- Git ソース管理を使用している
- この開発システムは、という名前の Git リモートリポジトリで使用できます。 `mconfig`
- Git の作業ブランチに次の名前が付けられています： `m2.2_deploy`

## 手順 1:開発システムでの設定

開発システムでデフォルトのロケールと重み付けの単位を設定するには、次の手順に従います。

1. 管理者にログインします。
1. クリック **ストア** /設定/ **設定** /一般/ **一般**.
1. 複数の Web サイトがある場合は、 **ストア表示** のリストを使用して、別の Web サイトに切り替えます。次の図に示すように。

   ![Web サイトの切り替え](../../assets/configuration/split-deploy-switch-website.png)

1. 右側のウィンドウで、を展開します。 **ストア情報**.
1. 必要に応じて、 **デフォルトを使用** 横のチェックボックス **VAT 番号** および **ストア名** フィールド。
1. フィールドに数値を入力します ( 例： `12345`) をクリックします。
1. 内 **ストア名** フィールドに値 ( 例： `My Store`) をクリックします。
1. クリック **設定を保存**.
1. 左側のナビゲーションで、「一般」の下の「 **連絡先**.
1. 右側のウィンドウで、を展開します。 **メールオプション**.
1. 必要に応じて、 **デフォルトを使用** 横のチェックボックス **メール送信先** フィールドに入力します。
1. 「 」フィールドに電子メールアドレスを入力します。
1. クリック **設定を保存**.
1. 以下を使用： **ストア表示** リストで選択 **デフォルト設定** を次の図に示します。

   ![デフォルト設定に切り替え](../../assets/configuration/split-deploy-default-config.png)

1. 左側のウィンドウで、「顧客」/ **顧客設定**.
1. 右側のウィンドウで、を展開します。 **新しいアカウントオプションの作成**.
1. 必要に応じて、 **システム値を使用** 横のチェックボックス **デフォルトの電子メールドメイン** フィールドに入力します。
1. 「 」フィールドにドメイン名を入力します。
1. クリック **設定を保存**.
1. プロンプトが表示されたら、キャッシュをフラッシュします。

## 手順 2:設定を更新します。

管理で設定を変更したら、次の手順に従って、共有設定をファイルに書き込みます。

{{$include /help/_includes/config-save-config.md}}

たとえ `app/etc/env.php` （システム固有の設定）が更新されました。ソース管理にチェックインしないでください。
本番システムに同じ設定を、この手順の後半で作成します。

## 手順 3:ビルドシステムを更新し、ファイルを生成する

共有構成に対する変更をソース管理にコミットしたので、変更をビルドシステムに取り込み、コードをコンパイルし、静的ファイルを生成できます。

{{$include /help/_includes/config-update-build-system.md}}

## 手順 4:実稼動システムを更新する

このプロセスの最後の手順は、実稼動システムを更新することです。 次の 2 つの部分で実行する必要があります。

- 機密設定とシステム固有の設定を更新する
- 共有設定を更新

### 機密設定とシステム固有の設定を更新する

環境変数を使用して機密性の高い設定とシステム固有の設定を行うには、次の点に注意する必要があります。

- 各設定の範囲

   手順 1 の手順に従った場合、 **メール送信先** は Web サイトであり、 **デフォルトの電子メールドメイン** はグローバル（デフォルトの設定範囲）です。

   Web サイトのコードで **メール送信先** 設定値。

   この値の検索方法について詳しくは、次を参照してください。 [環境変数を使用して設定を上書きする](../reference/override-config-settings.md#environment-variables).

- この例で使用する設定の設定パス：

   | 設定名 | 設定パス |
   | -------------------- | -------------------------------------- |
   | メール送信先 | `contact/email/recipient_email` |
   | デフォルトの電子メールドメイン | `customer/create_account/email_domain` |

   すべての機密性の高いシステム固有の設定パスについては、次を参照してください。 [機密性の高いシステム固有の設定パスの参照](../reference/config-reference-sens.md).

### CLI コマンドを使用して変数を設定する

次の CLI コマンドを使用して、システム固有の構成設定と機密な構成設定を指定します。

- `magento config:set` （システム固有の設定）
- `magento config:sensitive:set` 機密設定の場合

システム固有の設定を設定するには **デフォルトの電子メールドメイン**（デフォルトのスコープ）次のコマンドを使用します。

```bash
bin/magento config:set customer/create_account/email_domain <email domain>
```

コマンドのスコープはデフォルトのスコープなので、コマンドで使用する必要はありません。

次の値を設定するには： **メール送信先**&#x200B;ただし、スコープのタイプ (`website`) とスコープコード（サイトごとに異なる場合があります）を含むセグメントを抽出するために使用します。

例：

```unix
bin/magento config:sensitive:set contact/email/recipient_email --scope=website --scope-code=<website code> <email address>
```

### 共有設定を更新

この項では、開発およびビルドシステムで行ったすべての変更を実稼動環境にプルする方法について説明します。これにより、共有構成設定（ストア名と VAT 番号）が更新されます。

{{$include /help/_includes/config-update-prod-system.md}}

### 管理での設定の確認

設定を確認するには：

1. 実稼動システムの管理者にログインします。
1. クリック **ストア** /設定/ **設定** /一般/ **一般**.
1. 以下を使用： **ストア表示** リストを使用して、別の Web サイトに切り替えることができます。

   開発システムで設定した共有設定オプションは、次のように表示されます。

   ![本番システムの設定を確認します](../../assets/configuration/split-deploy-verify-storeinfo.png)

   >[!INFO]
   >
   >この **ストア名** フィールドは web サイトスコープで編集可能ですが、デフォルト設定スコープに切り替えた場合、編集できません。 これは、開発システムでオプションを設定する方法の結果です。 の値 **VAT 番号** は、Web サイトの範囲では編集できません。

1. まだ設定していない場合は、デフォルト設定範囲に切り替えます。
1. 左側のナビゲーションで、「一般」の下の「 **連絡先**.

   この **メール送信先** 次の図に示すように、フィールドは編集できません。 これは機密設定です。

   ![本番システムの設定を確認します](../../assets/configuration/split-deploy-verify-contacts.png)

1. 左側のウィンドウで、「顧客」/ **顧客設定**.
1. 右側のウィンドウで、を展開します。 **新しいアカウントオプションの作成**.

   の値 **デフォルトの電子メールドメイン** フィールドは次のように表示されます。 これは、システム固有の設定です。

   ![本番システムの設定を確認します](../../assets/configuration/split-default-domain.png)
