---
title: セキュリティインシデントに対応
description: セキュリティインシデントを処理するには、ベストプラクティスに従って、サイトの可用性とパフォーマンスに影響を与えるセキュリティの問題に対応し、修正します。
feature: Best Practices
exl-id: 77275d37-4f1d-462d-ba11-29432791da6a
source-git-commit: e63f68dd469564e70269154810cbfbd95d2b2e57
workflow-type: tm+mt
source-wordcount: '1239'
ht-degree: 0%

---

# セキュリティインシデントへの対応に関するベストプラクティス

次の記事では、セキュリティ上の問題に対応するためのベストプラクティスの概要を示し、Adobe Commerceのサイトの可用性、信頼性、パフォーマンスに影響を与える問題の修正を行います。

これらのベストプラクティスに従うと、不正なアクセスやマルウェア攻撃を防ぐことができます。 セキュリティ上の問題が発生した場合、これらのベストプラクティスは、即時対応の準備、根本原因の分析の実行、正常な操作を復元するための修正プロセスの管理に役立ちます。

>[!TIP]
>
>Adobeは、脅威の要因が、コマースアプリケーションとインフラストラクチャの構成で、既存の脆弱性、パッチが適用されていない脆弱性、パスワードの不足、所有権と権限の弱い設定を利用する際に、セキュリティ上の問題のほとんどが発生することを発見しました。 Adobe Commerceインストールの設定、設定、更新をおこなう際に、Adobeセキュリティのベストプラクティスを確認し、それに従って、セキュリティインシデントの発生を最小限に抑えます。 詳しくは、 [コマースサイトとインフラストラクチャを保護](../launch/security-best-practices.md).


## 影響を受ける製品およびバージョン

[サポートされているすべてのバージョン](../../../release/versions.md) /:

- Adobe Commerce an cloud infrastructure
- Adobe Commerceオンプレミス

## インシデントに応答

セキュリティ上の問題がAdobe Commerce on cloud infrastructure プロジェクトに影響を与えていると思われる場合の重要な最初の手順は次のとおりです。

- すべての管理者ユーザーアカウントアクセスを監査する
- 高度な多要素認証 (MFA) コントロールの有効化
- 重要なログを保持
- お使いのバージョンのAdobe Commerceのセキュリティアップグレードを確認します。

その他の推奨事項については、以下で詳しく説明します。

## 攻撃が起こった場合に直ちに行動を起こす

サイトに妥協が生じた場合に、次の主な推奨事項を示します。

- システムインテグレーターと適切なセキュリティ担当者と協力して、調査および修正作業を実施します。

- 攻撃の範囲を決定します。
   - クレジットカード情報にアクセスしましたか？
   - 何の情報が盗まれたの？
   - 妥協からどのくらいの時間が経ちましたか？
   - 情報は暗号化されましたか？

- 攻撃ベクトルを調べて、サーバーのログファイルとファイルの変更を調べ、サイトがいつ、どのように侵害されたかを判断します。

   - 状況によっては、すべてを消去して再インストールするか、仮想ホスティングの場合は新しいインスタンスを作成することをお勧めします。 マルウェアは、自分自身を復元するのを待っているだけで、疑われない場所に隠されている可能性があります。

   - 不要なファイルをすべて削除します。 次に、必要なファイルを既知のクリーンなソースから再インストールします。 例えば、バージョン管理システムからファイルを使用して再インストールしたり、Adobeから元の配布ファイルから再インストールしたりできます。

   - データベース、ファイルアクセス、支払いと配送先の統合、Web サービス、管理者ログインを含む、すべての資格情報をリセットします。 また、システムへの攻撃に使用される可能性のあるすべての統合と API キーとアカウントをリセットします。

## インシデントの分析

インシデント分析の最初のステップは、できるだけ多くの事実を、できるだけ早く収集することです。 インシデントを取り巻く情報を収集すると、インシデントの潜在的な原因を特定するのに役立ちます。 Adobe Commerceは、インシデント分析を支援する以下のツールを提供します。

- [監査管理アクションログ](https://experienceleague.adobe.com/docs/commerce-admin/systems/action-logs/action-log-report.html).

  アクションログレポートには、ログに対して有効になっているすべての管理者アクションの詳細が表示されます。 各レコードにはタイムスタンプが付き、IP アドレスとユーザー名が登録されます。 ログの詳細には、管理者ユーザーデータと、アクション中に加えられた関連する変更が含まれます。

- 次を使用してイベントを分析 [Adobe Commerceツールの監視](../../../tools/observation-for-adobe-commerce/intro.md).

  「 Observation for Adobe Commerce 」ツールを使用すると、複雑な問題を分析して、根本原因を特定できます。 異なるデータを追跡する代わりに、イベントとエラーを関連付ける時間を費やして、パフォーマンスのボトルネックの原因に関するより深い洞察を得ることができます。

  以下を使用します。 **セキュリティ** 」タブを使用してセキュリティ上の問題の可能性を明確に把握し、根本原因を特定してサイトのパフォーマンスを最適に維持することができます。

- 次を使用してログを分析 [New Relic Logs](https://experienceleague.adobe.com/docs/commerce-cloud-service/user-guide/monitor/new-relic/new-relic-service.html)

  Adobe Commerce on cloud infrastructure Pro プロジェクトには以下が含まれます。 [New Relic Logs](https://experienceleague.adobe.com/docs/commerce-cloud-service/user-guide/monitor/new-relic/log-management.html) サービス。 このサービスは、ステージング環境および実稼動環境からすべてのログデータを集計して一元化されたログ管理ダッシュボードに表示し、集計データを検索および視覚化できるように事前に設定されています。

  他の Commerce プロジェクトの場合は、 [New Relic Logs](https://docs.newrelic.com/docs/logs/get-started/get-started-log-management/) サービスを使用して、次のタスクを完了します。
   - 用途 [New Relicクエリ](https://docs.newrelic.com/docs/logs/new-relic-logs/ui-data/query-syntax-logs) をクリックして、集計ログデータを検索します。
   - New Relic Logs アプリケーションでログデータを視覚化します。

## アカウント、コード、データベースを監査する

コマース管理者とユーザーのアカウント、アプリケーションコード、データベースの設定とログを確認して、疑わしいコードを特定してクリーンアップし、アカウント、サイト、およびデータベースアクセスのセキュリティを確認します。 次に、必要に応じて再デプロイします。

数時間以内に多くのサイトが再び侵入されるので、インシデントの後もサイトを引き続き詳細に監視します。 ログのレビューとファイルの整合性の監視を継続的に行い、新たな妥協の兆しを迅速に検出します。

### 管理者ユーザーアカウントを監査

- [管理者ユーザーアクセスの確認](https://experienceleague.adobe.com/docs/commerce-admin/systems/user-accounts/permissions-users-all.html) — 古いアカウント、未使用のアカウント、疑わしいアカウントを削除し、すべての管理者ユーザーのパスワードをローテーションします。

- [管理者セキュリティ設定の確認](https://experienceleague.adobe.com/docs/commerce-admin/systems/security/security-admin.html) — 管理セキュリティ設定がセキュリティのベストプラクティスに従っていることを確認します。

- [クラウドインフラストラクチャプロジェクト上のAdobe Commerceのユーザーアカウントの確認](https://experienceleague.adobe.com/docs/commerce-cloud-service/user-guide/project/user-access.html) — 古い、未使用または疑わしいアカウントを削除し、すべてのクラウドプロジェクト管理者ユーザーのパスワードをローテーションします。 アカウントのセキュリティ設定が正しく構成されていることを確認してください。

- [SSH キーを監査する](https://experienceleague.adobe.com/docs/commerce-cloud-service/user-guide/develop/secure-connections.html) クラウドインフラストラクチャ上のAdobe Commerceの場合：SSH キーを確認、削除、ローテーションします。

### 監査コード

- 管理者から、 [HTMLのヘッダーとフッターの設定](https://experienceleague.adobe.com/docs/commerce-admin/content-design/design/page-setup.html) を含むすべてのスコープレベル `website` および `store view`. 不明な JavaScript コードを、スクリプトやスタイルシート、その他のHTML設定から削除します。 トラッキングスニペットなど、認識されたコードのみを保持します。

- 現在の実稼動コードベースと、バージョン管理システム (VCS) に保存されているコードベースを比較します。

- 疑わしいコードを強制隔離します。

- コードベースを実稼動環境に再デプロイして、疑わしいコードの残りがないことを確認します。

### データベース設定とログを監査する

- 変更に関するストアドプロシージャを確認します。

- データベースがコマースインスタンスからのみアクセス可能であることを確認します。

- 公開されているマルウェアスキャンツールを使用してサイトをスキャンし、マルウェアが存在しなくなったことを確認します。

- 名前を変更し、サイトを確認して、管理パネルを保護します。 `app/etc/local.xml` および `var` URL は公にアクセスできません。

- 数時間以内に多くのサイトが再び侵入されるので、インシデントの後もサイトを引き続き詳細に監視します。 ログのレビューとファイルの整合性の監視を継続的に行い、新たな妥協の兆しを迅速に検出します。

## Googleの警告を削除

サイトに悪意のあるコードが含まれているとGoogleによってフラグが設定されている場合は、サイトがクリーンアップされた後でレビューを要求します。 マルウェアに感染したサイトのレビューには、数日かかります。 Googleがそのサイトがクリーンであると判断した後、検索結果やブラウザーからの警告は、72 時間以内に消えるはずです。 詳しくは、 [レビューのリクエスト](https://web.dev/articles/request-a-review).

## マルウェアの結果チェックリストを確認する

公開されているマルウェアスキャンツールがマルウェアの攻撃を確認した場合は、インシデントを調査します。 ソリューションインテグレーターと協力して、サイトをクリーンアップし、推奨される修正プロセスに従います。

## その他のレビューの実施

高度な攻撃を扱う際に最善の対策は、経験豊富な開発者、サードパーティのエキスパート、またはソリューションインテグレーターと協力して、サイトを完全に修復し、セキュリティ対策を確認することです。 経験豊富なセキュリティ専門家と協力して、ビジネスとその顧客の安全を確保するための包括的で高度な対策を講じます。

## 追加情報

- [根本原因分析フレームワーク](https://sansec.io/kb/incident-response/magento-root-cause-analysis).
