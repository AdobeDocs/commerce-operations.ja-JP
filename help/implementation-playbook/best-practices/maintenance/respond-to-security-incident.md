---
title: セキュリティインシデントに対応する
description: サイトの可用性とパフォーマンスに影響を与えるセキュリティの問題に対応し、修正するためのベストプラクティスに従うことで、セキュリティインシデントに対処します。
feature: Best Practices
exl-id: 77275d37-4f1d-462d-ba11-29432791da6a
source-git-commit: e63f68dd469564e70269154810cbfbd95d2b2e57
workflow-type: tm+mt
source-wordcount: '1172'
ht-degree: 0%

---

# セキュリティ上の問題に対応するためのベストプラクティス

次の記事では、セキュリティインシデントに対応し、Adobe Commerce サイトの可用性、信頼性およびパフォーマンスに影響を与える問題を修正するためのベストプラクティスをまとめています。

これらのベストプラクティスに従うと、不正アクセスやマルウェア攻撃を防ぐのに役立ちます。 セキュリティインシデントが発生した場合、これらのベストプラクティスは、即時対応の準備、根本原因分析の実施、通常の運用に戻すための修正プロセスの管理に役立ちます。

>[!TIP]
>
>Adobeでは、ほとんどのセキュリティインシデントが、対策が講じられていない既存の脆弱性、パスワードの不備、脆弱な所有権と権限の設定がCommerceのアプリケーションとインフラストラクチャの設定に活用される場合に発生することを特定しました。 Adobe Commerce インストールを設定、設定、更新する際に、Adobe セキュリティのベストプラクティスを確認し、従うことで、セキュリティインシデントの発生を最小限に抑えることができます。 [Commerce サイトとインフラストラクチャのセキュリティ保護 &#x200B;](../launch/security-best-practices.md) を参照してください。


## 影響を受ける製品とバージョン

[&#x200B; サポートされているすべてのバージョン &#x200B;](../../../release/versions.md):

- クラウドインフラストラクチャー上のAdobe Commerce
- Adobe Commerce オンプレミス

## インシデントに対応する

クラウドインフラストラクチャプロジェクト上のAdobe Commerceがセキュリティインシデントの影響を受けていると思われる場合、重要な最初の手順は次のとおりです。

- すべての管理者ユーザーアカウントのアクセスの監査
- 高度な多要素認証（MFA）制御の有効化
- 重要なログを保持
- お使いのバージョンのAdobe Commerceのセキュリティアップグレードを確認します。

その他の推奨事項について詳しくは、以下を参照してください。

## 攻撃が起こったらすぐに行動を起こす

サイトが侵害された場合の不運な事態に備えて、従うべき重要な推奨事項を以下に示します。

- システムインテグレーターと適切なセキュリティ担当者に連絡して、調査と修復の作業を行います。

- 攻撃の範囲を特定します。
   - クレジットカード情報にアクセスできましたか。
   - どのような情報が盗まれましたか？
   - 妥協点から経過した時間はどれくらいですか？
   - 情報は暗号化されていましたか？

- サーバのログファイルとファイルの変更を確認して、攻撃のベクトルを見つけ、サイトが侵害された時期と方法を判断します。

   - 状況によっては、すべてをワイプして再インストールするか、仮想ホスティングの場合は新しいインスタンスを作成することをお勧めします。 マルウェアは、単に自分自身を復元するために待っている疑いのない場所に隠されている可能性があります。

   - 不要なファイルをすべて削除します。 次に、既知のクリーン ソースから必要なファイルを再インストールします。 例えば、バージョン管理システムのファイルやAdobeの元の配布ファイルを使用して再インストールできます。

   - データベース、ファイルアクセス、支払いと配送の統合、web サービス、管理者ログインを含む、すべての資格情報をリセットします。 また、システムへの攻撃に使用される可能性のあるすべての統合キーと API キーおよびアカウントをリセットします。

## インシデントの分析

インシデント分析の最初のステップは、できるだけ早く、できるだけ多くの事実を収集することです。 インシデントに関する情報の収集は、インシデントの潜在的な原因を特定するのに役立ちます。 Adobe Commerceでは、インシデント分析に役立つ以下のツールを提供しています。

- [&#x200B; 管理者アクションログを監査 &#x200B;](https://experienceleague.adobe.com/docs/commerce-admin/systems/action-logs/action-log-report.html?lang=ja)。

  アクションログレポートには、ログ記録が有効になっているすべての管理者アクションの詳細な記録が表示されます。 各レコードにはタイムスタンプが付き、ユーザーの IP アドレスと名前が登録されます。 ログの詳細には、管理者ユーザーデータと、アクション中に行われた関連する変更が含まれます。

- [Adobe Commerceの監視ツール &#x200B;](../../../tools/observation-for-adobe-commerce/intro.md) を使用してイベントを分析します。

  Adobe Commerceの監視ツールを使用すると、複雑な問題を分析して根本原因を特定するのに役立ちます。 異なるデータをトラッキングする代わりに、イベントとエラーを関連付けて時間を費やし、パフォーマンスのボトルネックの原因に関する深いインサイトを得ることができます。

  ツールの **セキュリティ** タブを使用して、潜在的なセキュリティの問題を明確に把握し、根本原因を特定してサイトの最適なパフォーマンスを維持するのに役立てます。

- [New Relic ログ &#x200B;](https://experienceleague.adobe.com/docs/commerce-cloud-service/user-guide/monitor/new-relic/new-relic-service.html?lang=ja) を使用したログの分析

  クラウドインフラストラクチャー上のAdobe Commerce Pro プロジェクトには、[New Relic ログ &#x200B;](https://experienceleague.adobe.com/docs/commerce-cloud-service/user-guide/monitor/new-relic/log-management.html?lang=ja) サービスが含まれます。 このサービスは、ステージング環境と実稼動環境のすべてのログデータを集計して、一元化されたログ管理ダッシュボードに表示するように事前に設定されており、そこで集計データを検索および視覚化できます。

  その他のCommerce プロジェクトの場合は、[New Relic ログ &#x200B;](https://docs.newrelic.com/docs/logs/get-started/get-started-log-management/) サービスを設定して使用し、次のタスクを実行できます。
   - [New Relic クエリ &#x200B;](https://docs.newrelic.com/docs/logs/new-relic-logs/ui-data/query-syntax-logs) を使用して、集計ログデータを検索します。
   - New Relic Logs アプリケーションを使用してログデータを視覚化します。

## アカウント、コードおよびデータベースの監査

Commerce管理者およびユーザーアカウント、アプリケーションコード、データベース設定およびログを確認して、疑わしいコードを特定およびクリーンアップし、アカウント、サイト、データベースアクセスのセキュリティを確保します。 その後、必要に応じて再デプロイします。

多くのサイトが数時間以内に再び侵害を受けるため、インシデント発生後も引き続きサイトを注意深く監視します。 継続的なログ・レビューとファイルの整合性の監視により、新たな妥協の兆候を迅速に検出します。

### 管理者ユーザーアカウントの監査

- [&#x200B; 管理者ユーザーアクセスの確認 &#x200B;](https://experienceleague.adobe.com/docs/commerce-admin/systems/user-accounts/permissions-users-all.html?lang=ja) – 古い、未使用、または疑わしいアカウントを削除し、すべての管理者ユーザーのパスワードを入れ替えます。

- [&#x200B; 管理者セキュリティ設定の確認 &#x200B;](https://experienceleague.adobe.com/docs/commerce-admin/systems/security/security-admin.html?lang=ja) - Admin Security 設定がセキュリティのベストプラクティスに従っていることを確認します。

- [&#x200B; クラウドインフラストラクチャプロジェクト上のAdobe Commerceのユーザーアカウントの確認 &#x200B;](https://experienceleague.adobe.com/docs/commerce-cloud-service/user-guide/project/user-access.html?lang=ja) – 古い、未使用、または疑わしいアカウントを削除し、すべてのクラウドプロジェクト管理者ユーザーのパスワードを入れ替えます。 アカウントのセキュリティ設定が正しく構成されていることを確認してください。

- [&#x200B; クラウドインフラストラクチャー上のAdobe Commerceの SSH キーを監査 &#x200B;](https://experienceleague.adobe.com/docs/commerce-cloud-service/user-guide/develop/secure-connections.html?lang=ja)- SSH キーを確認、削除、ローテーションします。

### 監査コード

- 管理者から、[&#x200B; と &#x200B;](https://experienceleague.adobe.com/docs/commerce-admin/content-design/design/page-setup.html?lang=ja) を含むすべてのスコープ レベルで `website`0&rbrace;HTML ヘッダーおよびフッターの構成を確認します。 `store view`不明なJavaScript コードがあれば、スクリプト、スタイルシートおよびその他のHTMLの設定から削除します。 トラッキングスニペットなど、認識されたコードのみを保持します。

- 現在の実稼動コードベースと、バージョン管理システム（VCS）に保存されているコードベースを比較します。

- 不審なコードは強制隔離します。

- コードベースを実稼動環境に再デプロイして、疑わしいコードの残骸がないことを確認します。

### 監査データベースの構成とログ

- 変更については、ストアド・プロシージャを確認してください。

- データベースがCommerce インスタンスからのみアクセスできることを確認します。

- 公開されているマルウェア スキャン ツールを使用してサイトをスキャンし、マルウェアが存在しないことを確認します。

- 管理パネルの名前を変更し、サイト `app/etc/local.xml` と `var` の URL が公開でアクセスできないことを確認して、管理パネルを保護します。

- 多くのサイトが数時間以内に再び侵害を受けるため、インシデント発生後も引き続きサイトを注意深く監視します。 継続的なログ・レビューとファイルの整合性の監視により、新たな妥協の兆候を迅速に検出します。

## Googleの警告を削除

サイトに悪意のあるコードが含まれているとGoogleによってフラグが付けられている場合は、サイトがクリーンアップされた後に確認をリクエストします。 マルウェアに感染したサイトのレビューには数日かかります。 Googleがサイトがクリーンであると判断した後、検索結果やブラウザーからの警告は 72 時間以内に消えます。 [&#x200B; レビューのリクエスト &#x200B;](https://web.dev/articles/request-a-review) を参照してください。

## マルウェア結果チェックリストの確認

一般に公開されているマルウェア スキャン ツールでマルウェア攻撃が確認された場合は、その問題を調査します。 ソリューションインテグレーターと協力してサイトを清掃し、推奨される修正プロセスに従います。

## 追加レビューの実施

高度な攻撃に対処する場合は、経験豊富な開発者、サードパーティエキスパート、またはソリューションインテグレーターと協力して、サイトを完全に修復し、セキュリティプラクティスを確認することをお勧めします。 経験豊富なセキュリティ専門家と協力することで、包括的で高度な対策を講じ、ビジネスとお客様の安全を確保します。

## 追加情報

- [&#x200B; 根本原因分析フレームワーク &#x200B;](https://sansec.io/kb/incident-response/magento-root-cause-analysis)。
