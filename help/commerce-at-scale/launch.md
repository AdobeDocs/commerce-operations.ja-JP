---
title: パフォーマンステストのヒント
description: Commerce およびAdobe Experience Managerソリューションを起動するための KPI をAdobeする方法を説明します。
exl-id: 4b0d9c4f-e611-452d-a80f-27f82705935d
source-git-commit: e76f101df47116f7b246f21f0fe0fa72769d2776
workflow-type: tm+mt
source-wordcount: '1147'
ht-degree: 0%

---

# パフォーマンステストのヒント

上記のすべての変更の有効性を評価するには、運用を開始する前、および実稼動環境への今後の大規模なデプロイメントの前に、十分なパフォーマンステストを実行する必要があります。 負荷テストを計画する際は、実際の消費者トラフィックをできるだけシミュレートすることが重要です。

AEM/CIF/Adobeコマースサイトで最もリソースを消費する領域は、チェックアウトプロセスやサイト検索など、キャッシュできない領域です。 通常、e コマースサイトへのトラフィックの大部分は静的で、したがって、詳細ページの生成 (PDP) や製品リストページ (PLP) などのページブラウジングで構成され、テストのスクリプトやシナリオは、プラットフォームの制限を測定するために反映されます。

負荷テスト用に 1 つのスクリプトを実行し、ステップ間の待ち時間を設定せずにサイト内を移動し、毎回チェックアウトプロセスを完了すると、実際のシナリオとは異なり、プラットフォームの制限を確実に示すことはできません。

KPI の定義は、パフォーマンステスト計画の最初の手順です。初期テスト中にテストできるが、将来、また、サイトの運用開始後に定期的に測定できる指標を定義する。 これにより、運用開始前と運用開始後の、サイトのパフォーマンスを経時的に追跡できます。 定義する KPI の例を次に示します。

- 平均応答時間 — 最初のバイトまたは最後のバイトまでの時間
- 遅延
- バイト/秒（スループット）
- エラー率
- 1 時間あたりの注文件数
- 1 時間あたりのページビュー数
- 1 時間あたりのユニークユーザー数（同時買い物客数）

## Jmeter のガイドライン

AEM/CIF/Adobeコマースの負荷テストを開発する際は、次の大まかなガイドラインを考慮する必要があります。

- スクリプトを構成可能なシナリオに分割します。次に例を示します。
   - ホームページを開く
   - カテゴリページを開く (PLP)
   - PDP(Simple Products) の表示 — 各反復で 2 つのループ
   - 構成可能な製品の表示 — 各反復で 2 つのループ
      - 例えば、上記の手順をトラフィックの 60%に設定します
   - 製品検索
      - 例えば、カタログの検索をトラフィックの 37%に設定します。
   - 買い物かごとチェックアウト
      - 例えば、買い物かごとスクリプトのチェックアウト部分を完了するユーザーは、デフォルトで業界標準の e コマースサイトコンバージョン率が約 3%に設定されます
      - チェックアウトフローはキャッシュされず、通常はリソースを集中的に消費する操作なので、注文を完了する人の数とサイトブラウザーの数を比較的高い数値に設定すると、サイトで処理できるトラフィック量の信頼性が低くなります。
- 各テストの実行前にすべてのキャッシュを消去：
   - AEM Dispatcher キャッシュが完全にクリーンアップされる必要があります
   - Adobeコマースの Fastly および内部キャッシュは、完全にフラッシュしてクリーンアップする必要があります。これは、Adobeコマース管理のキャッシュコントロールを使用して実行できます。
- Jmeter テストにランプ期間を含める：ランプ期間を設定しないと、トラフィックが徐々に増加せず、サイトがページの一般的に訪問されるページやコンポーネントをキャッシュする機会がなくなります。 実際には、すべてのピークトラフィックが完全にキャッシュされていないサイトに同時に到達することは珍しいことです。そのため、Jmeter テストスクリプトにランプ期間を含め、実際の e コマースサイトで発生するのと同じようにキャッシュを構築できます。
- 反復の各ステップの間の「待機時間」を使用する必要があります。実際には、ユーザーは
ジャーニー中にすぐにサイトの次のページにジャンプします。ユーザーがページを読み、次のアクションを決定するまで、待機時間がかかります。
- スレッドグループを無限にループするように設定し、x（例：60 分）の設定時間に対しては、以前のテスト実行と同等の応答時間の中央値を持つ、繰り返し可能なテストを行います。 つまり、設定ランプ・アップ期間の後に、同時に実行する仮想ユーザーのターゲット数が存在し、設定ループ時間が継続します。
- 中央値時間は、平均ではなく平均応答時間の改善/減少を示すために使用する必要があります。 If
エッジの結果が他の結果よりも長くかかる場合は、この平均結果は歪みますが、大部分のユーザーに対するエンドユーザーの応答時間に関心があるのは、中央値の測定に適しています。
- 埋め込みリソースは、デフォルトでは jmeter で収集されません（例：実際のユーザーがページを訪問したときにダウンロードされる JS、CSS、その他のリソース）。 これは有効にできますが、テストしているドメインに対してのみ、外部のリソース呼び出しは引き続き除外する必要があります（例：外部でホストされているサービスからの応答時間は含めません）。 google analytics コードで使用できます。
- HTTP キャッシュマネージャーを有効にする必要があります。これにより、ジャーニー中に、Jmeter が
実際のユーザーのジャーニーは、自分のブラウザーで Web サイトを閲覧する際に発生します。 サイトを経由するジャーニーの間、ユーザーのブラウザーは関連する埋め込みリソースを 1 回だけダウンロードし、その後、ユーザーのブラウザーによってキャッシュされます。 また、元の訪問の後しばらくして同じユーザーがサイトに戻った場合でも、それらのアセットがキャッシュされるキャッシュは変わりません。
- リスナーは、実際の負荷テスト実行（「結果ツリーの表示」や「集計レポート」など）内に保持する必要があります。 非 GUI の実負荷テスト実行にこれを含めると、実際のテスト実行中にレポートを生成するためにリソースが使用されるので、Jmeter が報告するパフォーマンスの結果に影響を与える可能性があります。 これらのリスナーは、テストスクリプトから削除され、JTL 結果ファイルに置き換えられました。JTL 結果ファイルは、Jmeter のレポートダッシュボード機能を使用して処理できます。
- ダッシュボードレポートの「Apdex スコア」を使用して、テスト実行間のパフォーマンスに対する変更の影響をすばやく測定できるように、評価の対象となる応答時間を指定します。 Apdex スコアは、許容可能な時間内にサイトにアクセスできる一定の人数に基づきます。 応答時間が一定の「イライラする」量を超えると、スコアが下がります。 時刻は、「apdex_satified_ threshold」および「apdex_toled_threshold」パラメーターを使用して設定できます。
- 仮想ユーザー数ではなく、ビジネスユーザーに提示するターゲット「1 時間あたりの注文件数」指標を設定します。 「仮想ユーザー」は、実際にテストで測定される内容を理解するための複雑なトピックになる場合があります。 サイトのコンバージョン率、1 時間あたりの購入回数、平均滞在時間を計算し、各ページの読み込み間隔を考えることで、業界標準の計算を使用して、達成すべき 1 時間あたりの購入回数に基づいて異なる負荷テストシナリオを示すことができます。
- 最後に、Jmeter テストサーバーは、ユーザートラフィックの大部分の発信元と、クラウドインフラストラクチャがホストされている場所に地理的に近いサーバーで実行する必要があります。この場合、これらが同じであれば幸いです。
