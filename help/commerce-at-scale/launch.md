---
title: Launchの準備
description: CommerceおよびAdobe Experience Managerソリューションを起動するためのKPIをAdobeする方法を説明します。
source-git-commit: 1cff7359ddb4caeca6773ff74b92048c89676f12
workflow-type: tm+mt
source-wordcount: '0'
ht-degree: 0%

---


# 起動の準備

上記のすべての変更の有効性を評価するには、運用を開始する前、および実稼動環境への今後の大規模なデプロイメントの前に、十分なパフォーマンステストを実行する必要があります。 負荷テストを計画する際は、実際の消費者トラフィックをできるだけシミュレートすることが重要です。

AEM/CIF/Adobeコマースサイトで最もリソースを消費する領域は、チェックアウトプロセスやサイト検索など、キャッシュ不可能な領域です。 通常、eコマースサイトへのトラフィックの大部分は静的で、したがって、詳細ページを生成(PDP)や製品リストページ(PLP)などのキャッシュ可能なページブラウジングで構成されるので、テストのスクリプトやシナリオは、プラットフォームの制限を測定するために反映されます。

負荷テスト用に1つのスクリプトを実行し、ステップ間の待ち時間なしでサイト内を移動し、毎回チェックアウトプロセスを完了すると、実際のシナリオとは異なり、プラットフォームの制限を確実に示すことはできません。

KPIの定義は、パフォーマンステスト計画の最初の手順です。初期テスト中にテストできる指標を定義しますが、後で、サイトの運用開始後に繰り返し測定できます。 これにより、運用開始前後のサイトのパフォーマンスを経時的に追跡できます。 定義するKPIの例を次に示します。

- 平均応答時間 — 最初のバイトまたは最後のバイトまでの時間
- 遅延
- バイト/秒（スループット）
- エラー率
- 1時間あたりの注文件数
- 1時間あたりのページビュー数
- 1時間あたりのユニークユーザー数（同時買い物客数）

## Jmeterのガイドライン

AEM/CIF/Adobeコマースの負荷テストを開発する際は、次の大まかなガイドラインを考慮する必要があります。

- スクリプトを構成可能なシナリオに分割します。次に例を示します。
   - ホームページを開く
   - カテゴリページを開く(PLP)
   - シンプルな製品(PDP)の表示 — 各反復で2つのループ
   - 構成可能な製品の表示 — 各反復で2つのループ
      - 例えば、上記の手順をトラフィックの60%に設定します
   - 製品検索
      - 例えば、カタログの検索をトラフィックの37%に設定します。
   - 買い物かごとチェックアウト
      - 例えば、買い物かごを完了し、スクリプトのチェックアウト部分を完了したユーザーは、デフォルトで業界標準のeコマースサイトコンバージョン率が約3%になる
      - チェックアウトフローはキャッシュされず、通常はリソースを集中的に消費する操作なので、注文を完了する人の数とサイトブラウザーの数を比較して非現実的に高い数値に設定すると、サイトで処理できるトラフィック量の信頼性が低くなります。
- 各テスト実行前にすべてのキャッシュを消去します。
   - AEM Dispatcherキャッシュが完全にクリーンアップされる必要があります
   - AdobeコマースのFastlyおよび内部キャッシュは、完全にフラッシュしてクリーンアップする必要があります。これは、Adobeコマース管理のキャッシュコントロールを使用して実行できます。
- Jmeterテストにランプ期間を含めます。ランプ期間が設定されていない場合、トラフィックが徐々に増加することはなく、サイトがページの一般的に訪問されるページやコンポーネントをキャッシュする機会もありません。 実際には、すべてのピークトラフィックが完全にキャッシュされていないサイトに同時に到達することは珍しいことです。そのため、実際のeコマースサイトで発生するのと同じようにキャッシュを構築できるように、ランプ期間をJmeterテストスクリプトに含める必要があります。
- 反復処理の各ステップ間の「待機時間」は、実際には、ユーザーが
ジャーニー中にすぐにサイトの次のページにジャンプします。ユーザーがページを読み、次のアクションを決定するまで、待機時間がかかります。
- スレッドグループを無限にループするように設定し、x （例：60分）の設定時間に対しては、以前のテスト実行と同等の応答時間の中央値を持つ、繰り返し可能なテストを行います。 つまり、設定ランプ・アップ期間の後に、同時に実行する仮想ユーザーのターゲット数が存在し、設定ループ時間が経過するまで続きます。
- 中央値時間は、平均ではなく平均応答時間の改善/減少を示すために使用する必要があります。 If
エッジの結果が他の結果よりも長くかかる場合、これはこの平均結果をゆがめますが、大部分のユーザーに対するエンドユーザーの応答時間に関心があるのは、中央値の測定に適しています。
- 埋め込みリソースは、デフォルトではjmeterで収集されません（例：実際のユーザーがページにアクセスしたときにダウンロードされたJS、CSS、その他のリソース）。 これは有効にできますが、テストしているドメインに対してのみ、外部のリソース呼び出しは引き続き除外する必要があります（例：外部でホストされているサービスからの応答時間を含めない場合など）。 google analyticsコードに置き換えます（制御できないので）。
- HTTPキャッシュマネージャーを有効にする必要があります。これにより、ジャーニー中に、Jmeterが
実際のユーザーのジャーニーは、自分のブラウザーでWebサイトを閲覧している間に発生します。 サイトを経由するジャーニーの間、ユーザーのブラウザーは、関連する埋め込みリソースを1回だけダウンロードし、その後、ユーザーのブラウザーによってキャッシュされます。 また、元の訪問からしばらくして同じユーザーがサイトに戻った場合でも、それらのアセットがキャッシュされるキャッシュである可能性があります。
- リスナーは、実際の負荷テスト実行（「結果ツリーの表示」や「集計レポート」など）内に保持する必要があります。 非GUIの実負荷テスト実行にこれを含めると、実際のテスト実行中にレポートを生成するためにリソースが使用されるので、Jmeterが報告するパフォーマンス結果に影響を与える可能性があります。 これらのリスナーは、テストスクリプトから削除され、JTL結果ファイルに置き換えられました。JTL結果ファイルは、Jmeterのレポートダッシュボード機能を使用して処理できます。
- ダッシュボードレポートの「Apdexスコア」を使用して、テスト実行間のパフォーマンスに対する変更の影響をすばやく測定できるように、評価の対象となる応答時間を指定します。 Apdexスコアは、許容可能な時間内にサイトにアクセスできる一定の人数に基づきます。 応答時間が一定の「イライラする」量を超えると、スコアが下がります。 時刻は、「apdex_satified_ threshold」および「apdex_toled_threshold」パラメーターを使用して設定できます。
- 仮想ユーザー数ではなく、ビジネスユーザーに提示するターゲット「1時間あたりの購入回数」指標を設定します。 「仮想ユーザー」は、実際にテストで測定される測定内容を理解するための複雑なトピックになります。 サイトのコンバージョン率、1時間あたりの購入回数、平均滞在時間を計算し、各ページの読み込み間隔を考えることで、業界標準の計算を使用して、1時間あたりの購入回数に基づいて異なる負荷テストシナリオを提示できます。
- 最後に、Jmeterテストサーバーは、ユーザートラフィックの大部分がどこから来て、クラウドインフラストラクチャがホストされているかに地理的に近いサーバーで実行する必要があります。これらが同じであれば幸いです。
