---
title: Magento Open Source 2.4.4 リリースノート
description: 2.4.4 Magento Open Source リリースの新機能、機能強化、バグ修正および既知の問題について説明します。
recommendations: noCatalog
exl-id: 877e2517-3487-4f54-9e08-a0b67e0de057
source-git-commit: 6896d31a202957d7354c3dd5eb6459eda426e8d7
workflow-type: tm+mt
source-wordcount: '10568'
ht-degree: 0%

---

# Magento Open Source 2.4.4 リリースノート

Magento Open Source 2.4.4 では、PHP 8.1 がサポートされるようになりました。すべてのプロジェクトライブラリと依存関係は、PHP 8.1 との互換性を保つために更新されています。また、Core Composer の依存関係とサードパーティライブラリも、PHP 8.1 と互換性のある最新バージョンにアップグレードされました。このリリースでは、OpenSearch 1.2 もサポートしています。

このリリースには、約 250 個の品質修正および機能強化が含まれています。

>[!NOTE]
>
>2.4.4 フレームワークを PHP 8.1 と互換性のあるものにするために多大な貢献をしてくれたパートナー [Atwix](https://www.atwix.com/) に感謝します。

{{bics}}

## AC-3022.patch を適用して、引き続き配送業者として DHL を提供します

DHL ではスキーマバージョン 6.2 を導入しており、近い将来、スキーマバージョン 6.0 を廃止する予定です。 DHL 統合をサポートするAdobe Commerce 2.4.4 以前のバージョンは、バージョン 6.0 のみをサポートしています。これらのリリースをデプロイするマーチャントは、DHL を配送業者として引き続き提供するために、できるだけ早い時期に `AC-3022.patch` を適用する必要があります。 パッチのダウンロードとインストールについては、ナレッジベースの記事 [DHL を引き続き配送業者として提供するためのパッチを適用する ](https://support.magento.com/hc/en-us/articles/7707818131597-Apply-a-patch-to-continue-offering-DHL-as-shipping-carrier) を参照してください。

## その他のリリース情報

これらの機能のコードは、Magento Open Source コアコードの四半期リリースにバンドルされていますが、これらのプロジェクトの一部も個別にリリースされています。 これらのプロジェクトのバグ修正は、各プロジェクトのドキュメントで利用できる別のプロジェクト固有のリリース情報に記載されています。

>[!NOTE]
>
>Braintreeを除くすべてのベンダーバンドル拡張機能は、Magento Open Source 2.4.4 から削除されました。

>[!NOTE]
>
>Composer 2.2 では、プラグインを実行する前に、マーチャントが `composer.json` ファイル内の信頼されたプラグインを識別する必要があるセキュリティ機能が導入されました。 現在、`composer.json` ファイルに含まれているプラグインのうち、信頼されているとマークされていないプラグインは、自動的にインストールされます。 ただし、2022 年 7 月現在、Composer は、明示的に許可されていない限り、プラグインをロードしません。 [ ファイルを修正してプラグインのロードを明示的に許可する方法については、ナレッジベースの記事「](https://support.magento.com/hc/en-us/articles/6215997614093-Composer-plugins-issues-when-upgrading-to-Adobe-Commerce-2-4-4)Composer プラグインがAdobe Commerce 2.4.4 にアップグレードする際の問題 `composer.json` を参照してください。

### このリリースに含まれるホットフィックス

Magento Open Source 2.4.4 には、Adobe CommerceおよびMagento Open Source 2.4.3、2.4.3-p1、2.3.7-p2 に対して提供された次のホットフィックスで対処されたすべての問題が解決されます。

* `MDVA-43395_EE_2.4.3-p1_COMPOSER_v1.patch` と `MDVA-43443_EE_2.4.3-p1_COMPOSER_v1.patch` で対処された脆弱性が、このリリースで解決されました。

* `AC-384_Fix_Incompatible_PHP_Method__2.4.3_ce.patch`。 このパッチは、アップグレード中に発生した致命的な PHP エラーに対処します。 ナレッジベースの記事「[Adobe Commerceのアップグレード 2.4.3、2.3.7-p1 PHP 致命的なエラーに関するホットフィックス ](https://support.magento.com/hc/en-us/articles/4408021533069-Adobe-Commerce-upgrade-2-4-3-2-3-7-p1-PHP-Fatal-error-Hotfix)」を参照してください。

## Magento Open Source 2.4.4 のハイライト

このリリースのハイライトは次のとおりです。

### セキュリティ機能の強化

このリリースには、セキュリティ修正と Platform セキュリティの改善が 1 つ含まれています。 このセキュリティ修正は、Magento Open Source 2.4.3-p2 およびMagento Open Source 2.3.7-p3 に移植されました。

これらの問題に関連する確認された攻撃は、今日まで行われていません。 ただし、特定の脆弱性が悪用されて、顧客情報にアクセスしたり、管理者のセッションを引き継いだりする可能性があります。 これらの問題のほとんどは、攻撃者が最初に管理者へのアクセス権を取得する必要があります。 そのため、管理者を保護するために必要なすべての措置をとることをお勧めします。これには、以下の取り組みが含まれますが、これらに限定されません。

* IP許可リストに加える
* [ 二要素認証 ](https://developer.adobe.com/commerce/testing/functional-testing-framework/two-factor-authentication/)
* vpn の使用
* `/admin` ではなく一意の場所の使用
* 適切なパスワードハイジーン

修正された問題の最新の説明については、[Adobe セキュリティ速報 ](https://helpx.adobe.com/security/products/magento/apsb22-13.html) を参照してください。

#### その他のセキュリティ機能強化

このリリースのセキュリティの強化により、次のような最新のセキュリティのベストプラクティスへのコンプライアンスが向上しています。

* メール変数の使用は、セキュリティリスク軽減の一環として 2.3.4 に廃止され、より厳密な変数構文に置き換わりました。 このレガシー動作は、そのセキュリティリスク軽減の続きとして、このリリースでは完全に削除されています。

  その結果、Magento Open Source 2.4.4 またはMagento Open Source 2.4.4 にアップグレードすると、以前のバージョンのAdobe Commerceで機能していたメールまたはニュースレターのテンプレートが正しく機能しなくなる場合があります。影響を受けるテンプレートには、管理者の上書き、テーマ、子テーマ、カスタムモジュールまたはサードパーティの拡張機能のテンプレートが含まれます。 [ 互換性アップグレードツール ](https://experienceleague.adobe.com/docs/commerce-operations/upgrade-guide/upgrade-compatibility-tool/overview.html) を使用して非推奨（廃止予定）の使用状況を修正した後でも、デプロイメントに影響が及ぶ場合があります。 考えられる影響と影響を受けるテンプレートの移行に関するガイドラインについて詳しくは、[ カスタムメールテンプレートの移行 ](https://developer.adobe.com/commerce/frontend-core/guide/templates/email-migration/) を参照してください。

* API ベアラートークン認証に統合トークンを使用できなくなりました。 以前は、統合トークンをトークンベースの認証用のスタンドアロンキーとして使用できました。 ただし、有効期限が切れないアクセストークンのセキュリティに影響するので、この動作はデフォルトで無効になっています。 以前の動作は、コマンドラインまたは管理者を使用して有効にできます。 [ トークンベースの認証 ](https://developer.adobe.com/commerce/webapi/get-started/authentication/gs-authentication-token/) を参照してください。<!-- AC-1619 -->

* セッション ID はデータベースに格納されなくなりました。<!-- AC-522-->

* OAuth アクセストークンとパスワードリセットトークンが、データベースに保存される際に暗号化されるようになりました。<!-- AC-520 1323-->

* 英数字ではないファイル拡張子のアップロードを防ぐために、検証が強化されました。<!-- AC-479-->

* クーポンコードに reCAPTCHA サポートを追加しました。<!-- AC-461-->

* Magento Open Sourceが実稼動モードの場合、Swagger がデフォルトで無効になりました。<!-- AC-1450-->

* Magento Open Source ストアフロントで HTTPS がデフォルトで有効になりました。 **ストアフロントでセキュアな URL を使用** 設定と **管理者でセキュアな URL を使用** 設定はデフォルトで有効になっており、すべての組み込み Cookie がセキュアとして設定されるようになりました。 <!-- AC-1173-->

* すべてのMagento Open Source インストールに dependency confusion プラグインが必要になりました。 以前は、このプラグインは Composer ベースのインストールにのみ必要でした。 信頼できるバージョンが許可されるようになりました。 マーチャントは、このプラグインで設定された、Composer インストールの特定の組み合わせを禁止する制約を回避できます。 信頼済みバージョンの制約を回避でき、インストールを続行する前にMagento Open Sourceに警告が表示されるようになりました。 <!-- AC-501 970-->

* 開発者は、Magento Open Source RESTful エンドポイントで受け入れられる配列のサイズの制限を、エンドポイントごとに設定できるようになりました。 [API セキュリティ ](https://developer.adobe.com/commerce/webapi/get-started/api-security/) を参照してください。<!-- AC-465-->

* ユーザーが web API を使用してシステム全体でリクエストできるリソースのサイズと数を制限し、個々のモジュールのデフォルトを上書きするメカニズムを追加しました。 これにより、`MC-43048__set_rate_limits__2.4.3.patch` が対処した問題が解決します。 [API セキュリティ ](https://developer.adobe.com/commerce/webapi/get-started/api-security/) を参照してください。<!-- AC-1120-->

### プラットフォームの機能強化

Magento Open Source 2.4.4 で PHP 8.1 がサポートされるようになりました。すべてのプロジェクトライブラリと依存関係は、PHP 8.1 との互換性を保つために更新されています。プラットフォームのその他の機能強化は次のとおりです。

* Magento Open Source 2.4.4 では、Elasticsearch 7.16 および OpenSearch 1.2 がサポートされています。オンプレミスでホストされたデプロイメントを持つ Open Sourceのマーチャントは、どちらのソリューションも使用できます。 ただし、現在は、クラウドでホストされるMagento Open Source 2.4.4 デプロイメントのデフォルトの検索エンジンは OpenSearch になりました。 クラウドデプロイメントを使用しているお客様がバージョン 2.4.4 にアップグレードする場合は、OpenSearch を使用する必要があります。 [Cloud 2.4.4 でのAdobe Commerceの OpenSearch への切り替え ](https://support.magento.com/hc/en-us/articles/4419942355725-Switching-to-OpenSearch-for-Adobe-Commerce-on-Cloud-2-4-4) を参照してください。

* `JQuery` ライブラリがバージョン 3.6 にアップグレードされました。`jquery-ui` ライブラリがバージョン 1.13.0 にアップグレードされました。その他の複数のJavaScript ライブラリが最新バージョンに更新されました。

* TinyMCE 5.8.1 がサポートされるようになりました。 TinyMCE 4 がコードベースから削除されました。<!-- AC-41-->

* `RequireJS` ライブラリが最新バージョン（v2.3.6）にアップグレードされました。 [GitHub-33672](https://github.com/magento/magento2/issues/33672) <!-- AC-40 422-->

* PHPUnit を最新バージョン（9.5.x）にアップグレードしました。 新しいバージョンに対応するようにテストとテストフレームワークが更新されました。<!-- AC-404-->

* ほとんどの Laminas の依存関係は、PHP 8.1 と互換性のある最新バージョンにアップグレードされています。依存関係の数を減らすために、コードベースから 3 つのラミナス依存関係が削除されました。

#### jQuery UI のアップグレード

jQuery UI が最新バージョン（v1.13.0）にアップグレードされました。 次の v1.10.0 jQuery コンポーネントが削除されました。

* タブの `ajaxOptions` および `cache` オプション。 [ タブ ](https://jqueryui.com/changelog/1.10.0/#tabs) を参照してください。

* `.zIndex()`。 jQuery UI v1.12.1 には、`jquery/z-index.js` の使用をサポートする `.zIndex()` が含まれています。 [UI コア ](https://jqueryui.com/changelog/1.12.0/#ui-core) を参照してください。

* ウィジェット名のデータフォールバック。 `.data()` キーにはフルネームを使用する必要があります。

* ウィジェットでの `ui-corner-all` などのクラスのハードコーディング。

### GraphQL

このリリースには、GraphQLに関する次の機能強化が含まれています。

* **パフォーマンスの向上**:

   * GraphQLの買い物かごの操作のパフォーマンスが向上しました。 `collectQuoteTotals()` メソッドは、GraphQL リクエスト中に 1 回だけ呼び出されるようになりました。これにより、応答時間が短縮されます。<!-- PWA-2110-->

   * GraphQL リクエストのキャッシュ方法が変更され、ストアフロントのパフォーマンスが向上しました。 Fastly と Varnish は、`auth` トークンで送信されたGraphQL リクエストをキャッシュするようになりました。<!-- PWA-1817-->

* **新しいストアフロント関連の管理設定**。 `storeConfig` クエリは、小計ゼロのチェックアウトおよび小切手/送金方法の設定を返すようになりました。<!-- PWA-1576-->

* **コア GraphQL ライブラリを更新しました**。 コア GraphQLを機能させる `webonyx` ライブラリがバージョン ^14.9 にアップグレードされました。<!-- PWA-2137 2184 -->

* **マルチサイトストアと多言語ストアを使用したGraphQLの翻訳の問題を修正しました**。 GraphQL リゾルバーが、ストアスコープに基づいて翻訳された文字列を期待どおりに返すようになりました。<!-- PWA-1946-->

* GraphQLには、デバッグに役立つ、わかりやすいトランザクション名がNew Relicに用意されるようになりました。 [GitHub-30915](https://github.com/magento/magento2/issues/30915) <!-- PWA-1311-->

これらの機能強化について詳しくは、[GraphQL開発者ガイド ](https://developer.adobe.com/commerce/webapi/graphql/) を参照してください。

### ベンダーバンドルの拡張機能

[Braintree](https://experienceleague.adobe.com/en/docs/commerce-admin/stores-sales/payments/braintree) を除き、すべてのベンダーバンドルの拡張機能は、Magento Open Source 2.4.4 コードベースから削除されました。 マーチャントは、公式の拡張機能に移行する必要があります。この拡張機能は、[Commerce Marketplace](https://commercemarketplace.adobe.com//extensions.html) で利用できます。

[Amazon支払 ](https://experienceleague.adobe.com/en/docs/commerce-admin/stores-sales/payments/payments)

[dotdigital](https://experienceleague.adobe.com/en/docs/commerce-admin/systems/introduction#variables-and-customer-communications)

[ クルナ ](https://experienceleague.adobe.com/en/docs/commerce-admin/stores-sales/payments/payments)

[ 頂点 ](https://experienceleague.adobe.com/en/docs/commerce-admin/stores-sales/site-store/taxes/taxes)

[YotPo](https://experienceleague.adobe.com/en/docs/commerce-admin/marketing/merchandising/product-reviews/product-reviews)

### PayPal 支払いの機能強化

* Venmo 支払いオプションがサポートされるようになりました。 <!-- AC-1229-->

* 「後で支払う」は、マーチャントの場所ではなく、買い物客の場所に基づくオプションとして追加されました。

* マーチャントは、選択した国で買い物客のエクスペリエンスをテストする際に、買い物客の国を設定できるようになりました。 以前は、テストは販売者が所在する国のテストに限定されていました。 この変更は、サンドボックスモードでのみ有効です。

* チェックアウトページのメッセージに、買い物客が「後払い」を使用した際に支払うと予想される金額と増分の正確なメッセージが表示されるようになりました。

### アクセシビリティの更新

このリリースでは、標準のアクセシビリティガイドラインへの準拠が強化されています。 これには、改良されたツールチップ、画面要素の名前とタグ付けのアクセス可能な機能、再設計されたアイコンとボタンが含まれます。 これらの修正の 80% 以上は、視力や視力の制限のないユーザーのショッピングエクスペリエンスを向上させるのに役立ちます。

### ページビルダー

マーチャントは、画像（画像、バナー、スライド）に代替テキスト（`alt_text`）を追加して、コンテンツのアクセシビリティを強化できるようになりました。 [GitHub-746](https://github.com/magento/magento2-page-builder/issues/746) <!-- PB-1193-->

## 修正された問題

Magento Open Source 2.4.4 コアコードの何百もの問題を修正しています。 修正された問題の一部を以下に示します。

### インストール，アップグレード，デプロイメント

<!-- MC-42026-->

* Magento Open Sourceは、静的コンテンツのデプロイメントエラーを期待どおりにビルドログファイルに記録するようになりました。

<!-- MC-43094-->

* データパッチでは、テーブルの一意の制約を無視して、MySQL データベーステーブルに重複した値を挿入できなくなりました。 以前は、パッチによって重複した値が挿入され、データベースが破損する可能性がありました。

<!-- AC-1480-->

* マーチャントは、Klarna を使用したMagento Open Source 2.4.2 のデプロイメントからMagento Open Source 2.4.3 に正常にアップグレードできるようになりました。[GitHub-33760](https://github.com/magento/magento2/issues/33760)

<!-- ACP2E-77-->

* サイトマップジェネレーターの設定をコマンドラインから正常に変更できるようになりました。 以前は、Admin: `Import failed: Notice: Trying to access array offset on value of type null in app/code/Magento/Cron/Model/Config/Backend/Sitemap.php on line 78` の外部でサイトマップ設定を変更しようとすると、applicationOpen Sourceにこのエラーが表示されていました。  [GitHub-31428](https://github.com/magento/magento2/issues/31428)

<!-- ACP2E-215-->

* `bin/magento app:config:import` で値を更新した場合、`time` コマンドがエラーなく実行されるよ `config.php` になりました。 以前は、手動で編集（管理者を使用しない）して製品のアラート設定を変更すると、エラーが発生していました。

### アクセシビリティ

<!-- AC-1589-->

* 買い物かごページとチェックアウトページでのナビゲーションに関するアクセシビリティエラーが解決されました。 [GitHub-34483](https://github.com/magento/magento2/issues/34483)

<!-- AC-1289-->

* スクリーンリーダーで、製品ページ上の関連するすべてのフォーム要素を読み取れるようになりました。

<!-- AC-1277-->

* ストアフロント全体で画像の削除や移動のアイコンボタンのコントラストを改善し、ロービジョンユーザーの読みやすさを向上しました。

<!-- AC-1272-->

* 製品インターフェイス全体で検索を実行するために使用される虫眼鏡アイコンに、アクセシブルな名前と代替テキストが割り当てられました。

<!-- AC-1275-->

* Tab キーを使用してリッチテキストエディターツールバーにアクセスできるようになりました。

<!-- AC-1283-->

* **この項目に重みがあり****カタログ**/**製品** 詳細ページの入力を選択すると、ラベルが表示され、名前にアクセスできるようになりました。

<!-- AC-1284-->

* アクセス可能なコントロール名に、ページごとの項目数ドロップダウンに表示されるラベルのテキストが含まれるようになりました。

<!-- AC-1287-->

* **カタログ**/**製品** 詳細ページのテーブルコントロールでは、テーブルを折りたたむと、ラベルが表示され、アクセス可能な名前が付くようになりました。

<!-- AC-1288-->

* 製品テーブルの編集リンクに、意味のある一意のリンクテキストが追加されました。

<!-- AC-1276-->

* ツールチップを拡張するトリガーには、テキスト名が提供されるようになりました。

<!-- AC-1285-->

* ストアフロント全体のボタンに、一意でわかりやすいアクセシブルな名前が付けられるようになりました。 以前は、テキストボタンと隣接する下向き矢印アイコンボタンを持つ分割ボタンには、同じアクセス可能な名前が付いていました。

<!-- AC-1277-->

* ストアフロント全体で画像の削除や移動のアイコンボタンのコントラストを改善し、ロービジョンユーザーの読みやすさを向上しました。

<!-- AC-1279-->

* マーチャントが「検索エンジン最適化」アコーディオンの入力を編集したときに表示される鉛筆アイコンに、代替テキストが追加されました。

<!-- AC-1272-->

* 製品インターフェイス全体で検索を実行するために使用される虫眼鏡アイコンに、アクセシブルな名前と代替テキストが割り当てられました。

<!-- AC-1286-->

* 製品ページ **新しい表示** のテキスト入力フィールドに、アクセス可能な名前が付けられました。

<!-- AC-1283-->

* **この項目に重みがあり****カタログ**/**製品** 詳細ページの入力を選択すると、ラベルが表示され、名前にアクセスできるようになりました。

### バックエンド

<!-- MC-43161-->

* 管理者は、カスタム管理パスが設定され、秘密鍵が有効になっているデプロイメントで管理者にログインできるようになりました。 以前は、applicationOpen Sourceに「`Invalid security or form key. Please refresh the page`」というエラーが表示されていました。

<!-- MC-41949-->

* マルチストア階層が変更されても、Magento Open Sourceはすべてのストアビュー範囲にリダイレクトされなくなりました。 以前は、階層を保存した後、買い物客は誤ったストア URL にリダイレクトされ、マルチストアデプロイメントで「すべてのストア表示」範囲が選択されていました。

### バンドル製品

<!-- MC-42885-->

* 買い物客は、固定製品税と 2 つのオプションを含むバンドル製品を買い物かごに追加できるようになりました。 これまでは、applicationOpen Sourceに商品が追加されず、次のエラーが表示されていました：`We can't add this item to your shopping cart right now`。

<!-- MC-42249-->

* バンドル製品の負の値を防ぐために、`data-validate` 属性と `min` 属性の形式のフォーム検証が買い物かごの数量フィールドに追加されました。

<!-- MC-41794-->

* ストア表示レベルで子製品が無効になっている場合、`products` クエリでバンドル製品を正しくフィルタリングできるようになりました。 以前は、クエリは、ストアビューレベルで無効にされた子製品を返していました。

<!-- MC-42811-->

* `cron` では、実行時に製品カテゴリのキャッシュを期待どおりにクリア `indexer_update_all_views` るようになりました。 以前は、カテゴリ内の多くの商品を一括更新した後、applicationOpen Sourceのカテゴリページに誤った商品数が表示されていました。

<!-- MC-42811-->

* バンドル製品が在庫として再び表示される際に、Magento Open Sourceがカテゴリ製品キャッシュを期待どおりに更新するようになりました。

<!-- AC-715-->

* 異なる通貨を使用するマルチストアデプロイメントで、バンドル製品の購入のメール確認で、通貨コンバージョンが期待どおりに行われるようになりました。 [GitHub-33426](https://github.com/magento/magento2/issues/33426)

<!-- ACP2E-64-->

* 製品グリッドに % 接頭辞が付いたバンドル製品に対して、詳細価格の特別価格ディスカウントが正しく表示されるようになりました。 以前は、製品グリッドで、% ではなく$ プレフィックスで % 割引が誤って表示されていました。

<!-- ACP2E-262-->

* 管理画面でのバンドル製品のステータスが、関連製品がステータスを変更した際に自動的に更新されるようになりました。

<!-- ACP2E-326-->

* バンドル製品のGraphQL リゾルバーが、子バンドル製品が無効になっているかどうかを確認するようになりました。 以前は、このチェックは発生しておらず、`categoryList` のようなクエリでは、販売不可能な子製品が返されていました。

<!-- MC-43223-->

* クエリ応答 `cart`、動的な価格のバンドル製品に対して正確な割引を返すようになりました。 以前は、クエリの応答には、各バンドル製品に個別に適用される割引が含まれていました。

### キャッシュ

<!-- MC-42811-->

* インデックス再作成中に実行されるキャッシュクリーニングアルゴリズムを最適化しました。 インデックス再作成中にカテゴリがキャッシュされた場合、バンドル製品が期待どおりに表示されるようになりました。 以前は、バンドル製品は、製品カテゴリがインデックス再作成中にキャッシュされた後、数時間表示されませんでした。

<!-- AC-328-->

* ページキャッシュは、通常の使用では急速に増加しなくなりました。 [GitHub-9458](https://github.com/magento/magento2/issues/9458)

<!-- magento/magento2/pull/33468-->

* 注文すると、注文した製品に関連するすべてのキャッシュタグが Varnish キャッシュから削除されなくなりました。 [GitHub-30128](https://github.com/magento/magento2/issues/30128)

<!-- AC-1478-->

* トップカテゴリの製品を更新したり、インデックスを実行して製品属性や在庫ステータスを更新したりしても、フルサイトページのキャッシュが消去されなくなりました。 以前は、Varnish キャッシュは、すべてのページキャッシュタグにトップメニューカテゴリ ID を追加していました。 [GitHub-33465](https://github.com/magento/magento2/issues/33465)

### 買い物かごとチェックアウト

<!-- MC-41494-->

* 広告の最低価格 **これは何ですか？買い物かごページの** リンクをクリックできるようになり、期待どおりに情報のポップアップが開きます。 以前は、このリンクをクリックしても効果はありませんでした。

<!-- MC-42639-->

* 永続買い物かごが有効になっているデプロイメントで、セッションタイムアウトの後に、買い物客がエラーなく注文できるようになりました。 以前は、applicationOpen Sourceで、セッションタイムアウトの後に支払いエラーが表示されていました。

<!-- MC-42638-->

* 高い並べ替え順の値を顧客住所属性に割り当てても、チェックアウトページでパフォーマンスが低下しなくなりました。

<!-- MC-42813-->

* 更新された数量が無効な場合、Magento Open Sourceは買い物かごの製品数量を以前の値に戻すようになりました。

<!-- MC-42347-->

* 最近表示された項目セクションの「**買い物かごに追加**」ボタンをクリックすると、製品の詳細ページに期待どおりにリダイレクトされるようになりました。 以前は、買い物客は製品リストページにリダイレクトされていました。

<!-- MC-33705-->

* ゲストの買い物客は、複数のタイプのカスタム顧客アドレス属性を含む顧客アドレスを使用して正常にチェックアウトできるようになりました。 以前は、チェックアウト時に表示されるカスタム属性の値の形式が正しくありませんでした。 [GitHub-30290](https://github.com/magento/magento2/issues/30290)

<!-- MC-24379-->

* Magento Open Sourceは、テーブルの料金が有効な場合、注文に送料無料のしきい値を正しく適用するようになりました。 [GitHub-21832](https://github.com/magento/magento2/issues/21832)

<!-- AC-271-->

* `POST /V1/guest-carts/:cartId/items` を使用して、様々なオプションを持つシンプルな製品を買い物かごに追加できるようになりました。 以前は、この呼び出しでは、指定したオプションを使用して 2 つ目の単純製品を追加する代わりに、追加した最初の単純製品の数量が変更されていました。 [GitHub-32302](https://github.com/magento/magento2/issues/32302)

<!-- AC-1089-->

* 国と `Poland` の通貨に対してデプロイメントが設定されている場合、チェックアウトページの「注文の概要」セクションに正しい通貨と金額 `PLN` 表示されるようになりました。 以前は、買い物かごとチェックアウトページに金額が表示されていました **PLN 0**。

<!-- MC-32805-->

* ミニ買い物かごで商品の数量を変更した後に買い物客が **買い物かごを更新** をクリックしても、Magento Open Sourceがエラーをスローしなくなりました。 以前は、applicationOpen Sourceに「`The quote item isn't found. Verify the item and try again`」というエラーが表示されていました。

<!-- MC-43176-->

* 特定の店舗の設定可能な商品に対するGraphQL `products` クエリで、指定された店舗のみの商品の価格範囲が返されるようになりました。 以前は、リクエストは、指定されていない店舗での単純な製品の価格範囲を返しました。

<!-- AC-691-->

* Magento Open Sourceでは、買い物客が住所フィールド `Uncaught TypeError: Unable to process binding "text: function(){return currentBillingAddress().street.join(', ') }"` のない請求先住所を追加した場合に、このエラーがスローされなくなりました。 [GitHub-33826](https://github.com/magento/magento2/issues/33826)

<!-- AC-1625-->

* ミニ買い物かごが削除されたストアのチェックアウト時に、Magento Open Sourceがコンソールエラーをスローしなくなりました。 [GitHub-34513](https://github.com/magento/magento2/issues/34513)

<!-- AC-691-->

* 請求先住所に番地フィールドの値がない場合や、番地フィールドの値が配列でない場合に、支払い段階でチェックアウトが失敗しなくなりました。 以前は、チェックアウトは次のエラーで失敗していました：`Uncaught TypeError: Unable to process binding "text: function(){return currentBillingAddress().street.join(', ') }"`。 [GitHub-33826](https://github.com/magento/magento2/issues/33826)

<!-- ACP2E-10-->

* Magento Open Sourceは、これらの条件を満たす 1 つの注文に 2 つの買い物かごルールが適用された場合、割引を正しく計算するようになりました。1 つの買い物かごルールはクーポンコードと **買い物かご全体の固定価格** 条件で適用され、2 つ目の買い物かご価格ルールにはクーポンがなく、**製品価格割引の割合** 条件があります。 以前は、以前の買い物かごルールによって一部の製品に対して割引が適用されている場合、関連するアルゴリズムでは、買い物かごの製品間で割引を適切に分割することができませんでした。

<!-- ACP2E-22-->

* クーポンレポートグリッドで売上高が正しく計算されるようになりました。 以前は、売上高には出荷金額が含まれていませんでした。

<!-- ACP2E-44-->

* 買い物客が配送方法を切り替える際に、買い物かご全体の割引が正しく計算されるようになりました。

<!-- ACP2E-159-->

* 管理者による注文の作成ページの **状態** フィールドのドロップダウンリストに、選択した国の事前定義済みの値が入力されるようになりました。 以前は、このフィールドはドロップダウンメニューではなく入力テキストフィールドでした。

<!-- ACP2E-172-->

* `addConfigurableProductsToCart` ミューテーションを使用して、ストア表示を変更した直後に設定可能な商品を買い物かごに追加した後、Magento Open Sourceがエラーをスローしなくなりました。

<!-- ACP2E-176-->

* `addConfigurableProductsToCart` ミューテーションを使用して、設定可能な商品の無効な子を買い物かごに追加しても、Magento Open Sourceがエラーをスローしなくなりました。 以前は、applicationOpen Sourceが整合性制約違反エラーをスローしていました。

<!-- ACP2E-157-->

* クーポンが適用された順序が失敗した場合に、クーポン使用状況の値が変更されなくなりました。  以前は、買い物かごにクーポンが適用され、注文されなかった場合、1 回限りの自動生成クーポンは無効とマークされていました。

<!-- ACP2E-137-->

* 顧客の住所をデフォルト値と比較するための検証がチェックアウトワークフローに追加されました。 検証プロセスで変更が識別されると、その変更を新しい顧客所在地として処理する `customer_address_id` を `null` に設定します。 以前は、お客様がチェックアウト時に検証を行わずに住所を保存し、同じお客様がチェックアウトフィールドに検証が適用された後に同じ住所を使用して注文しようとした場合、Sourceを開くアプリケーションは編集された住所を受け入れず、例外をスローしていました。

### 買い物かご価格ルール

<!-- MC-42288-->

* クーポンの生成は、関連する買い物かご価格ルールが「`auto`」オプションを有効にして保存されるまでブロックされるようになりました。 「`auto`」オプションを有効にせずにこのルールを保存しようとすると、「Sourceを開く」アプリケーションに「`Rule is not saved with auto generate option enabled. Please save the rule and try again`」というメッセージが表示されます。

<!-- MC-42743-->

* 買い物かごの価格ルール割引の正しい適用を確認するためのテストを追加しました。

<!-- ACP2E-213-->

* **これらの条件のすべてを/いずれかを満たす買い物かごで項目が見つかった/見つからなかった場合** で SKU 条件を使用する買い物かご価格ルールが、設定可能な製品で期待どおりに機能するようになりました。

<!-- ACP2E-225-->

* 固定価格のバンドル製品に対して買い物かご価格ルールが正しく適用されるようになりました。 以前は、少なくとも 1 つの子製品のルール条件で同じ属性セットが指定されていた場合、買い物かご価格ルールがこれらの製品に適用されませんでした。

<!-- ACP2E-285-->

* Magento Open Sourceが「買い物かご全体に対する固定金額割引 **価格ルールで設定されている場合、価格が 0 の商品を買い物かごに正常に追加できる** うになりました。 以前は、applicationOpen Sourceに「`report.ERROR: Warning: Division by zero in /home/mer33515/public_html/ee24develop/app/code/Magento/SalesRule/Helper/CartFixedDiscount.php on line 85`」というエラーが表示されていました。

<!-- ACP2E-306-->

* 固定金額の割引を含む買い物かごルールが有効化された際に、`cart` クエリが不正確な割引金額を返した条件を修正しました。

### カタログ

<!-- MC-41796-->

* 商品に `datetime` 属性がある場合に、商品グリッドで一括属性更新アクションを実行しても、Magento Open Sourceが例外をスローしなくなりました。

<!-- MC-42571-->

* GraphQL クエリは、子製品の表示フィルター設定に従って設定可能な製品の子製品の結果を返すようになりました。

<!-- MC-41853-->

* 設定可能な商品属性が変更された場合に、Magento Open Sourceで関連商品価格が変更されなくなりました。 以前は、設定可能な製品の Minimum Advertised Price （MAP；最小広告価格）によって、店舗前面の関連製品の価格が上書きされていました。

<!-- MC-41796-->

* 商品に `datetime` 属性がある場合に、商品グリッドで一括属性更新アクションを実行しても、Magento Open Sourceが例外をスローしなくなりました。

<!-- MC-42132-->

* 管理製品グリッドおよびフィルターのドロップダウン/複数選択属性値が、管理設定から期待どおりに取得されるようになりました。 以前は、属性値はデフォルトのストア設定から派生していました。

<!-- MC-43010-->

* GraphQL カテゴリクエリは、ステージングされたカテゴリへの変更に関する情報を期待どおりに返します。

<!-- AC-711-->

* 製品が親カテゴリとそのサブカテゴリの両方に割り当てられ、ただし各カテゴリ内の異なる位置に割り当てられているデプロイメントで、製品リストが管理者で正確にレンダリングされるようになりました。 以前は、製品リストのレンダリングは次のエラーで失敗していました：`Item (Magento\Catalog\Model\Product\Interceptor) with the same ID "<ID>" already exists`。 [GitHub-33145] （https://github.com/magento/magento2/issues/33145

<!-- AC-1148-->

* 多数のオプション（150 以上）を持つ複数選択属性を、新しい製品に割り当てることができるようになりました。 以前は、属性オプションは `catalog_product_entity_varchar` テーブルに保存されており、管理で製品を再度開いたときにすべてのオプションが存在していたわけではありません。 [GitHub-33486](https://github.com/magento/magento2/issues/33486)

<!-- AC-904-->

* ルーターが URL から収集されたアクションクラスをインスタンス化できない場合の検証を追加しました。 アプリケーションの「Sourceを開く」に標準のエラーメッセージが表示されるようになりました。 以前は、applicationOpen Sourceに「`PHP Error: Cannot instantiate abstract class Magento\Catalog\Controller\Product\Compare`」というエラーが表示されていました。

<!-- ACP2E-115-->

* 多数の製品（約 10,000 個）をカテゴリに割り当てても、ブラウザーがクラッシュしなくなりました。

<!-- ACP2E-122-->

* 管理者からの保存でも読み込みでも、画像属性は一貫してデータベースに保存されるようになりました。 以前は、画像の代替テキスト値の保存に一貫性がありませんでした。 画像が存在し、ラベルが null に設定された場合、データベースでラベル値がリセットされませんでした。

<!-- ACP2E-155-->

* カタログウィジェットの SQL クエリを最適化しました。 以前は、大きな MySQL クエリによってページの読み込みが遅くなり、MySQL が停止していました。

<!-- ACP2E-165-->

* 価格フィルターが、在庫切れの設定可能な製品で正しく機能するようになりました。 以前は、在庫切れの設定可能な製品が正しい価格範囲で表示されていませんでした。

<!-- ACP2E-330-->

* 子製品を更新しても、部分インデックス作成プロセス中に親設定可能な製品から継承されたカタログルールのディスカウントが削除されなくなりました。 以前は、設定可能な商品を、関連する単純商品ではなくカテゴリに割り当ててから、そのカテゴリを使用してカタログルールを作成していた場合、アプリケーションのSourceを開くと、部分インデックス作成プロセスで、単純商品に割り当てられたカタログルールが削除されていました。

<!-- ACP2E-216-->

* グループ化および設定可能な製品のグリッド表示リストに、製品オプションを追加する際に、シンプルな製品と仮想製品のみが含まれるようになりました。 以前は、アプリケーションにはオプションを備えた単純な製品が含まれていました。

### カタログルール

<!-- MC-41807-->

* カタログルールを毎日更新しても、パフォーマンスが低下しなくなりました。 以前は、部分的なカタログ製品価格インデックス作成によって、古い価格や日付が削除されることはありませんでした。

<!-- MC-38263-->

* Magento Open Sourceでは、部分的なインデックス再作成中に、設定可能な商品に関するカタログ価格ルールが削除されなくなりました。 以前は、設定可能な製品のインデックスが再作成される際に、サブプロダクトのみがインデックス再作成されていました。

<!-- ACP2E-331-->

* **category is not category_id** 条件を持つカタログ価格ルールが、どのカテゴリにも属さない製品に適用されるようになりました。

### 設定可能な製品

<!-- MC-42188-->

* 設定可能な製品オプションのラベル名は、管理者の注文作成時に選択したストア表示に基づくようになりました。 以前は、applicationOpen Sourceは、デフォルトのストア表示のラベル名を使用していました。

<!-- MC-42187-->

* 在庫切れ製品を表示するグローバルフラグが有効になっている場合、製品リストに在庫切れ製品の子製品が正しく含まれるようになりました。 以前は、このフラグが有効な際に、複数の子製品オプションのいずれかが在庫切れだった場合、製品リストには子製品が含まれていませんでした。

<!-- MC-42340-->

* `addConfigurableProductsToCart` のバリエーションを使用して、デフォルト以外のストア表示で設定可能な商品を買い物かごに追加できるようになりました。 以前は、web サイト ID とストア ID が異なる場合、設定可能な製品を買い物かごに追加することはできませんでした。 [GitHub-30948](https://github.com/magento/magento2/issues/30948)

<!-- MC-43051-->

* GraphQL `products` クエリは、設定可能な商品の無効な子商品に関するデータを返さなくなりました。

<!-- ACP2E-101-->

* 設定可能な製品に対して新しい設定を作成しても、既存の設定の変更が上書きされなくなりました。 以前は、新しいバリエーションが生成された後、既存のバリエーションのステータスはデフォルトのステータス `enabled` で上書きされていました。

<!-- ACP2E-175-->

* 設定可能な商品の無効な子を買い物かごに追加しようとすると、Magento Open Sourceが内部エラーをスローしなくなりました。

### 顧客

<!-- MC-24204-->

* Magento Open Sourceでは、注文作成時に管理者ロケールの web サイト範囲を考慮するようになりました。 以前は、顧客アドレス属性などの注文の詳細は、マルチサイト展開では 1 つの web サイトでのみ正しく機能していました。 [GitHub-23254](https://github.com/magento/magento2/issues/23254)

### 電子メール

<!-- MC-42592-->

* お客様が無効なメールアカウントを使用してログインしようとした際に、チェックアウトログインポップアップのメールフィールド検証エラーが、カスタマーログインページのメール検証エラーと一致するようになりました。

<!-- MC-42764-->

* 管理者から出荷コメントが追加され、「**顧客に通知**」チェックボックスがアクティブ化されると、Magento Open Sourceの出荷詳細メールにエラーメッセージが含まれなくなりました。 以前は、出荷確認メールにこのメッセージが含まれていました：`We're sorry, an error has occurred while generating this content`。

<!-- MC-42486-->

* 地域 ID と国 ID の値がメールテンプレートで正しく変換されるようになりました。 以前は、管理者のメールテンプレートで **プレビューリンク** をクリックすると、国と地域名が正しく表示されていませんでした。

<!-- MC-36262-->

* デフォルト以外のストア表示に対して管理者から送信される販売更新メールに、正しい注文ステータスラベルが含まれるようになりました。 以前は、これらのメールには常にデフォルトストアからのステータスが表示されていました。 [GitHub-29263](https://github.com/magento/magento2/issues/29263)

<!-- AC-721-->

* Magento Open Sourceでは、期待どおりに `Content-Disposition: inline` ヘッダーがメールに含まれるようになりました。 [GitHub-29258](https://github.com/magento/magento2/issues/29258)

<!-- magento/magento2/pull/32720-->

* Microsoft Outlook および MS Exchange Server を使用したデプロイメントで、注文と発送の通知メールが期待どおりに動作するようになりました。 以前は、メール本文は空でしたが、ATT*のラベルが付いた添付ファイルが含まれていました。 [GitHub-25076](https://github.com/magento/magento2/issues/25076)

<!-- ACP2E-47-->

* 注文メールに、買い物客のロケールを想定どおりに使用してローカライズされたデータが含まれるようになりました。 以前は、注文メールには管理者ロケールが使用されていました。

<!-- ACP2E-107-->

* メールテンプレートのプレビューをクリックすると、期待どおりに、別のウィンドウでテンプレートのプレビューが開くようになりました。  以前は、applicationOpen Sourceは、メールテンプレートグリッドとポップアップウィンドウでテンプレートのプレビューを同時に開いていました。

<!-- ACP2E-127-->

* デフォルト以外の web サイトから送信される非同期注文メールに、適切な web サイトのロゴ URL が含まれるようになりました。 以前は、これらのメールには常にデフォルトまたはプライマリ web サイトのロゴが含まれていました。 （`storeCode` 値を持つデフォルトのキーは、`UrlInterface` `getUrl` 関数に渡される 2 番目の配列引数に割り当てられています。 この値は、異なるストアや web サイトに対する URL を区別し、顧客に送信されるメールコンテンツの正しい `baseUrl` を生成します）。

### フレームワーク

<!-- AC-515-->

* 数値と数値以外の文字列の厳密でない比較は、数値を文字列にキャストし、文字列を比較することで機能するようになりました。 数値と数値文字列の比較は、引き続き以前と同様に機能します。 これは、`0 == "not-a-number"` が false と見なされたことを意味します。 [GitHub-33780](https://github.com/magento/magento2/issues/33780)

<!-- AC-1338-->

* ヘルパー `Magento\Payment\Helper\Data` は、コンストラクターに新しいレイアウトを作成しなくなりました。 以前は、市外局番を指定せずにカスタムコマンドでこのヘルパーを使用すると、Magento Open Sourceがエラーをスローしていました。 [GitHub-33908](https://github.com/magento/magento2/issues/33908)

<!-- AC-1068-->

* `allure-framework/allure-php-api` Composer の依存関係を更新しました。

<!-- MC-42091-->

* ブートストラップファイルで例外が発生した場合、Magento Open Sourceは 500 応答コードを返すようになりました。 以前は、applicationOpen Sourceは 200 OK のステータスコードを返していました。 [GitHub-22196](https://github.com/magento/magento2/issues/22196)

<!-- AC-1318-->

* 通貨記号が、ストアフロントの製品の詳細ページで期待どおりに読み込まれるようになりました。 以前は、この記号は、JavaScriptページがリロードされると表示されなくなることがありました。

<!-- AC-719-->

* `symfony/console` を更新しても、`bin/magento setup:di:compile` の実行時にエラーが発生しなくなりました。 [GitHub-33595](https://github.com/magento/magento2/issues/33595)

<!-- AC-1504-->

* PHP 8.x をサポートするMagento Open Sourceで配布される `.htaccess` ファイルと `nginx.conf` ファイルに、新しい必要なオプションが追加されました。 古いオプションも削除されました。 [GitHub-34358](https://github.com/magento/magento2/issues/34358)

<!-- MC-42448-->

* マーチャントは、複数の製品用のビデオをアップロードできるようになりました。 アップロードされたファイル名に拡張子が含まれる場合にのみ、ファイル生成プロセスによってファイル名に拡張子が追加されるようになりました。 以前は、マーチャントが 2 つの異なる商品に対して同じビデオをアップロードして保存しようとすると、Sourceを開くアプリケーションで `Notice: Undefined index: extension in /app/7ha7zds7wvqys_stg/vendor/magento/framework/File/Uploader.php on line 699` というエラーが発生していました。 この問題は、アップロードされたファイル名に拡張子が付いているかどうかに関係なく、Magento Open Sourceがファイル拡張子を名前に追加しようとすることが原因で発生していました。

<!-- magento/magento2/pull/34106-->

* コードベース全体で PHP 8.x との互換性を確保するため、`sprintf(__())` および `sprintf(Magento\Framework\Phrase())` の構成の問題を修正しました。 以前は、applicationOpen Sourceが次のタイプのエラーをスローしていました：`Expected parameter of type 'string', 'Magento\Framework\Phrase' provided`。 [GitHub-34085](https://github.com/magento/magento2/issues/34085)

<!-- AC-1605-->

<!-- MC-42934-->

* 詳細検索クエリパラメーターの検証を改善しました。 [GitHub-33589](https://github.com/magento/magento2/issues/33589)

<!-- ACP2E-69-->

* `bin/magento support:backup:code` を実行すると、期待どおりにバックアップが作成されるようになりました。 以前は、applicationOpen Sourceはバックアップを作成しましたが、エラーがスローされました。

<!-- ACP2E-82-->

* 正常に実行された `cron` プロセスには、現在、`success` のステータスが割り当てられています。 以前は、成功した `cron` プロセスに `cron` のステータスが割り当てられていたため、同じ `pending` プロセスを 2 回実行できました。

<!-- ACP2E-102-->

* `Magento_Logging` モジュールで IPv6 がサポートされるようになりました。

### 一般的な修正点

<!-- MC-42506-->

* Magento Open Sourceでは、商品を複製する際、定義済みのスコープに従ってすべての商品フィールドをコピーするようになりました。 以前は、「**name**」フィールドと「**description**」フィールドは範囲にリセット `global` れていました。

<!-- MC-42612-->

* Magento Open Sourceでは、商品価格が 0 の場合に割引にデルタ丸めを適用しなくなりました。 以前は、applicationOpen Sourceは、負の割引額を計算していました。

<!-- MC-42215-->

* 空の開始日と期限切れの終了日が割り当てられた **新規として設定** 属性を持つ製品を正常に保存できるようになりました。 以前は、次の設定で商品を保存すると、applicationOpen Sourceがこのエラーをスローしていました：`Make sure the To Date is later than or the same as the From Date`。

<!-- MC-42775-->

* 管理者は、最大処理時間にわたって実行されている操作を再試行できるようになりました。 デフォルトの最大値は 12 時間です。

<!-- MC-42514-->

* コンシューマーに対して確認されていないメッセージが原因で、一括アクション処理中に破損したパイプエラーが発生しなくなりました。 プリフェッチ カウント プロパティで、コンシューマーに対するこれらのメッセージを制限し、エラーを回避できるようになりました。 以前は、`bin/magento queue:consumers:start async.operations.all` を実行すると、次のエラーが生成されていました：`Broken pipe or closed connection`。

<!-- MC-42075-->

* 2 回目のログイン試行に失敗した後、買い物客は期待どおりにログインページにリダイレクトされるようになりました。 以前は、2 回目のログイン試行に失敗すると、買い物客は 404 ページにリダイレクトされていました。 [GitHub-32885](https://github.com/magento/magento2/issues/32885)

<!-- magento/magento2/pull/25279-->

* パスワード変更ページの送信中に競合状態が発生しないように、パスワードリセットトークンの有効期限が延長されました。 [GitHub-29647](https://github.com/magento/magento2/issues/29647)

<!-- AC-1316-->

* 新しい統合に割り当てられた権限が適用されるようになりました。 [GitHub-33347](https://github.com/magento/magento2/issues/33347)

<!-- AC-1328-->

* お問い合わせフォームの例外ログに残るメッセージに影響を与えるリグレッションの問題を修正しました。 [GitHub-34483](https://github.com/magento/magento2/issues/34483)

<!-- magento/magento2/pull/31654-->

* JavaScriptの顧客データの読み込みに関する複数の問題を解決しました。 [GitHub-30498](https://github.com/magento/magento2/issues/30498)

<!-- magento/magento2/pull/33324-->

* 拡張機能で `QuoteIdToMaskedQuoteId` を使用しても、応答時間が大幅に増加しなくなりました。 [GitHub-33676](https://github.com/magento/magento2/issues/33676)

<!-- AC-720-->

* `BundleDiscountPrice` のクラス `magento2/app/code/Magento/Bundle/Pricing/Price/ConfiguredPrice.php` が正常に宣言されました。 以前は、applicationOpen Sourceが `Class Magento\Bundle\Pricing\Price\BundleDiscountPrice not found` というエラーをスローしていました。 [GitHub-33334](https://github.com/magento/magento2/issues/33334)

<!-- AC-1239-->

* AWS S3 アダプタによって書き込まれたエスケープ CSV フィールドの値が、他のファイルシステムアダプタによって書き込まれたデータと一致するようになりました。

<!-- MC-43046-->

* S3 互換ストレージがサポートされるようになりました。 [GitHub-32114](https://github.com/magento/magento2/issues/32114)

<!-- ACP2E-123-->

* あるデバイスからログアウトしても、他のデバイスから買い物客が自動的にログアウトされなくなりました。

### GraphQL

<!-- PWA-1938-->

* `generateCustomerToken` と `revokeCustomerToken` の突然変異によって、ユーザー状態の正しいキャッシュ ID が提供されるようになりました。 以前は、これらの突然変異によって無効な `x-magento-cache-id` が使用されたため、パフォーマンスが低下していました。

<!-- PWA-1506-->

* `setBillingAddressToCart` のミューテーションでは、`same_as_shipping` パラメーターを正しく使用して、期待どおりに配送先住所に一致する請求先住所を設定できるようになりました。 以前は、applicationOpen Sourceに「`The shipping method is missing. Select the shipping method and try again`」というエラーが表示されていました。 [GitHub-30924](https://github.com/magento/magento2/issues/30924)

<!-- PWA-1980-->

* GraphQLの買い物かごの操作で、クエリが要求した場合にのみ買い物かごの総計が計算されるようになりました。 以前は、買い物かごの操作では常に総計を計算していましたが、これはリソースを大量に消費する操作でした。

<!-- MC-42781-->

* `addProductsToCart` ミューテーションは、ヘッダーで定義されたストアに割り当てられている製品のみを買い物かごに追加するようになりました。

<!-- MC-42783-->

* レイヤー化されたナビゲーションフィルターを使用する `products` クエリで、正しい子カテゴリリストが返されるようになりました。 [GitHub-33387](https://github.com/magento/magento2/issues/33387)

<!-- MC-42831-->

* `ConfigurableCartItem` オブジェクトを返すクエリとミューテーションには、設定されたバリアントに関する情報が期待どおりに含まれます。

<!-- MC-42082-->

* `products` クエリは、設定製品オプションの値とバリアント属性値を返すようになりました。 以前は、クエリの応答でこれらの値が空でした。

<!-- MC-41794-->

* ストア表示レベルで子製品が無効になっている場合、`products` クエリでバンドル製品を正しくフィルタリングできるようになりました。 以前は、クエリは、ストアビューレベルで無効にされた子製品を返していました。

<!-- MC-42903-->

* `setShippingAddressesOnCart` 電話を表示 **管理設定がオプションに設定されている場合、** のミューテーションでは、空の電話番号値を使用した買い物かごの配送先住所の設定がサポートされるようになりました。 以前は、applicationOpen Sourceが `Field CartAddressInput.telephone of required type String! was not provided` というエラーをスローしていました。

<!-- MC-42970-->

* `addSimpleProductsToCart` のミューテーションによって、ターゲットの web サイトに割り当てられていないシンプルな製品を買い物かごに追加できた問題を修正しました。

<!-- MC-42600-->

* MySQL クエリは、検索パラメーターを使用して検索結果を絞り込むGraphQL `products` クエリ用に最適化されました。

<!-- MC-43189-->

* リクエストされたスコープに製品が含まれていない場合、`addConfigurableProductToCart` のバリエーションでは、買い物かごへの製品の追加をサポートしなくなりました。

<!-- MC-42666-->

* `products` クエリは、リクエストされた storereview に割り当てられている設定可能なバリアントのみを返すようになりました。 以前は、リクエストされた設定可能な製品のすべてのバリアントが返されていました。

<!-- MC-42652-->

* `addSimpleProductsToCart` リクエストが並行して正常に実行できるようになりました。 以前は、同じ SKU に対して複数のリクエストを行うと、製品数量が期待どおりに増えるのではなく、同じ買い物かご ID で重複する行項目が作成されていました。

<!-- AC-856-->

* `addProductsToCompareList` のミューテーションを使用して、設定可能な製品のバリアントを比較できるようになりました。

<!-- MC-42443-->

* バックエンドから階層製品の価格が更新されると、顧客の買い物かごで新しい価格が正しく更新されます。 以前は、買い物かごの概要セクションの小計が正しく更新されましたが、行の小計は更新されませんでした。

<!-- AC-697-->

* 複数の選択オプションを持つバンドル製品の追加に使用する場合、`addProductsToCart` のミューテーションによって、選択したすべてのオプションが買い物かごに追加されるようになりました。 以前は、ミューテーションは最後の選択のみを追加しました。 [GitHub-33123](https://github.com/magento/magento2/issues/33123)

<!-- MC-38815-->

* オプションの電話フィールドの値が空の文字列に設定されている場合、GraphQL クエリは、期待どおりに請求アドレスを返すようになりました。 以前は、クエリは null アドレス値を返していました。 [GitHub-30218](https://github.com/magento/magento2/issues/30218)

<!-- ACP2E-51-->

* 複数の製品の関連度または価格が同じ場合、`products` のクエリ応答では、指定した並べ替え順に従って製品がリストされるようになりました。

<!-- ACP2E-75-->

* `addSimpleProductsToCart` と `addProductsToCart` の同時要求で、見積項目の重複が発生しなくなりました。

<!-- ACP2E-76-->

* クエリ `products` 階層化されたナビゲーションフィルターで、正しい子カテゴリリストが返されるようになりました。 リクエストで `includeDirectChildrenOnly` フラグが提供されている場合、直接のサブカテゴリのみが含まれるようになりました。 以前は、製品が複数のカテゴリに割り当てられると、すべてのカテゴリが集計セクションの応答に含まれていました。

<!-- ACP2E-132-->

* GraphQL検索クエリに検索提案機能を追加しました。

<!-- ACP2E-288-->

* 顧客の注文アドレスを返したり変更したりする `OrderAddress.telephone` クエリやその他のクエリおよびミューテーションで、「`customer`」フィールドがオプションになりました。

<!-- ACP2E-278-->

* API を介してグループ ID が変更された場合、ストアフロントと管理者の両方で指定されたグループの顧客の価格が正しく更新されるようになりました。 以前は、API を使用してグループ ID が変更された場合、これらの価格は正しく更新されませんでした。

### 画像

<!-- MC-42080-->

* 透明背景を持つ透かし画像で、オーバーレイする透明製品画像に白い背景が表示されなくなりました。 以前は、透かし画像と商品画像の両方の背景が透明な場合、透かしが白い背景で表示されていました。

<!-- AC-1240-->

* AWS S3 が有効な場合、請求書および配送領収書のロゴがアップロードされ、期待どおりに表示されるようになりました。

<!-- MC-42160-->

* 管理者がストア URL とは異なるドメインに設定されているデプロイメントのCMSページに追加された画像に関連付けられたメディアタグに、ストア URL が期待どおりに含まれるようになりました。 以前は、メディアタグに、想定されるストア URL ではなく静的な管理 URL が含まれていました。 [GitHub-32930](https://github.com/magento/magento2/issues/32930)

<!-- ACP2E-315-->

* 画像のキャッシュをフラッシュすると同時にストアフロントに画像を読み込む際に、Magento Open Sourceがエラーをスローしなくなりました。

### インポート/エクスポート

<!-- AC-1486-->

* ファイル名が似ているが、1 文字または 2 文字のみが異なる場合、`bin/magento remote-storage:sync` は失敗しなくなりました。 以前は、最初の画像は正しく保存されていましたが、2 番目の同様の名前の画像が同期エラーをトリガーし、次のエラーが発生しました：`Notice: Undefined index: media/catalog/product/5/_ in /src/vendor/magento/module-remote-storage/Driver/Adapter/Cache/Generic.php on line 197`。 [GitHub-34337](https://github.com/magento/magento2/issues/34337)

<!-- MC-41672 23734-->

* Magento Open Sourceは、スケジュールされた書き出し後に、書き出しファイル名のタイムスタンプをユーザーのタイムゾーンに変換するようになりました。 以前は、これらの値は変換されず、Magento Open Sourceには UTC タイムスタンプが表示されていました。

<!-- MC-42330-->

* 同じ CSV ファイルを複数回読み込んでも、Magento Open Sourceでリモートストレージに重複した画像が作成されなくなりました。

<!-- AC-1045-->

* インポートは、次のメッセージで失敗しなくなりました：`Import failed: Area code not set: Area code must be set before starting a session`。 [GitHub-16171](https://github.com/magento/magento2/issues/16171)

<!-- AC-988-->

* `bin/magento app:config:dump` を実行して `config.php` を手動で編集した後で、を正常に読み込めるようになりました。 [GitHub-31428](https://github.com/magento/magento2/issues/31428)

<!-- MC-41672-->

* カスタムの複数選択属性で、デフォルト以外の複数の値区切り記号を使用できるようになりました。 以前は、読み込み中に検証が失敗していました。 [GitHub-23156](https://github.com/magento/magento2/issues/23156)

<!-- ACP2E-86-->

* カテゴリ内の製品の位置が、CSV からの読み込み時に正しく割り当てられるようになりました。

### 索引

<!-- MC-42791-->

* Magento Open Sourceでは、インデックスを再作成した後、想定どおりにストアフロントに製品が表示されるようになりました。 以前は、インデックスを再作成する最初の 500 個の製品が在庫切れになり、次の 500 個の製品が在庫切れになると、ストアフロントに追加の製品は表示されませんでした。

<!-- magento/magento2/pull/27212-->

* 結合された `indexer.xml` ファイルの一貫性の問題を解決しました。 `classType` で使用できる値は、結合されていない `indexer.xml` ファイルと結合されたファイルで同じになりました。 [GitHub-29609](https://github.com/magento/magento2/issues/29609)

<!-- AC-190-->

* カテゴリインデクサーには、完全なインデクサーと部分的なインデクサーが並行して実行されるのを防ぐ同期メカニズムが実装されています。 以前は、これらのインデクサーを並行して実行した場合、ストアフロントのカテゴリページから製品を一時的に除外したり、カテゴリページで製品が一時的に空になったりすることができました。

### インフラストラクチャ

<!-- AC-1172-->

* サポートされていない `str_contains` メソッドは、サポートされている機能に置き換えられました。 これは、Magento Open Source 2.4.3 の既知の問題でした。[GitHub-33680](https://github.com/magento/magento2/issues/33680)

<!-- magento/partners-magento2ee/pull/573-->

* コードベースをリファクタリングし、キーワード `match` の使用法を修正しました。これは PHP 8.x の予約キーワードです。[GitHub-33626](https://github.com/magento/magento2/issues/33626)

* カスタム要素を含む空でない要素に対する JQuery 3.5.x の標準を満たすために、HTML タグが適切にネストされ、閉じられるようになりました。<!-- AC-1942-->

<!-- magento/magento2/pull/34234)-->

* PHP7.x および PHP8.x との互換性のために、`abs()` および `round()` 関数を修正しました。 [GitHub-34322](https://github.com/magento/magento2/issues/34322)

<!-- AC-719-->

* `symfony/console` を更新しても、`bin/magento setup:di:compile` の実行時にエラーが発生しなくなりました。 [GitHub-33595](https://github.com/magento/magento2/issues/33595)

<!-- magento/magento2/pull/34175-->

* `colinmollenhour/cache-backend-redis` Composer の依存関係の制限を修正しました。 [GitHub-34177](https://github.com/magento/magento2/issues/34177)

<!-- magento/magento2/pull/33932 magento/magento2/pull/33992-->

* コードベースはリファクタリングされ、`phpunit/phpunit` の非推奨メソッドの呼び出しを削除しました。 [GitHub-33916](https://github.com/magento/magento2/issues/33916)

<!-- MC-42960-->

* 読み取り専用 `pubs/media` ーザーを持つ管理者が画像を含む商品の商品詳細ページにアクセスしようとすると、Magento Open Sourceに情報エラーが表示されるようになりました。 以前は、applicationOpen Sourceが PHP エラーをスローしていました。 [GitHub-32819](https://github.com/magento/magento2/issues/32819)

<!-- AC-853-->

* すべてのメンバーレベルの `@api` 注釈は、コードベース全体でクラスに移動されています。

<!-- AC-1977-->

* ウィジェッ `gift-card Cms` データが `Magento/WidgetSampleData` （Magento Open Source）から `Magento/GiftCardSampleData` （Adobe Commerce）に移動されました。 これにより、PHP8.1 上でサンプルデータを使用して（Magento Open Source）をインストールする際の問題が解決されました。

<!-- AC-1001-->

* 必要に応じて、Adobe Stock統合コードベース全体で `@api` を使用したインターフェイスをマークしました。 [GitHub-32875](https://github.com/magento/magento2/issues/32875)

<!-- AC-1770-->

* 結果セット内の整数とフロートは、エミュレートされたプリペアドステートメントを使用する場合、文字列の代わりにネイティブの PHP 型を使用して返されるようになりました。 [GitHub-34625](https://github.com/magento/magento2/issues/34625)

<!-- AC-1697-->

* PHP 8.1 との互換性を確保するため、false 値からの配列の自動作成は無効になりました。

<!-- AC-1338-->

* ヘルパー `Magento\Payment\Helper\Data` は、コンストラクターに新しいレイアウトを作成しなくなりました。 以前は、市外局番を指定せずにカスタムコマンドでこのヘルパーを使用すると、Sourceを開くアプリケーションでエラーがスローされていました。 [GitHub-33908](https://github.com/magento/magento2/issues/33908)

<!-- AC-1077-->

* `data` を使用して、`di.xml` 引数をブロックインスタンスコンストラクターに渡すことができるようになりました。

<!-- MC-43096-->

* 読みやすくするために最適化された `Generator.php`。 [GitHub-33809](https://github.com/magento/magento2/issues/33809)

<!-- AC-1313-->

* `JwsManager` クラスの JWK チェックが改善され、アルゴリズムがヘッダーで直接設定されている場合に状況を処理できるようになりました。 以前は、このチェックではこの有効なシナリオが無視されていました。 [GitHub-32636](https://github.com/magento/magento2/issues/32636)

#### JavaScriptの依存関係の更新

<!-- magento/magento2/pull/33871-->

* サードパ `jquery-validate` ティライブラリのインストール [GitHub-33853](https://github.com/magento/magento2/issues/33853)

<!-- ENGCOM-8667-->

* `Less.js` （v3.13.1） [GitHub-32845](https://github.com/magento/magento2/issues/32845)

#### ライブラリの削除と非推奨

* Magento Open Source 2.4.x がサポートするすべてのブラウザーがこの機能を組み込んでサポートしているため、次のライブラリは削除されました。

   * `es6-collections.js`   <!-- AC-18-->
   * `MutationObserver.js` <!-- AC-15-->
   * `Modernizr` <!-- AC-12-->
   * `FormData.js`

* 未使用の `jquery.hoverIntent` JavaScript ライブラリを削除した。 [GitHub-33732](https://github.com/magento/magento2/issues/33732) <!-- AC-97-->

* `lib/internal/Magento/Framework/Filter/Money.php` は非推奨（廃止予定）になりました。 これには `money_format()` 関数が含まれていますが、これは PHP 8.x で削除されました。[GitHub-33870](https://github.com/magento/magento2/issues/33870)<!-- magento/magento2/pull/34366)-->

* 非推奨（サポート対象外）の `grunt-autoprefixer` パッケージを削除しました。 [GitHub-34037](https://github.com/magento/magento2/issues/34037) <!-- magento/magento2/pull/34032-->

#### ライブラリのアップグレード

* 次のライブラリはより新しいバージョンにアップグレードされました。

   * `script.aculo.us` <!-- AC-363-->
   * `Chart.js`  <!-- AC-361-->
   * `moment.js` <!-- AC-11-->
   * `moment-timezone-with-data.js`   <!-- AC-10-->
   * `matchMedia.js` <!-- AC-8-->
   * `underscore.js`  <!-- AC-13-->
   * `PrototypeJS`  <!-- AC-17-->
   * `RequireJS`
   * `LessCSS`

### 請求書

<!-- AC-1564-->

* 文字列のプレフィックスが付いた場合に、自動インクリメントされる請求書 ID の `int` へのキャストが削除されました。 その結果、請求書には、文字列で始まる数値に対して 0 が表示されるようになりました。 [GitHub-34451](https://github.com/magento/magento2/issues/34451)

### ログ

<!-- MC-42360-->

* **システム**/**一括アクション** で一括アクションを実行する失敗した API 呼び出しのログエントリをMagento Open Sourceが作成しなくなりました。 以前は、失敗した API 呼び出しの永続的なエントリが一括アクションログに追加されていました。

<!-- AC-1607-->

* false 値からの配列の自動作成は許可されなくなりました。 [GitHub-34499](https://github.com/magento/magento2/issues/34499), [GitHub-34589](https://github.com/magento/magento2/issues/34589)

### Adobe Commerceコーディング基準

<!-- magento/magento-coding-standard/pull/219-->

* `phpunit/ phpunit` を `magento-coding-standard` リポジトリの最新バージョンに更新しました。 [GitHub-33622](https://github.com/magento/magento2/issues/33622)

<!-- magento/magento2/pull/33858-->

* Adobe Commerce コーディング標準リポジトリのバージョン ^14.9 への `webonyx/graphql-php` 依存関係を更新しました。 [GitHub-32863](https://github.com/magento/magento2/issues/32863)

<!-- magento/magento-coding-standard/pull/322-->

* Adobe Commerceのコーディング標準に、false 値からの配列の自動作成を識別する新しい sniff `Magento2.PHP.ArrayAutovivification` が追加されました。 [GitHub-34509](https://github.com/magento/magento2/issues/34509)

<!-- magento/magento-coding-standard/pull/325-->

* Adobe Commerceのコーディング標準に新しいスニフ `Magento2.Functions.DeprecatedFunction` ートを追加しました。 [GitHub-34547](https://github.com/magento/magento2/issues/34547)

<!-- magento/magento-coding-standard/pull/326-->

* Adobe Commerceのコーディング標準で、`Magento2.Functions.DiscouragedFunction` をスニッフィングする非推奨（廃止予定）の関数を追加しました。 [GitHub-34548](https://github.com/magento/magento2/issues/34548)

<!-- magento/magento-coding-standard/pull/335-->

* `Magento2.Annotation.MethodAnnotationStructure` のスニッフィングが失敗して偽陽性になることはありません。 [GitHub-34679](https://github.com/magento/magento2/issues/34679)

### メディアギャラリー

<!-- AC-1054-->

* AWS S3 が有効になっているデプロイメントで `bin/magento media-gallery:sync` コマンドが失敗しなくなりました。

<!-- AC-1000-->

* 新しく追加された Media Gallery メニュー項目が 11 を超え、「古い Media Gallery を有効にする **設定が有効になっている場合に、コンテンツのサブメニュータイトル** 表示されるようになりました。 [GitHub-33889](https://github.com/magento/magento2/issues/33889)

<!-- MC-42837-->

* 画像を多く含む製品を編集する際の「メディアギャラリー」タブの読み込み時間が改善されました。 [GitHub-33434](https://github.com/magento/magento2/issues/33434)

### MFTF

<!-- AC-516-->

* `CURLOPT_POSTFIELDS` は、オブジェクトを配列として受け入れなくなりました。 オブジェクトを配列として解釈するには、明示的（`array`）キャストを実行します。 これは、配列を受け入れるその他のオプションにも当てはまります。 [GitHub-33781](https://github.com/magento/magento2/issues/33781)

* `curl_init()` は、リソースではなく `CurlHandle` オブジェクトを返すようになりました。 `curl_close()` 関数は無効になりました。 代わりに、参照されなくなった `CurlHandle` インスタンスは自動的に破棄されます。 [GitHub-33781](https://github.com/magento/magento2/issues/33781)

<!-- AC-1397-->

* ダウンロード可能な製品の MFTF テストのエラーを修正しました。 [GitHub-34270](https://github.com/magento/magento2/issues/34270)

<!-- magento/magento2/pull/33530-->

* `CliCacheFlushActionGroup`、`CatalogSearch`、`GroupedProduct`、`Newsletter`、`Paypal` および `Quote` の各モジュールから `Review` を削除しました。 [GitHub-33531](https://github.com/magento/magento2/issues/33531)

<!-- AC-515-->

* 数値と数値以外の文字列の厳密でない比較は、数値を文字列にキャストし、文字列を比較することで機能するようになりました。 数値と数値文字列の比較は、引き続き以前と同様に機能します。 つまり、0==「not-a-number」は false と見なされます。 [GitHub-33780](https://github.com/magento/magento2/issues/33780)

<!-- AC-517-->

* `parse_url()` は、存在しないクエリと空のクエリおよびフラグメントを区別できるようになりました。 [GitHub-33782](https://github.com/magento/magento2/issues/33782)

<!-- magento/magento2-functional-testing-framework/pull/873-->

* `ReflectionType::isBuiltin()` メソッドの使用時に致命的なエラーが発生するのを回避するために、コードベースを更新しました。 [GitHub-34194](https://github.com/magento/magento2/issues/34194)

#### 新規アクショングループ

`AdminCheckOrderStatusInGridActionGroup` [GitHub-33747](https://github.com/magento/magento2/issues/33747)

`StorefrontSelectFirstShippingMethodActionGroup` [GitHub-33773](https://github.com/magento/magento2/issues/33773)

`AdminClickUpdateChangesOnCreateOrderPageActionGroup` [GitHub-33689](https://github.com/magento/magento2/issues/33689)

#### アクショングループ

これらのテストでは、繰り返しアクションがアクショングループに置き換えられました。

`AdminAddInStockProductToTheCartTest` [GitHub-34512](https://github.com/magento/magento2/issues/34512)

`AdminAddBundleItemsTest` [GitHub-34312](https://github.com/magento/magento2/issues/34312)

`AdminConfigurableProductAddConfigurationTest` [GitHub-34511](https://github.com/magento/magento2/issues/34511)

`AdminConfigurableProductBulkUpdateTest` [GitHub-34435](https://github.com/magento/magento2/issues/34435)

`AdminConfigurableProductDisableAnOptionTest` [GitHub-34511](https://github.com/magento/magento2/issues/34511)

`AdminConfigurableProductOutOfStockAndDeleteCombinationTest` [GitHub-34316](https://github.com/magento/magento2/issues/34316)

`AdminConfigurableProductOutOfStockTestDeleteChildrenTest` [GitHub-34316](https://github.com/magento/magento2/issues/34316)

`AdminConfigurableProductRemoveAnOptionTest` [GitHub-34511](https://github.com/magento/magento2/issues/34511)

`AdminConfigurableProductRemoveConfigurationTest` [GitHub-34511](https://github.com/magento/magento2/issues/34511)

`AdminCreateAndEditSimpleProductSettingsTest` [GitHub-34435](https://github.com/magento/magento2/issues/34435)

`AdminCreateAndEditVirtualProductSettingsTest` [GitHub-34435](https://github.com/magento/magento2/issues/34435)

`AdminCreateInactiveFlatCategoryTest` [GitHub-34490](https://github.com/magento/magento2/issues/34490)

`AdminCreateInactiveInMenuFlatCategoryTest` [GitHub-34510](https://github.com/magento/magento2/issues/34510)

`AdminCreateDuplicateCategoryTest` [GitHub-34414](https://github.com/magento/magento2/issues/34414)

`AdminCreateDuplicateProductTest` [GitHub-34414](https://github.com/magento/magento2/issues/34414)

`AdminDeleteSimpleProductTest` [GitHub-33783](https://github.com/magento/magento2/issues/33783)

`AdminEditRelatedBundleProductTest` [GitHub-34313](https://github.com/magento/magento2/issues/34313)

`AdminMassDeleteBundleProductsTest` [GitHub-34313](https://github.com/magento/magento2/issues/34313)

`AdminNavigateMultipleUpSellProductsTest` [GitHub-34314](https://github.com/magento/magento2/issues/34314)

`AdminSimpleProductSetEditContentTest` [GitHub-34435](https://github.com/magento/magento2/issues/34435)

`AdminSimpleProductTypeSwitchingToConfigurableProductTest` [GitHub-33788](https://github.com/magento/magento2/issues/33788)

`AdminConfigurableProductTypeSwitchingToVirtualProductTest` [GitHub-33788](https://github.com/magento/magento2/issues/33788)

`AdminCreateConfigurableProductWithDisabledChildrenProductsTest` [GitHub-33775](https://github.com/magento/magento2/issues/33775)

`AdminUpdateFlatCategoryAndAddProductsTest` [GitHub-34490](https://github.com/magento/magento2/issues/34490)

`AdminUpdateTopCategoryUrlWithNoRedirectTest` [GitHub-33774](https://github.com/magento/magento2/issues/33774)

`AdminUpdateTopCategoryUrlWithRedirectTest` [GitHub-33774](https://github.com/magento/magento2/issues/33774)

`CatalogProductListWidgetOperatorsTest` [GitHub-34579](https://github.com/magento/magento2/issues/34579)

`CreateProductAttributeEntityWithReservedKeysTest`[GitHub-34422](https://github.com/magento/magento2/issues/34422)

`EnableDisableBundleProductStatusTest` [GitHub-34313](https://github.com/magento/magento2/issues/34313)

`StorefrontCheckRefundGrandTotalActionGroup` [GitHub-34315](https://github.com/magento/magento2/issues/34315)

`StorefrontInactiveCatalogRuleTest` [GitHub-33556](https://github.com/magento/magento2/issues/33556)

`StorefrontConfigurableProductCantAddToCartTest` [GitHub-33786](https://github.com/magento/magento2/issues/33786)

`StorefrontConfigurableProductOptionsTest` [GitHub-33785](https://github.com/magento/magento2/issues/33785)

`StorefrontConfigurableProductCanAddToCartTest` [GitHub-33784](https://github.com/magento/magento2/issues/33784)

`StorefrontConfigurableProductGridViewTest` [GitHub-34311](https://github.com/magento/magento2/issues/34311)

`StorefrontConfigurableProductListViewTest` [GitHub-34311](https://github.com/magento/magento2/issues/34311)

`StorefrontProductNameWithHTMLEntitiesTest` [GitHub-33806](https://github.com/magento/magento2/issues/33806)

`StorefrontProductNameWithDoubleQuoteTest` [GitHub-32991](https://github.com/magento/magento2/issues/32991)

#### 新しいテスト

`AdminCreateOrderWithCheckedAppendCommentCheckboxTest` [GitHub-32381](https://github.com/magento/magento2/issues/32381)

`CheckoutWithEnabledCaptchaTest` [GitHub-32991](https://github.com/magento/magento2/issues/32991)

`StorefrontAddProductWithBackordersAllowedOnProductLevelToCartTest` [GitHub-33635](https://github.com/magento/magento2/issues/33635)

`StorefrontGiftMessageForOrderOnCheckoutCartPageTest` [GitHub-32821](https://github.com/magento/magento2/issues/32821)

`StorefrontCaptchaCheckoutWithEnabledCaptchaTest` [GitHub-32821](https://github.com/magento/magento2/issues/32821)

`StorefrontCheckoutWithEnabledMinimumOrderAmountOptionTest` [GitHub-33460](https://github.com/magento/magento2/issues/33460)

#### リファクタリングされたテスト

`CaptchaWithDisabledGuestCheckoutTest` [GitHub-30828](https://github.com/magento/magento2/issues/30828)

### ニュースレター

<!-- ACP2E-147-->

* 適切な権限を持つユーザーは、顧客ニュースレターの購読を期待どおりに管理できるようになりました。 以前は、完全な権限を持つ管理者のみが、管理者の顧客アカウントページで顧客ニュースレターの購読を管理できました。

### 順序

<!-- MC-41981-->

* 買い物客は、ストアフロントと管理者の両方から、ファイル タイプとタイプのドロップダウンのカスタムオプションを組み合わせて、製品を含む既存の注文を正常に並べ替えることができるようになりました。 以前は、applicationOpen Sourceがエラーをスローし、並べ替えを処理しませんでした。

<!-- MC-42332-->

* 管理者の注文詳細ページが期待どおりに読み込まれるようになりました。 以前は、特定の税金が適用された注文の注文詳細ページを読み込むと、applicationOpen Sourceが次のエラーをスローしていました：`Call to a member function getId() on array`。

<!-- MC-38521-->

* 注文および発送権限を含む制限付き権限を持つ管理者は、注文ページを期待どおりに表示できるようになりました。 以前は、これらの権限を持つ管理者が注文を表示しようとすると、applicationOpen Sourceがエラーをスローしていました。 [GitHub-14633](https://github.com/magento/magento2/issues/14633)

<!-- ACP2E-74-->

* 買い物客は、最大数量許容制限が設定されている場合、子の設定可能な製品を含む注文を行うことができるようになりました。

## 支払い方法

<!-- AC-1830-->

* 買い物客は、Braintreeを使用して、3DS が有効になっているデプロイメントで、地域を設定せずに、請求先住所を使用して注文できるようになりました。 以前は、買い物客が **注文する** をクリックしてもチェックアウトがフリーズし、購入を完了できませんでした。 [GitHub-34204](https://github.com/magento/magento2/issues/34204)

<!-- AC-1229-->

* Venmo 支払いオプションがサポートされるようになりました。

<!-- AC-1228-->

* PayPal は BN コードで追跡できるようになりました。

<!-- AC-493-->

* Magento Open Source 2.4.2-p1 からアップグレードする際に、`bin/magento setup:upgrade` が期待どおりに実行されるようになりました。 以前は、applicationOpen Sourceが `Unable to apply data patch Magento\Paypal\Setup\Patch\Data\UpdateBmltoPayLater for module Magento_Paypal` というエラーをスローしていました。 [GitHub-33678](https://github.com/magento/magento2/issues/33678)

<!-- MC-42830-->

* 正しいストア ID を使用して、管理者への注文時に保存済みのクレジットカードを取得できるようになりました。 保存されているクレジットカードが、web サイトの範囲設定に従って注文時に表示されるようになりました。 以前は、管理者が管理者から顧客の注文を作成しようとして、ストアドクレジットカード方式を選択した場合、ストアドカードで使用できるオプションがありませんでした。

<!-- AC-344-->

* PayPal クレジットのギフトカード金額の表示の異常が解決されました。 以前は、PayPal クレジットが有効で複数のギフトカードの金額が設定されている場合、買い物客がギフトカードの値の金額を変更しても、ストアフロントは分割払いの金額を更新しませんでした。 これは、Magento Open Source 2.4.3 の既知の問題でした。

### PayPal

<!-- MC-42154-->

* Magento Open Sourceでは、PayPal Express のお支払い方法でのチェックアウト中にエラーが表示されなくなりました。 以前は、チェックアウトプロセスは完了しましたが、Sourceを開くアプリケーションに「`Something went wrong`」というエラーが表示されていました。

<!-- AC-722-->

* PayPal Express が買い物かごから期待どおりに動作するようになりました。 以前は、「**PayPal**」ボタンをクリックして買い物かごからの高速チェックアウトを開始すると、「Sourceを開く」アプリケーションで `To check out, please sign in with your email address` というエラーが発生していました。 [GitHub-33445](https://github.com/magento/magento2/issues/33445)

<!-- MC-42279-->

* PayPal Payflow Pro は、**支払いアクション** を備えた PayPal Payflow Pro ゲートウェイが **認証** に設定されているデプロイメントで、正しい親トランザクション ID を使用して遅延キャプチャを実行するようになりました。 **セール** トランザクションは、期待どおりにチェックアウト時に作成された Vault トークンの親トランザクション ID を使用して Payflow に送信されます。 以前は、**遅延キャプチャ** トランザクションが作成され、PayPal Payflow に送信されていました。 [GitHub-33445](https://github.com/magento/magento2/issues/33445)

<!-- MC-42442-->

* 買い物客は、PayPal 支払い高度な支払いが完了した後、期待どおりに成功ページにリダイレクトされるようになりました。 以前は、支払いが正常に処理され、エラーがログに記録されていなくても、買い物客はこのページにリダイレクトされませんでした。

### パフォーマンス

<!-- MC-42158-->

* モジュールリストの読み込み実行時間が改善されました。

<!-- AC-932-->

* 一般的な検索用語キャッシュのパフォーマンスが向上しました。 以前は、`search_query` テーブルが大きいほど、検索クエリの完了に時間がかかりました。 [GitHub-27559](https://github.com/magento/magento2/issues/27559)

<!-- MC-42892-->

* Magento Open Sourceはデフォルトで、商品の保存中に画像のサイズを同期的に変更します。 マーチャントは、`di.xml` ファイルに小さな編集を加えることで、バックグラウンドの非同期プロセスとして画像のサイズを変更できるようになりました。

<!-- ENGCOM-9168-->

* マルチストアデプロイメントでカテゴリ製品インデクサーのパフォーマンスを改善しました。 [GitHub-33984](https://github.com/magento/magento2/issues/33984)

<!-- AC-1179-->

* `glob()` システムコール用の新しいメモリ内キャッシュにより、`glob()` コールの数が減り、パフォーマンスが向上します。  [GitHub-34025](https://github.com/magento/magento2/issues/34025)

<!-- ACP2E-63-->

* 非同期オーダーグリッドのインデックス再作成プロセスのパフォーマンスが向上しました。

<!-- ACP2E-117-->

* 製品の書き出し時のメモリ消費を最適化しました。

### Pricing

<!-- MC-42243-->

* 製品価格が 0 に近いか等しく、共有カタログが有効な場合、価格の並べ替えが期待どおりに機能するようになりました。 以前は、価格の再インデックス中に階層価格がゼロの値は無視されていました。

### ProductAlert

<!-- MC-41917-->

* 新しい `product_alert` コンシューマーは、キューメッセージを作成し、コンシューマーを実行し、実行時間を改善することで、顧客アラートの送信を改善します。 以前は、100,000 件を超える商品アラートを送信する際に、applicationOpen Sourceがメモリ不足の例外をスローしていました。 アプリの Open Sourceでも、すべてのアラートを送信するのに 20 時間以上かかりました。

<!-- ACP2E-87-->

* カテゴリページの価格フィルターに 2 番目の値が含まれていない場合、Magento Open Sourceがエラーをスローしなくなりました。 以前は、applicationOpen Sourceがログファイルで例外をスローしていました。

### 製品ビデオ

<!-- MC-42105-->

* Magento Open Sourceでは、ビデオの追加中に不完全な URL を入力すると、「**保存**」ボタンが有効になり、フィールドが自動入力されるようになりました（管理者 **カタログ**/**製品**/**ビデオを追加**）。 以前は、「**保存**」ボタンは無効になっており、フィールドは入力されていませんでした。

### レビュー

* 製品リスト表示に、製品の正しい星評価が表示されるようになりました。 [GitHub-30196](https://github.com/magento/magento2/issues/30196)

<!-- ACP2E-89-->

* 買い物客がストアフロント製品ページで **レビュー** をクリックしても、レビューが期待どおりに表示されるようになりました。

<!-- ACP2E-111-->

* 製品の星評価が、ストアフロントの製品リストページのグリッド表示とリスト表示で一貫するようになりました。 以前は、同じ製品でもグリッド表示モードとリスト表示モードで異なる評価を持つ場合がありました。

### 売上

<!-- MC-42025-->

* MariaDB 10.2.34 へのアップグレード後、大規模なデータセットを含むテーブルの非同期モードでの販売グリッドの更新パフォーマンスが向上しました。

<!-- MC-42531-->

* Magento Open Sourceは、ストアフロントの **アカウント**/**注文**/**注文を表示** ページからHTML タグを期待どおりに削除するようになりました。 以前は、applicationOpen Sourceの「ストアフロント顧客注文コメント」セクションにHTML タグが表示されていました。

<!-- MC-42377-->

* `sales_shipment_grid.order_id` のインデックスの存在を検証する自動テストカバレッジが追加されました。

<!-- MC-43163-->

* `POST V1/orders` 呼び出しで、エラーなしで拡張機能属性を更新するようになりました。 以前は、SQL 構文エラーが発生していました。

### 検索 {#search-heading}

<!-- MC-42799-->

* 価格範囲のレイヤー化されたナビゲーションオプションが、カスタムの価格属性で期待どおりに機能するようになりました。 カスタム価格属性をフィルタリングする際に、「Sourceを開く」アプリケーションで価格移動手順の設定が使用されます。 以前は、applicationOpen Sourceでは手動のステップ設定を使用していました。

<!-- MC-42545-->

* カタログで使用可能なカテゴリの数に関係なく、ストアフロントに現在のカテゴリのすべてのサブカテゴリが階層化されたナビゲーションで表示されるようになりました。

<!-- MC-41706-->

* Elasticsearchのカタログ検索で、区分発音区別符号が区別されなくなりました。 以前は、アクセントのない用語を検索すると、アクセントのある同じ用語を検索した場合とは結果が異なっていました。

<!-- ACP2E-8-->

* 特殊文字を含む SKU 属性に対して、検索の重み付けが正しく設定されるようになりました。

<!-- ACP2E-36-->

* システム予約の製品属性コードに `category_name` が追加されました。 属性コード `category_name` を使用して product 属性を作成しようとすると、「Sourceを開く」アプリケーションにエラーが表示されるようになりました。 以前は、製品が期待されるカテゴリに表示されず、Elasticsearch エラーがログに記録されていました。

<!-- ACP2E-68-->

* GraphQLの各検索クエリの後に、一般的な検索用語が更新されるようになりました。

<!-- ACP2E-249-->

* Magento Open Sourceは、正しい価格フィールドをElasticsearchの価格指数マッピングに追加するようになりました。 以前は、web サイト ID ではなくストア ID を持つインデックスに、誤った価格フィールドが追加されていました。

### 送料

<!-- MC-42758-->

* 出荷メールに、現在の出荷のみの追跡番号が含まれるようになりました。 以前は、1 つの注文に複数の出荷が含まれている場合、各出荷の電子メールには、その注文に関連するすべての出荷の追跡番号が含まれていました。

<!-- MC-42396-->

* 複数配送モードの場合、買い物客が買い物かごから商品を削除してから 1 つの配送先住所に切り替えると、Magento Open Sourceはミニ買い物かごを正常に更新するようになりました。 以前は、製品価格が期待どおりに更新されていませんでした。

<!-- AC-267-->

* S3 ストレージアダプタを使用する場合、テーブルレートのインポートが期待どおりに動作するようになりました。 以前は、applicationOpen Sourceに「`File "https://[bucket].s3.eu-central-1.amazonaws.com/[prefix]/tmp/phpLjGmHf" not found`」というエラーが表示されていました。 [GitHub-33072](https://github.com/magento/magento2/issues/33072)

<!-- magento/magento2/pull/33232-->

* **店舗**/**設定**/**販売**/**販売メール** から出荷更新メールを期待どおりに無効にできるようになりました。 [GitHub-33165](https://github.com/magento/magento2/issues/33165)

<!-- ACP2E-31-->

* Magento Open Sourceでは、管理者およびストアフロントの請求書ページの合計に送料無料コスト（0）が表示されるようになりました。 以前は、受注に対する出荷がゼロの場合に、「Sourceのオープン」消込によって請求書ページの出荷合計に出荷合計が表示されていませんでした。

<!-- ACP2E-120-->

* オンライン配送業者への料金リクエストが、複数のリクエストから 1 つのリクエストに減らされました。 荷物の保険と商品/パッケージごとの取扱価格が正しく計算されるようになりました。 以前は、applicationOpen Sourceで FedEx 配送方式の配送料が正しく表示されていませんでした。

<!-- ACP2E-174-->

* プエルトリコからの配送用の配送ラベルを作成する際に、Magento Open Sourceに UPS 料金が表示されるようになりました。 以前は、applicationOpen Sourceにこれらの UPS 率が表示されていませんでした。

<!-- ACP2E-227-->

* 入力ボックスから取り外した後、発送先住所が期待どおりに完全にクリアされるようになりました。 以前は、アドレスを削除しても、テキストボックスに 1 文字以上の文字が保持されていました。

### ストア

<!-- MC-42884-->

* 異なる URL の複数のストアを含むデプロイメントで、顧客としてログイン機能が期待どおりに動作するようになりました。 以前は、applicationOpen Sourceは、正しいストアドメインにアクセスした場合でも、正しいストアを読み込めませんでした。

### 税

<!-- MC-41924-->

* 複数のアドレスへの配送を選択した後、お客様が商品を削除した場合に、Magento Open Sourceがミニ買い物かごの小計を正しく計算するようになりました。

<!-- MC-41945-->

* 買い物かごにバーチャル商品のみが含まれている場合、Magento Open Sourceではすべてのチェックアウトページに同じ税率が表示されるようになりました。

<!-- AC-714-->

* 設定可能な製品の階層価格で、ストアフロントに正確な税込み値と税込み値が表示されるようになりました。 以前は、含まれる税金と除外される税金の両方に同じ値が表示されていました。 [GitHub-33673](https://github.com/magento/magento2/issues/33673)

### テスト

<!-- magento/magento2/pull/34798-->

* WebAPI テストが PHP 8.1 と互換性を持つようになりました。[GitHub-34653](https://github.com/magento/magento2/issues/34653)

<!-- magento/magento2/pull/34820-->

* 統合テストが PHP 8.1 と互換性を持つようになりました。[GitHub-34567](https://github.com/magento/magento2/issues/34567), [GitHub-34569](https://github.com/magento/magento2/issues/34569)

<!-- AC-1225-->

* マーチャントは、マーチャントの場所ではなく、買い物客が所在する国の買い物客のエクスペリエンスをテストできるようになりました。

* PHP 8.x との互換性を確保するため、機能テストは安定しています。 [GitHub-34327](https://github.com/magento/magento2/issues/34327), [GitHub-34188](https://github.com/magento/magento2/issues/34188)

<!-- magento/magento2/pull/34198-->

* WebAPI テストの機能の問題を修正しました。 [GitHub-34196](https://github.com/magento/magento2/issues/34196)

<!-- AC-1207-->

* 静的テストで偽陽性が返されるエラーを修正しました。 [GitHub-34056](https://github.com/magento/magento2/issues/34056)

<!-- magento/magento2/pull/34300-->

* テストの対象範囲が `call_user_func_array` に更新されました。 [GitHub-34301](https://github.com/magento/magento2/issues/34301)

<!-- AC-1978-->

* AWS Elasticsearch:`Magento\GraphQl\CatalogGraphQl\ProductSearchTest` で `Magento\GraphQl\CatalogGraphQl\ProductSearchTest::testSearchSuggestions Failed asserting that an array is not empty. /var/www/html/dev/tests/api-functional/testsuite/Magento/GraphQl/CatalogGraphQl/ProductSearchTest.php:94 /var/www/html/dev/tests/api-functional/framework/Magento/TestFramework/TestCase/GraphQlAbstract.php:257` テストを実行した場合に、このエラーがスローされなくなりました。

<!-- magento/magento2/pull/33699-->

* すべてのモック変数の名前を `Mock` サフィックスを含むように変更し、非推奨の Object Manager クラスへの参照を削除することで、多数の重要でない単体テスト警告を修正しました。 [GitHub-33695](https://github.com/magento/magento2/issues/33695)

* `Magento\Framework\MessageQueue\TopologyTest` テストは、サービス用AWS MQ と互換性を持つよう [!DNL RabbitMQ] なりました。 以前は、このテストは次のメッセージで失敗していました：`Invalid exchange configuration: magento-topic-based-exchange1 Failed asserting that two arrays are equal`。<!-- AC-1248-->

<!-- magento/magento2/pull/34454-->

* 単体テストが PHP 8.1 と互換性を持つようになりました。[GitHub-34441](https://github.com/magento/magento2/issues/34441)

#### 単体テスト

`PHPUnit` の代わりに `AspectMock` を使用するために、次の単体テストがリファクタリングされています。

`AllureHelperTest` [GitHub-33294](https://github.com/magento/magento2/issues/33294)

`ObjectHandlerUtil` [GitHub-33584](https://github.com/magento/magento2/issues/33584)

`MockModuleResolverBuilder` [GitHub-33583](https://github.com/magento/magento2/issues/33583)

`MagentoTestCase` [GitHub-33582](https://github.com/magento/magento2/issues/33582)

`ModuleResolverTest` [GitHub-33308](https://github.com/magento/magento2/issues/33308)

`ParallelGroupSorterTest` [GitHub-33306](https://github.com/magento/magento2/issues/33306)

`SuiteGeneratorTest` [GitHub-33299](https://github.com/magento/magento2/issues/33299)

`OperationDataArrayResolverTest` [GitHub-33296](https://github.com/magento/magento2/issues/33296)

### テーマ

<!-- MC-41887-->

* Magento Open Sourceのベース URL にサブパスが設定されている場合、通知メッセージが正しく表示されるようになりました。

<!-- MC-42469-->

* ストアフロントページテンプレートに `aria-label` 要素を追加し、リンクをクリックしたときに買い物客が移動するページを示しました。 以前は、異なるページへのリンクに同じリンクテキストを使用していました。 [GitHub-33075](https://github.com/magento/magento2/issues/33075)

<!-- ACP2E-73-->

* 既存のカスタムテーマを含んだストアのホームページを読み込む際に、Magento Open Sourceでエラーメッセージが表示されなくなりました。 以前は、applicationOpen Sourceに「`The store will not work correctly in the case when cookies are disabled`」というメッセージが表示されていました。

### 翻訳とロケール

<!-- AC-285-->

* `UserExpiration` および `de_DE` のロケールで、`uk_UA` バリデーターが失敗しなくなりました。 以前は、管理者が管理者からロケールが `de_DE` または `uk_UA` に設定された新しいユーザーを作成する際に、有効期限を設定しようとすると、applicationOpen Sourceがエラーをスローしていました。 [GitHub-32497](https://github.com/magento/magento2/issues/32497)

<!-- magento/magento2/pull/33787-->

* スイスの地域名は、住所の作成または編集フォームで英語で一貫して表示されるようになりました。 [GitHub-32602](https://github.com/magento/magento2/issues/32602)

<!-- magento/magento2/pull/33128-->

* Sark 島の GY10 郵便番号をサポートするために、Guernsey の `zip_codes.xml` パターンを更新しました。 [GitHub-33144](https://github.com/magento/magento2/issues/33144)

<!-- AC-1080-->

* `directory_country_region` テーブルにベラルーシ地域を追加しました。 [GitHub-33924](https://github.com/magento/magento2/issues/33924)

<!-- AC-1178-->

* フィリピン（フィリピン）ロケールを実行しているストアフロントの表示の異常が解決されました。 [GitHub-33996](https://github.com/magento/magento2/issues/33996)

<!-- AC-1308-->

* ポルトガル（ポルトガル）ロケールに設定されたストアで新しいアカウントを作成する際に、顧客の生年月日を正常に入力できるようになりました。 以前は、アカウントを作成しようとすると、Magento Open Sourceがエラーをスローしていました。 [GitHub-34130](https://github.com/magento/magento2/issues/34130)

<!-- ACP2E-457-->

* 製品詳細ページがアラビア語（サウジアラビア）ロケールで正常に表示されるようになりました。 以前は、このロケールによって製品の詳細ページが壊れていました。

### UI

<!-- AC-258-->

* `maps.googleapis.com` を使用する MFTF テストのエラーを修正しました。

<!-- MC-41850-->

* Magento Open Sourceは、お問い合わせフォームのメール入力フィールドから改行しないスペース文字をトリミングするようになりました。 以前は、フォームは、メール入力から改行しないスペース文字（指定されている場合）を削除せずに送信されたため、ログファイルでエラーが発生していました。 また、生成されたストア管理者への連絡先メールメッセージに **返信先** フィールドがありませんでした。

<!-- MC-42793-->

* Magento Open Sourceには、管理者の役職に応じて、関連商品、アップセル商品およびクロスセル商品が表示されるようになりました。

<!-- MC-42502-->

* モーダルで使用する場合、`.action-close` のボタン `Multiselect` 期待どおりに機能するようになりました。 以前は、`action-close` ボタンはモーダルの `.action-close` ボタンの CSS を継承するので、機能しませんでした。 [GitHub-27240](https://github.com/magento/magento2/issues/27240)

<!-- AC-1217-->

* オファーリッチスニペットが、製品ビューのメインの「価格」フィールドに表示されるようになりました。 以前は、製品表示の関連製品ブロックのこのフィールドにこのスニペットが見つからなかったので、Googleの検索結果に誤った価格が表示されていました。 [GitHub-34063](https://github.com/magento/magento2/issues/34063)

<!-- AC-1584-->

* iOSを実行するデバイスのモーダルの高さの問題が解決されました。 [GitHub-34467](https://github.com/magento/magento2/issues/34467)

<!-- MC-40106-->

* アクション ドロップダウンメニューがストアフロント全体で正しく配置されるようになりました。 [GitHub-31379](https://github.com/magento/magento2/issues/31379)

<!-- AC-1589-->

* 買い物かごページとチェックアウトページでのナビゲーションに関するアクセシビリティエラーが解決されました。 [GitHub-34483](https://github.com/magento/magento2/issues/34483)

<!-- AC-1289-->

* スクリーンリーダーで、製品ページ上の関連するすべてのフォーム要素を読み取れるようになりました。

<!-- AC-872-->

* ストアフロントカタログの製品ウィジェットの並べ替え順序（**カタログ**/**カテゴリ**/**製品**）が、管理者で設定した順序と一致するようになりました。 [GitHub-27126](https://github.com/magento/magento2/issues/27126)

<!-- AC-725-->

* 地域セレクターが、アカウントの作成ページで期待どおりに機能するようになりました。 [GitHub-30099](https://github.com/magento/magento2/issues/30099)

<!-- MC-42750-->

* 管理者の顧客グリッドに、新しく追加された `date` カスタム属性を含むすべての顧客データが、期待どおりに表示されるようになりました。 以前は、`date` 属性セットが列として設定されている場合、applicationOpen Sourceがエラーをスローし、管理者カスタマーグリッドを正しく表示できませんでした。

<!-- AC-1280-->

* **カタログ**/**製品** 詳細ページの入力ラベルが、入力の目的を正確に反映するように変更されました。 ユーザー入力が不要なフィールドに、アスタリスクの付いたラベルが表示されなくなりました。

<!-- AC-1275-->

* Tab キーを使用してリッチテキストエディターツールバーにアクセスできるようになりました。

<!-- AC-1284-->

* アクセス可能なコントロール名に、ページごとの項目数ドロップダウンに表示されるラベルのテキストが含まれるようになりました。

<!-- AC-1287-->

* **カタログ**/**製品** 詳細ページのテーブルコントロールでは、テーブルを折りたたむと、ラベルが表示され、アクセス可能な名前が付くようになりました。

<!-- AC-1285-->

* ストアフロント全体のボタンに、一意でわかりやすいアクセシブルな名前が付けられるようになりました。 以前は、テキストボタンと隣接する下向き矢印アイコンボタンを持つ分割ボタンには、同じアクセス可能な名前が付いていました。

<!-- AC-1168-->

* 管理者の注文および金額ダッシュボードグラフに **Today** 表示オプションを追加して、1 日を通しての販売および注文の概要を提供しました。 [GitHub-34008](https://github.com/magento/magento2/issues/34008)

<!-- AC-1481-->

* 複数選択 **閉じる** ボタンのアクティブ（クリック）状態が安定して機能するようになりました。 [GitHub-34338](https://github.com/magento/magento2/issues/34338)

<!-- magento/magento2/pull/31879-->

* cookie 制限モードが無効になっている場合、Magento Open Sourceでアップグレード後にこのメッセージが表示されなくなりました：`The store will not work correctly in the case when cookies are disabled`。 [GitHub-33811](https://github.com/magento/magento2/issues/33811)

<!-- ACP2E-7-->

* モバイルデバイスの縦のサムネールナビゲーション方向で、テーマにフルスクリーンの製品画像が正しく表示されるようになりました。 以前は、全画面表示モードのモバイルデバイスで、サムネールナビゲーションの方向が縦になっているテーマで、製品画像の拡大縮小や非表示が誤って行われていました。

<!-- ACP2E-23-->

* 「**ウィジェット製品をバックエンドストレージと同期** 設定が有効になっている場合に、製品の詳細ページに表示されるエラーメッセージがすぐに表示されなくなりました。

<!-- ACP2E-70-->

* 新しい返品の作成フォームの「**返品する数量** フィールドに、負の値の検証が追加されました。

<!-- ACP2E-105-->

* **アドレス検索** 設定が有効になっているデプロイメントのレビューと支払いページで、買い物客が **アドレスを変更** をクリックしても、Magento Open Sourceに重複したアドレスが表示されなくなりました。

<!-- ACP2E-136-->

* 「管理者カテゴリ」ページのストア表示スコープで作業している際に、権限が制限された管理者に対して、「**製品を追加**」ボタンが期待どおりに有効になりました。

<!-- ACP2E-169-->

* ビューのブレークポイントがMagento Open Source全体で統一されました。

<!-- ACP2E-199-->

* Magento Open Sourceの管理者カスタマーページで、カスタムのロケールを使用して、カスタムの顧客日付属性が正しく表示されるようになりました。

<!-- MC-41760-->

* ページビルダーを使用して追加された画像が、ブラウザーウィンドウ幅 768 px で表示された場合に、ストアフロントに複製されなくなりました。 以前は、このブラウザーウィンドウ幅では、アプリケーションは、モバイルとデスクトップの両方のバージョンの画像を表示することによって、ストアフロントでSourceを開く重複した画像を開きます。

### URL の書き換え

<!-- AC-1510-->

* `bin/magento setup:upgrade` の実行時に新しいストア表示を作成する際に、すべてのストア表示で URL の書き換えが再生成されなくなりました。 [GitHub-32954](https://github.com/magento/magento2/issues/32954)

### Web API フレームワーク

<!-- MC-42008-->

* 自己承認された顧客リソースの web API リクエストで、永続的な買い物かごが有効になっている場合に承認エラーがスローされなくなりました。

<!-- MC-42313-->

* PHP 7.3 で `\Magento\Framework\Api\AbstractSimpleObjectBuilder` の子クラスを使用してオブジェクトを作成できるようになりました。以前は、Magento Open Sourceが PHP 7.3 で Redhat 上でホストされている場合に、`preg_match` は次のような警告メッセージを返していました：`Warning: preg_match(): Compilation failed: unrecognized character follows...`。

<!-- MC-24548-->

* `PUT /V1/guest-carts/:cartId/collect-totals` リクエストで取得した合計が、正しい `shippingMethod` で更新されるようになりました。 [GitHub-18508](https://github.com/magento/magento2/issues/18508)

<!-- MC-30627 AC-796-->

* REST API に新しいデシリアライザーを追加しても、他のデシリアライザーが削除されなくなりました。 以前は、REST API は新しいコンテンツタイプを受け入れていましたが、API のコア定義されたコンテンツタイプは機能しなくなり、400 エラーが返されました。 [GitHub-26433](https://github.com/magento/magento2/issues/26433)

<!-- AC-698-->

* `webapi.xml` ファイルで定義されたパラメータの優先設定を削除できるようになりました。 [GitHub-33843](https://github.com/magento/magento2/issues/33843)

<!-- AC-1212-->

* Magento Open Sourceは、ログインの試行に連続して複数回失敗した後、期待どおりにGraphQLまたは REST API リクエストによって `customertoken` ールを生成するようになりました。 以前は、applicationOpen Sourceは、`lock_expires_at` の `oauth_token_request_log` の値が現在の日時より大きいかどうかを確認せず、常に失敗した試行回数を返していました。これにより、お客様はログインできなくなりました。 [GitHub-34067](https://github.com/magento/magento2/issues/34067)

<!-- AC-1190-->

* マスクされた引用符 ID を `QuoteRepository::getList` に追加しても、無限ループが発生しなくなりました。 以前は、REST API に依存する支払いプロセッサーを使用して、注文を更新すると、この動作がトリガーされていました。 [GitHub-33675](https://github.com/magento/magento2/issues/33675)

<!-- MC-41612-->

* `/rest/all/V1/categories/<above_created_category_id>`  PUTの呼び出しで、`available_sort_by` で指定された値が尊重されるようになりました。  以前は、「使用可能な製品リストの並べ替え基準」ドロップダウンが選択され、「カテゴリ」ページで可能なすべてのオプションが選択されていて、「**すべてを使用**」チェックボックスが選択されていました。 [GitHub-32596](https://github.com/magento/magento2/issues/32596)

<!-- ACP2E-11-->

* 顧客トークンを作成する REST API リクエストのパフォーマンスが向上しました。

<!-- ACP2E-91-->

* **URL にストアコードを追加** が **はい** に設定されていて、REST 呼び出しにストアコードが含まれていない場合に発生していたエラーを修正しました。 ペイロードは有効でしたが、呼び出しで次のエラーが返されました：`Fatal error: Allowed memory size of ********** bytes exhausted (tried to allocate **** bytes) in vendor/magento/module-store/Model/StoreRepository.php on line 75`。

<!-- ACP2E-153-->

* REST API を使用して、同じ注文の部分請求書を同時に作成できるようになりました。

### ウィッシュリスト

<!-- MC-41880-->

* 「サイドバーに表示 **ウィッシュリストのオプションが無効になっている場合、Magento Open Sourceによってカテゴリサイドバーのウィッシュリストがレンダリングされな** なりました。 以前は、applicationOpen Sourceはこのオプションを無視していました。

### WYSIWYG

<!-- ACP2E-17-->

* PageBuilder は、WYSIWYG エディターを使用してカスタムウィジェットを正しくレンダリングするようになりました。

## 既知の問題

**問題**:Adobe Commerce 2.4.4 からAdobe Commerce 2.4.4-p1 にアップグレードする際に、マーチャントからパッケージバージョンのダウングレードに関する通知が表示される場合があります。 これらのメッセージは無視できます。 パッケージバージョンの不一致は、パッケージ生成時の異常値が原因で発生します。 製品の機能に影響はありません。 影響を受けるシナリオと回避策の説明については、ナレッジベースの記事 [2.4.4 から 2.4.4-p1 へのアップグレード後にダウングレードされたパッケージ ](https://support.magento.com/hc/en-us/articles/8214752983949) を参照してください。

**問題**：管理者 **ストア**/**設定**/**一般**/**国オプション**/**国を許可** でオプションが選択されていない場合、買い物客は買い物かごに製品を追加できません。 代わりに、「Sourceを開く」アプリケーションに次のコンソールエラーが表示されます。`Failed to load resource: the server responded with a status of 400 (Bad Request)`。<!-- AC-2564-->

**問題**: **パートナーと拡張機能を検索** > **Magento Marketplace** の Dotdigital の説明が古くなっています。 以下は、最新の説明です。

Dotdigital は、デジタルマーケターや開発者がカスタマージャーニー全体を通じてコミュニケーションを提供するのに役立つ顧客エンゲージメントプラットフォームです。 顧客データの力を活用し、ブランドの成長と拡大に応じて、エンゲージメント、コンバージョン、ロイヤルティを強化します。 お客様は、システム全体でファーストパーティデータを接続し、強力なインサイトを表示し、予測クロスチャネルメッセージを自動化する使いやすいプラットフォームを気に入っています。

Dotdigital の 350 人以上の従業員は、世界中および様々な業界の中堅企業やエンタープライズ企業にサービスを提供しています。 私たちは、責任あるマーケティングを刺激することを目指し、持続可能性、プライバシー、セキュリティに取り組んでいます。 Dotdigital は、ISO 14001、ISO 27701、ISO 27001 の認証を取得した、世界初のカーボンニュートラルマーケティング自動化プラットフォームです。

購入およびダウンロード情報については、[Dotdigital - マーケティング自動化 ](https://commercemarketplace.adobe.com//dotdigital-dotdigital-magento2-os-package.html) を参照してください。

## コミュニティの投稿

Magento Open Sourceの皆さまには深く感謝申し上げるとともに、今回のリリースに対する皆さまのご尽力を心より感謝申し上げます。

コミュニティエンジニアリングチーム [Magentoのコントリビューター ](https://magento.biterg.io/app/kibana) は、月、四半期、年ごとに、貢献した上位の個人とパートナーのリストを管理します。 その投稿者ページから、GitHub の結合された PR へのリンクをフォローできます。

### パートナーの投稿

次の表に、パートナー様のコントリビューションを示します。 この表には、プルリクエストを行ったパートナー、外部プルリクエスト番号、関連付けられた GitHub 問題番号（使用可能な場合）が一覧表示されます。

{{$include /help/_includes/release-notes/engcomm-2-4-4-partner.md}}

### 個々のコントリビューターの投稿

次の表に、コミュニティメンバーからの投稿を示します。 この表は、プルリクエストを行ったコミュニティメンバー、外部プルリクエスト番号、関連付けられた GitHub 問題番号（使用可能な場合）の一覧です。

{{$include /help/_includes/release-notes/engcomm-2-4-4-issues.md}}

### 必要システム構成

当社の技術スタックは、PHP と MySQL をベースに構築されています。 詳しくは、[ システム要件 ](../../../installation/system-requirements.md) を参照してください。

### インストールとアップグレードの手順

[Composer](../../../installation/composer.md) を使用してMagento Open Source 2.4.4 をインストールできます。

## 移行ツールキット

データ移行ツールは、既存のMagento 1.x ストアデータをMagento 2.x に転送する際に役立ちます。このコマンドラインインターフェイスには、検証、進行状況のトラッキング、ログ記録、テストなどの機能が含まれています。 インストール手順については、[ データ移行ツールのインストール ](../../../tools/data-migration-tool/install.md) を参照してください。 [ データ移行リポジトリ ](https://github.com/magento/data-migration-tool) の調査または貢献を検討します。

[ コード移行ツールキット ](https://github.com/magento-commerce/code-migration) は、既存のMagento 1.x ストアの拡張機能とカスタマイズのMagento 2.x への転送に役立ちます。コマンドラインインターフェイスには、Magento 1.x のモジュールとレイアウトを変換するためのスクリプトが含まれています。

<!-- Last updated from includes: 2025-11-25 13:00:48 -->
