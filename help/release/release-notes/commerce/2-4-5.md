---
title: Adobe Commerce 2.4.5 リリースノート
description: 2.4.5 Adobe Commerce リリースの新機能、機能強化、バグ修正および既知の問題について説明します。
exl-id: fafcd266-fb69-450f-8c4f-047109ba8b50
source-git-commit: 92bc51c238343b82276af824e88feb972adaaabc
workflow-type: tm+mt
source-wordcount: '9381'
ht-degree: 0%

---

# Adobe Commerce 2.4.5 リリースノート

Adobe Commerceでは、プラットフォームの品質、支払い方法、GraphQLのキャッシュ機能、アクセシビリティを向上させました。 統合Google モジュールおよびアップグレード互換性ツールのアップデートが含まれており、Live Search B2B のサポートが導入されています。

このリリースには、400 を超える品質修正および機能強化が含まれています。

{{bics}}

## その他のリリース情報

これらの機能のコードは、Adobe Commerce コアコードの四半期リリースにバンドルされていますが、これらのプロジェクトの一部（B2B、Page Builder、Progressive Web Applications （PWA） Studio など）も個別にリリースされています。 これらのプロジェクトのバグ修正は、各プロジェクトのドキュメントで利用できる別のプロジェクト固有のリリース情報に記載されています。

### このリリースに含まれるホットフィックス

Adobe Commerce 2.4.5 には、Adobe Commerceに提供された次のホットフィックスで対処されたすべての問題の解決が含まれています。

* `Braintree_disabled_partial_capture_for_applepay_googlepay.zip`。 このパッチは、Braintreeを介してApple Pay またはGoogle Pay を支払い方法として使用する場合、部分的な請求書を作成できないように対処します。 ナレッジベースの記事「[Adobe Commerce 2.4.4：部分請求書を作成でき ](https://support.magento.com/hc/en-us/articles/4487952754957-Adobe-Commerce-2-4-4-Unable-to-create-partial-invoices) せん」を参照してください。

* `AC-2655_2.4.4.patch.zip`。 このパッチは、「国を許可」オプションが選択されていない場合、買い物客が買い物かごに製品を追加できないという問題を解決します。 ナレッジベースの記事 [ 国を許可で何も選択されていない場合、ユーザーが買い物かごに製品を追加できない ](https://support.magento.com/hc/en-us/articles/5377681213325-Users-not-able-to-add-product-to-cart-if-nothing-selected-in-Allow-Countries) を参照してください。

## Adobe Commerce 2.4.5 のハイライト

このリリースのハイライトは次のとおりです。

### セキュリティ機能の強化

このリリースには、20 のセキュリティ修正と platform セキュリティの改善が含まれています。 このセキュリティ修正は、Adobe Commerce 2.4.3-p3 およびAdobe Commerce 2.3.7-p4 に移植されました。

これらの問題に関連する確認された攻撃は、今日まで行われていません。 ただし、特定の脆弱性が悪用されて、顧客情報にアクセスしたり、管理者のセッションを引き継いだりする可能性があります。 これらの問題のほとんどは、攻撃者が最初に管理者へのアクセス権を取得する必要があります。 そのため、管理者を保護するために必要なすべての措置をとることをお勧めします。これには、以下の取り組みが含まれますが、これらに限定されません。

* IP許可リストに加える
* [ 二要素認証 ](https://developer.adobe.com/commerce/testing/functional-testing-framework/two-factor-authentication/)
* VPN の使用
* `/admin` ではなく一意の場所の使用
* 適切なパスワードハイジーン

修正された問題の最新の説明については、[Adobe セキュリティ速報 ](https://helpx.adobe.com/jp/security/products/magento/apsb22-38.html) を参照してください。

#### その他のセキュリティ機能強化

このリリースのセキュリティの強化により、次のような最新のセキュリティのベストプラクティスへのコンプライアンスが向上しています。

* ウィッシュリストの共有、「新しい顧客アカウントを作成」およびギフトカードのフォームに reCAPTCHA のサポートが追加されました。<!-- AC-1144-->

* ACL リソースがインベントリに追加されました。<!-- AC-1622-->

* 在庫テンプレートのセキュリティが強化されました。

* `MaliciousCode`フィルターがアップグレードされ、`HtmlPurifier` ライブラリを使用するようになりました。<!-- AC-1498-->

### Platform機能強化

* **Adobe Systems Commerce オンプレミス展開**: Adobe Systems Commerce 2.4.5 はテスト済みであり、Elasticsearch 7.17 (制約付き ~7.17.0) との互換性が確認されています。 オンプレミスAdobe Systems Commerce をホストするマーチャントは、Elasticsearch または OpenSearch 1.2 のいずれかを使用できます。 <!-- AC-2425-->

* **Adobe Systems Commerce クラウド でホストされる配置**: ElasticSearch 7.11 以降は、Adobe Systems Commerce 2.4.5 クラウド でホストされる展開ではサポートされていません。 OpenSearch は、Adobe Systems Commerce 2.4.5 クラウドデプロイメントのデフォルト検索エンジンです。

Adobe Commerce 2.4.5 では、をサポートするようになりました

* Composer 2.2 <!-- AC-2033-->

* TinyMCE （5.10.2）。 以前のバージョンの TinyMCE （v5.9.2 以前）では、特別に作成された URL や、特別に作成された URL を含む画像が更新された場合、任意のJavaScriptの実行が許可されていました。<!-- AC-2039 1784 1789-->

* jQueryUI （1.13.1） <!-- AC-2544-->

* `PHPStan` （^1.5.7 と制約） [GitHub-35315](https://github.com/magento/magento2/issues/35315)<!-- AC-2876-->

DHL 統合スキーマが v6.0 から v6.2 に更新されました。このアップグレードによって製品の動作が変わることはありません。 <!-- AC-3022-->

古いJavaScript ライブラリを最新バージョンに更新し、古い依存関係を削除しました。 これらの変更には後方互換性があります。<!-- AC-2036-->

#### Composer の依存関係の更新

<!-- AC-2876 2744 2912 2577-->

制約を使用して、次の Composer の依存関係を最新バージョンに更新しました。

* `colinmollenhour/credis` （1.13.0）?<!-- AC-2732-->
* `guzzlehttp/guzzle` （^7.4.2）
* `laminas/laminas-captcha` （制約^2.12 で更新） <!-- AC-2625-->
* `laminas/laminas-db`   （^2.15.0）
* `laminas/laminas-di` （^3.7.0）
* `laminas/laminas-escaper` （～2.10.0）
* `laminas/laminas-eventmanager` （^3.5.0）
* `laminas/laminas-feed`   （^2.17.0）
* `laminas/laminas-mail` （^2.16.0）
* `laminas/laminas-mvc` （^3.3.3）
* `laminas/laminas-server` （^2.11.1）
* `laminas/laminas-servicemanager` （^3.11.0）
* `laminas/laminas-validator` （^2.17.0）
* `league/fly` （2.4.3） <!-- AC-2744-->
* `monolog/monolog` （^2.5）
* `phpmd/phpmd`   （^2.12.0）
* `phpstan/phpstan` （^1.5.7）
* `phpunit/phpunit` （～9.5.20）
* `php-cs-fixer` （^3.4.0） <!-- AC-2259-->
* `webonyx/graphql-php` （14.11.6）

`laminas/laminas-session`、`laminas/laminas-text`、`laminas/laminas-view` の依存関係は削除されました。<!-- AC-2598-->

#### その他のアップグレードと交換

* DHL 統合スキーマが v6.0 から v6.2 に更新されました。<!-- AC-3022-->

* USPS 配送用のデフォルト ゲートウェイ URL が更新され、`http` の代わりに `https` を使用するようになりました。<!-- AC-2426-->

* `Froogaloop` ライブラリは Vimeo `Player.js` ライブラリ（2.16.4）に置き換えられました。<!-- AC-2527 2262-->

* `grunt-eslint` （NPM） ライブラリが最新バージョンにアップグレードされました。<!-- AC-2700-->

* `jQuery Storage` ライブラリは `julien-maurel/js-storage` に置き換えられました。<!-- AC-2627-->

* `php-cs-fixer` と `phpcs` の静的コード分析ツールは、PHP 8.x と互換性を持つようになりました。<!-- AC-2259-->

* `glob.js` 依存関係 (制約付きで ~7.2.0 にアップグレード) <!-- AC-2547-->

* `serve-static.js` 依存関係(制約 ~1.14.2 でアップグレード) <!-- AC-2548-->

* `underscore.js` 依存関係（NPM） （1.14.2） <!-- AC-2546 2549-->

* `moment-timezone-with-data.js` （0.5.34） <!-- AC-2545-->

* ライブラリ `jquery/jquery-cookie` は `js-cookie/js-cookie` に置き換えられました。<!-- AC-2626-->

* `jarallax.js` ライブラリと `jaralax-video.js` ライブラリを更新し、Vimeo REST API の最新バージョンを使用するようにしました。<!-- AC-2590-->

### パフォーマンスと拡張性の強化

#### 価格インデクサーの最適化

`catalog_product_index_price_tmp` テーブルのプライマリインデックスの数を 3 から 1 に減らすことにより、プライマリインデックスのパフォーマンスが向上しました。 この機能強化により、カタログの共有に起因する eSKU の乗算が減り、価格インデックスで作成されるレコード数が減少しました。 インデックス作成時間が大幅に短縮されました。<!-- MCP-653 MC-43342-->

### アクセシビリティの更新

このリリースでは、より知覚、操作、理解および堅牢な Venia （PWA）でのストアフロント体験の構築に重点を置いています。 以下のような機能強化が含まれています。

* 検索結果の概要情報が、スクリーンリーダーのユーザーに対して読み上げられるようになった
* スクリーンリーダーが、新しいページビューが読み込まれたときに通知されるようになりました
* コントラストとキーボードのアクセシビリティが向上しました

### Adobe Sign

マーチャントは、Adobe Commerceのチェックアウト時に、お客様が保証書、購入契約書、利用条件などのカスタマイズされた契約書に電子サインできるようになりました。

### Adobe CommerceとAdobe IMSの統合

Adobe IDを持ち、Adobe CommerceおよびAdobe Business Products への効率的なログインを必要とするAdobe Commerce マーチャントは、Commerce認証をAdobe IMS認証ワークフローと統合できます。 この統合がCommerce ストアに対して有効になると、各管理者ユーザーは、Commerce資格情報ではなく、Adobe資格情報を使用してログインする必要があります。  [Adobe Identity Management Service （IMS）統合の概要 ](https://experienceleague.adobe.com/docs/commerce-admin/start/admin/ims/adobe-ims-integration-overview.html?lang=ja) を参照してください。

### ブランディングとスタイルの変更

管理者は、Adobeのブランド戦略に合わせて更新されました。 変更は、ヘッダー、フッター、データグリッドの色の更新およびナビゲーション要素に影響を与えます。

### B2B

共有カタログ機能を実装するために必要な、正規化されたデータベースデータを最適化しました。 この eSKU の乗算の減少により、保存する必要のあるデータベース行が少なくなるので、パフォーマンスが向上します。 以前は、Adobe Commerceは、共有カタログごとにカタログ内のすべての SKU を複製していました。 Adobe Commerceでは、共有カタログに直接割り当てられたユーザー用に一意の eSKU を作成するようになりました。

新しい **有効な共有カタログの直接製品価格割り当て** 設定オプションを有効にすると、製品価格インデクサーのパフォーマンスも向上します。<!-- MCP-946-->

このリリースには、複数のバグ修正が含まれています。 [B2B リリースノート ](https://experienceleague.adobe.com/docs/commerce-admin/b2b/release-notes.html?lang=ja) を参照してください。

### Google Analytics

Googleは、GTag との統合を通じて、web アプリケーションにおける AdWords と Analytics のトラッキングおよび統合メカニズムを更新しました。 このGoogle機能の web サイトページへの統合により、Google サービスを通じてコンテンツをトラッキングおよび管理する機会が広がります。 Adobe Commerceには、以前の API を利用してGoogle サービスと統合するGoogle AdWords、Analytics、Optimizer、TagManager などの一連の組み込みモジュールがあります。  このリリースでは、GTag アプローチを使用してこの統合を再実装しました&#x200B; [analytics.js から gtag.js への移行（Universal Analytics） ](https://developers.google.com/analytics/devguides/migration/ua/analyticsjs-to-gtagjs) を参照してください。

### GraphQL

GraphQLのパフォーマンスの強化には、次のものが含まれます。

* 開発者と管理者は、デプロイメント時または実稼動環境で属性を変更する際に、統合ストアフロント GraphQL スキーマをより迅速に再構築できます。 また、何らかの理由でGraphQL スキーマを再構築する必要がある場合、買い物客のページ読み込み速度が大幅に向上します。

* GraphQL API の JSON web トークン（JWT）を使用して、認証トークンの有効期限の日時を使用できるようになりました。

* `bin/magento config:set graphql/session/disable 1` コマンドを使用すると、マーチャントは、すべてのGraphQL操作に対してセッション Cookie の作成を完全に無効にすることができます。 デフォルトでは、Adobe Commerceはこれらの Cookie を作成し、承認に依存するので、パフォーマンスに影響を与えます。 今後は、GraphQL リクエストの唯一の認証形式としてトークンを使用することをお勧めします。 セッション Cookie を単独で、または認証トークンと組み合わせて使用することはお勧めしません。 [GraphQL認証 ](https://developer.adobe.com/commerce/webapi/graphql/usage/authorization-tokens/) を参照してください。<!-- B2B-2204 -->

* 必要な場合にのみ、クラスプロキシを使用して、GraphQLの操作でセッション cookie が起動されるようになりました。<!-- B2B-2217 -->

* GraphQLの `http` ヘッダープロセッサー（ストア、お客様、通貨など）からセッションの使用状況が削除されました。<!-- B2B-2224 -->

これらの機能強化について詳しくは、[GraphQL開発者ガイド ](https://developer.adobe.com/commerce/webapi/graphql/) を参照してください。

### 在庫

在庫テンプレートのセキュリティが強化されました。

### Live Search

このリリースでは、B2B 顧客グループとカスタム価格のサポートが導入されています。 Live Search は、顧客グループへの製品の割り当てと、特定の顧客グループ/共有カタログに設定された価格に従うようになりました。

### ページビルダー

Page Builder v.1.7.2 は、Adobe Commerce 2.4.5 と互換性があります。

ページビルダーの列レイアウトには、次の機能強化が含まれています。<!-- PB-547-->

* 列が公開され、ユーザーがストアフロントで列設定を制御できるようになりました。

* 列のサイズ変更で、ユーザーアクションによってトリガーされるラッピングがサポートされるようになりました。

### 支払額

Apple Pay は、支払いサービスが有効になっているデプロイメントを実行しているすべてのマーチャントが利用できるようになりました。 この支払い方法では、買い物客がクレジットカードまたはデビットカードの詳細を入力する必要はありません。 Apple Pay は、商品の詳細ページ、ミニカート、買い物かご、チェックアウトワークフローで使用できます。 マーチャントはこの機能をオンに切り替えることができます。

#### PayPal

* スペインとイタリアのマーチャントは、買い物客に後で PayPal Pay を提供できるようになりました。 <!-- AC-2521-->

* PayPal、「クレジット」、「後で支払う」ボタンのプレビューが、管理者のチェックアウト、ミニ買い物かご、買い物かご、製品の各ページで使用できるようになりました。 プレビューでは、これらのボタンが有効になり、ストアフロントでレンダリングされた場合の外観が表示されます。

#### Braintree

* BraintreeはKOUNT詐欺防止の統合を中止しました。 Adobe Systems Commerce のコードベースから削除されました。

* **常に 3DS をリクエスト** オプションが管理者に追加されました。

### PWA Studio

PWA Studio v.12.5.x はAdobe Commerce 2.4.5 と互換性があります。

このリリースの新機能は次のとおりです。

* 買い物客の行動データは、web 分析サービス用にPWA Studio ストアフロントで収集されます。  マーチャントは、必要に応じてこれらのイベントをサブスクライブおよび拡張できるようになりました。

* 販売者は、管理者(Google タグマネージャー)からデプロイするサービスを選択できるようになりました。

機能強化とバグ修正の詳細については、「 [PWA Studio リリース](https://github.com/magento/pwa-studio/releases)」を参照してください。 PWA Studio バージョンと互換性のある Adobe Systems Commerce コアバージョンのリストについては、「 [バージョン の互換性](https://developer.adobe.com/commerce/pwa-studio/integrations/adobe-commerce/version-compatibility/) を参照してください。

### 互換性ツールアップグレード専用

以下の点が強化されました。

* シグネチャ検証メソッドメソッドまたはコンストラクターシグネチャ内の互換性のない変更を識別するようになりました。 <!-- AC-2632-->

* データベーススキーマ 検証 で、スキーマの変更と非互換性が識別されるようになりました。 <!-- AC-58-->

* DI 構成 検証 では、コア クラスとインターフェイスの `di.xml` とプリファレンスで、削除または非推奨の非 API コア クラスへの参照が検証されるようになりました。  <!-- AC-438-->

* UCT は、コードの非推奨を特定し、各問題を解決するための具体的な推奨事項を提供するようになりました。  <!-- AC-3147-->

## 固定の問題

Adobe Systems Commerce 2.4.5 コアコードの数百の問題を修正しました。

### インストール、アップグレード、デプロイメント

<!-- ACP2E-49-->

* データ パッチの名前を変更し、古いクラス名をエイリアスとして `patch_list` データベース テーブルに追加できるようになりました。 Adobe Systems Commerce は、パッチを適用する前に、データ パッチ エイリアスがデータベースに既に存在するかどうかを確認するようになりました。 以前は、Adobe Systems Commerce では、このような状況でエラーがスローされていました。

<!-- AC-3036-->

* Adobe Systems Commerce では、管理者URLを管理者からカスタムURLに変更しようとしたときに例外がスローされなくなりました。 以前は、管理者 URL を変更すると、ログインできませんでした。 [GitHub-35416](https://github.com/magento/magento2/issues/35416)

<!-- AC-1480-->

* マーチャントは、Klarna を使用したAdobe Commerce 2.4.2 のデプロイメントからAdobe Commerce 2.4.3 に正常にアップグレードできるようになりました。[GitHub-33760](https://github.com/magento/magento2/issues/33760)

<!-- AC-2905-->

* Adobe Commerce Analytics へのパスがハードコードされなくなりました。 以前は、このハードコードパスは、1 つのサーバーに複数のAdobe Commerce インスタンスがインストールされた場合に競合を引き起こしていました。 [GitHub-29373](https://github.com/magento/magento2/issues/29373)

### アクセシビリティ

<!-- AC-2786-->

* **ショッピングバッグ** ボタンに、その状態をプログラムまたはテキストで示すようになりました。 スクリーンリーダーを使用するユーザーには、このボタンをクリックすると他のコンテンツが展開されたり、関連するコンテンツが展開または折りたたまれたりすることが通知されます。 以前は、このボタンは、その状態をプログラムまたはテキストで示すものではありませんでした。

<!-- AC-2496-->

* お支払い情報クレジットカードのオプションのテキスト要素またはテキストの画像が、太字の場合、標準テキストの 18pt （24px）または 14pt （19px）に対して、WCAG 2.0 の必要な最小カラーコントラスト比 4.5:1 を満たすようになりました。 以前は、期待されるコントラスト比を満たしていませんでした。

<!-- AC-2483-->

* **アドレス帳**/**コミュニケーション**/**アカウント情報** カスタムフォーカスインジケーターで、背景色に対して少なくとも 3:1 のコントラスト比が提供されるようになりました。

<!-- AC-2486-->

* **フィルター** および **並べ替え** ボタンのテキストが、太字の場合、標準テキストの 18pt （24px）または 14pt （19px）に対して必要な 4.5:1 の最小カラーコントラスト比である WCAG 2.0 を満たすようになりました。 以前は、カルーセルのナビゲーションボタンは、これらの最低限のコントラスト要件を満たしていませんでした。

<!-- AC-2499-->

* スクリーンリーダーが、Venia のヘッダーとフッターに移動する際に、「Venia」という単語を 1 回だけ読み上げます。 以前は、同じ単語が 2 回連続して発表されました。

<!-- AC-2585-->

* トリガードロップダウンのボタンに、展開または折りたたまれたステートとアクセス可能な名前を示す情報がスクリーンリーダーに提供されるようになりました。

<!-- AC-2482-->

* スクリーンリーダーのユーザーは、新しいページビューがレンダリングされると通知されます。 以前は、ページのタイトルを変更した際に、タイトルの変更が読み上げられませんでした。

### Adobe Stock

<!-- AC-2926-->

* Adobe Stockから正常にログアウトできるようになりました。

### バンドル製品

<!-- ACP2E-465-->

* `PUT /V1/products` エンドポイントを使用して、特定の web サイトの製品価格属性を更新できるようになりました。 以前は、特定のストア表示で一部の製品属性が上書きされた場合、その同じストア表示でその製品の価格属性を更新することはできませんでした。

<!-- ACP2E-780-->

* Adobe Commerceは、製品のサブ選択ルールが適用される際に、バンドル製品の買い物かごの合計を正しく計算するようになりました。

### キャッシュ

<!-- ACP2E-684-->

* Adobe Commerceのキャッシュがフラッシュされ、`use_stale_cache` が有効になっている場合、フルページキャッシュが管理者に無効として表示されなくなりました。

<!-- AC-2410-->

* キャッシュがフラッシュされた際に、New Relic デプロイメントマーカーが期待どおりに動作するようになりました。 [GitHub-32649](https://github.com/magento/magento2/issues/32649)

### 買い物かごとチェックアウト

<!-- ACP2E-455-->

* チェックアウトワークフローの請求手順で、アドレス検索のポップアップが DOM エラーを引き起こさなくなりました。

<!-- ACP2E-368-->

* `addProductsToCart` のミューテーションが複数の製品で正しく機能するようになりました。 以前は、このクエリは、正確な小計を含む最初の製品を返しましたが、他の製品については小計 0 を返しました。

<!-- ACP2E-245-->

* SKU によって追加された制限付き製品に対する権限の例外が処理されるようになりました。 買い物客にストアフロントの適切なメッセージが表示され、エラーテーブルの「数量」フィールドが無効になりました。 以前は、Adobe Commerceが `There has been an error processing your request` のような例外をスローしていました。

<!-- ACP2E-148-->

* 買い物かごの価格ルールを無効にした後に影響を受ける見積もりを更新する SQL クエリが最適化され、見積もりテーブル全体がロックされなくなりました。

<!-- ACP2E-98-->

* グローバルアカウントを共有している買い物客は、ゲストのチェックアウトが無効な場合、マルチサイトデプロイメントのセカンダリ web サイトに再度ログインする必要がなくなりました。 顧客データは、買い物客がサブドメインに移動すると読み込まれるようになりました。 買い物客は再度ログインするように求められなくなり、以前の買い物かごの内容が表示されます。

<!-- ACP2E-94-->

* 複数住所のチェックアウトで単一数量の住所項目が削除された場合、チェックアウトワークフローの住所ドロップダウンの値が、見積もりの残りの項目で変更されなくなりました。 以前は、複数アドレスのチェックアウト中に商品が見積もりから削除されると、すべての商品の住所ドロップダウン値がデフォルトに変更されていました。

<!-- ACP2E-42-->

* 製品の在庫切れになっても、`cart` クエリが null 応答を返さなくなりました。 エラーメッセージを含む新しい `errors` 要素が応答に導入されました。 以前は、在庫切れの商品を含むクエリを実行すると、Adobe Commerceの応答の「`items`」セクションに `null` 値が表示されていました。 [ 買い物かごクエリ ](https://developer.adobe.com/commerce/webapi/graphql/schema/cart/queries/cart/) を参照してください。

<!-- ACP2E-38-->

* ゲストの買い物客がチェックアウトに進む前に買い物かごに製品を追加した後にアカウントを作成した場合、発送方法が期待どおりに使用できるようになりました。 以前は、ゲストがアカウントを作成する前に買い物かごに製品を追加した場合、チェックアウト中に発送方法は使用できませんでした。 他の商品を買い物かごに追加すると、配送方法が利用できるようになります。

<!-- AC-2564-->

* **国を許可** フィールドでオプションが選択されていない場合、買い物客が買い物かごに製品を追加できるようになりました。

<!-- AC-2622-->

* **永続化を有効にする** が「はい **に設定されている場合、セッションがタイムアウトした後、買い物かごの内容とログインステータスが期待どおりに再読み込みされるよう** なりました。 [GitHub-35182](https://github.com/magento/magento2/issues/35182)

<!-- AC-428-->

* 複数の配送先住所を持つ注文のチェックアウトワークフローで、買い物客が配送ページから買い物かごページに移動すると、ミニ買い物かごの小計が正しく更新されるようになりました。 以前は、小計は 2 倍でした。

<!-- AC-2619-->

* **永続化を有効にする** が有効になっている場合、セッションタイムアウト後に、以前に追加された製品がミニ買い物かごに表示されるようになりました。 [GitHub-35183](https://github.com/magento/magento2/issues/35183)

<!-- ACP2E-707-->

* マーチャントは、**払い戻し配送（含む。 税金）** は–0.01 に設定され、この金額を 0 に設定できるようになりました。 以前は、これらの条件ではクレジット メモを作成できませんでした。

### 買い物かご価格ルール

<!-- ACP2E-680-->

* `Parent Only` 属性スコープが、買い物かごルール条件で正しく使用されるようになりました。

### カタログ

<!-- ACP2E-758-->

* ストア表示で `PUT /V1/products/` を使用して製品名を更新する際に、製品の URL キーが変更されなくなりました。 以前は、新しい製品名に基づいて新しい URL キーが生成され、製品に割り当てられていましたが、これはストア表示の URL キーを上書きしていました。

<!-- ACP2E-712-->

* ルールベースのアップセル製品が製品ページに 2 回表示されなくなりました。

<!-- ACP2E-703-->

* ページビルダー製品ウィジェットをカルーセルモードに設定してからカテゴリに製品を追加しても、ページのリロードがトリガーされなくなりました。

<!-- ACP2E-685-->

* **個別に表示されない** に設定された製品は、カタログの詳細検索結果に表示されなくなります。

<!-- ACP2E-679-->

* 「一括属性の更新」ページで動的バンドル属性が正しく更新されるようになりました。 以前は、「**動的 SKU** 属性は、一括更新ページで無効になっていても **はい** に設定されたままでした。

<!-- ACP2E-673-->

* カタログルールが、完全な再インデックスではなく、増分インデクサーを使用して正しく適用されるようになりました。

<!-- ACP2E-657-->

* 複数ページの製品リストのリスト表示とグリッド表示を正常に切り替えられるようになりました。 以前は、複数ページの商品リスト表示の最後のページに移動してからグリッド表示に切り替えると、Adobe Commerceに次のエラーが表示されていました。`Unfortunately there are no products in this category on our website currently`

<!-- ACP2E-635-->

* 管理アクションログレポートに、更新された製品 ID と更新されたステータス情報が期待どおりに表示されるようになりました。

<!-- ACP2E-633-->

* 完全な再インデックス後、トリガーは `catalogrule_product_price` テーブルに期待どおりに復元されるようになりました。 以前は、`catalogrule_rule` ールまたは完全な再インデックスの後に、`catalogrule_product_price` テーブルからトリガー`catalogrule_product` 削除されていました。

<!-- ACP2E-629-->

* 製品をカテゴリに割り当てるために使用されるカテゴリルールがランダムに変更されなくなりました。

<!-- ACP2E-522-->

* カテゴリルールによって商品がカテゴリに割り当てられ、その後、マルチサイトデプロイメントで並べ替えられる場合に、Adobe Commerceがエラーをスローしなくなりました。

<!-- ACP2E-516-->

* スコープ制限アクセスを持つ管理者がカテゴリをグローバルに更新できなくなりました。 以前は、複数の web サイトで同じカテゴリで異なる製品を使用し、権限が 1 つのストアに制限されている管理者がカテゴリ内の製品を変更すると、他のストアでも製品の選択が変更されていました。

<!-- ACP2E-508-->

* 指定したロケールのデフォルト以外の通貨が使用された場合、製品の詳細ページに正しい価格が表示されるようになりました。 以前は、ストアフロントで数値が期待どおりにローカライズされていませんでした。

<!-- ACP2E-468-->

* スケジュールされた更新を使用して、製品を有効にできるようになりました。

<!-- ACP2E-392-->

* レコードが重複している製品の階層価格を取得しようとすると、API とストアフロントに同じエラーメッセージが表示されるようになりました。 以前は、`PUT /V1/products/tier-prices` が誤ったエラーメッセージを返していました。

<!-- ACP2E-345-->

* 末尾にハイフンを含む商品 URL キーを追加しようとすると、Adobe Commerceに検証エラーメッセージが表示されるようになりました。 情報を提供するツールヒントテキストも使用できます。

<!-- ACP2E-267-->

* 新しい `ConfigurableWishlistItem.configured_variant` フィールドは `ConfigurableWishlistItem.child_sku` フィールドを置き換えました。 設定されていない設定可能な製品が顧客のウィッシュリストに含まれている場合、後者のフィールドで内部エラーがトリガーされました。

<!-- ACP2E-84-->

* 製品の表示を変更するための属性の一括更新時に、選択したストアに対してのみ URL の書き換えが生成されるようになりました。 以前は、一括属性の更新により、間違ったストアに対して URL の書き換えが作成されていました。

<!-- ACP2E-39-->

* `Synchronize widget products with backend storage` 設定が有効な場合、Adobe Commerceは最近ビューされた商品データを `catalog_product_frontend_action` データベーステーブルに追加します。 レコードを追加する際の顧客 ID または訪問者 ID が含まれます。 顧客 ID と訪問者 ID が null の場合、応答の `recently_viewed_product` セクションが空になりました。 その結果、`customer/section/load` の Ajax リクエストが送信されると、Adobe Commerceでは、顧客 ID または訪問者 ID に基づいて、最近閲覧された商品を正しくフィルタリングできます。 以前は、空の顧客 ID または訪問者 ID のチェックがなかったので、応答には `catalog_product_frontend_action` データベーステーブルで使用可能なすべてのデータが含まれていました。

<!-- ACP2E-28-->

* ステージングが実装される際に、設定可能な製品の `Quantity` 属性を持つカテゴリルールが正しく機能するようになりました。 以前は、ステージングの更新により、製品の `catalog_product_entity` テーブルの `row_id` と `entity_id` の値が異なる場合、ビジュアルマーチャンダイザー **ルールで製品を一致** 機能で製品が正しくフィルタリングされていませんでした。

<!-- ACP2E-13-->

* 管理者は、管理スライドパネルから、買い物客の買い物かごの設定可能な製品オプションを変更できるようになりました。 以前は、スライドパネルは正しく機能しませんでした。

<!-- AC-1705-->

* 子製品への変更が保存される際に、設定可能な製品の親に対してページキャッシュが期待どおりにクリアされるようになりました。 以前は、キャッシュがクリアされていなかったので、ストアフロントの設定製品ページで変更が選択されていませんでした。 [GitHub-34508](https://github.com/magento/magento2/issues/34508)

<!-- AC-711-->

* 製品リストが管理で正しく表示されるようになりました。 以前は、商品リストが表示されず、Adobe Systems Commerce で次のエラーが表示されました。  `Item (Magento\Catalog\Model\Product\Interceptor) with the same ID "<ID>" already exists`。 [GitHub-33145](https://github.com/magento/magento2/issues/33145)

<!-- AC-1214-->

* カタログ価格範囲が **ウェブサイト** から **グローバル**&#x200B;に変更された後、複数ストア展開の商品詳細ページとストアフロント検索で商品価格が同じになりました。 以前は、カタログ検索結果ページには **global** 価格が表示され、製品詳細ページには **website** 価格が表示されていました。 [GitHub-34074](https://github.com/magento/magento2/issues/34074)

<!-- ACP2E-316-->

* 「価格ナビゲーションステップの計算 **が「手動** に設定されている場合に、レイヤナビゲーションで想定どおりに最も高い価格の商品が表示される **うになりました**。

<!-- ACP2E-711-->

* **カテゴリのページネーションを保存** が有効になっている場合に、カテゴリ内に表示されるページごとの製品制限を変更できるようになりました。 以前は、cookie の `form_key` と UI`form_key` 異なり、Adobe Commerceに「`Invalid Form Key. Please refresh the page`」というエラーが表示されていました。

<!-- ACP2E-807-->

* EAV インデクサーは、パフォーマンスの問題を防ぐために、製品 ID をタイプ `int` として処理するようになりました。

<!-- AC-2597-->

* 名前に「。」を含む新しい画像を追加した後、新しい製品キャッシュが正常に生成されるようになりました。  製品に移動したら、製品を保存し、画像キャッシュをクリーンアップします。 [GitHub-32699](https://github.com/magento/magento2/issues/32699)

<!-- AC-1205-->

* 管理者フィールドを入力せずに商品ページから属性を作成しようとすると、Adobe Commerceで期待どおりにエラーメッセージが表示されるようになりました。 [GitHub-33099](https://github.com/magento/magento2/issues/33099)

* ホームページに複数のカタログリストが含まれている場合、製品の評価がすべてのカタログ製品リストで正しくされるようになりました。 [GitHub-33867](https://github.com/magento/magento2/issues/33867)

### CMS コンテンツ

<!-- ACP2E-106-->

* マーチャントは、エンティティ編集ページからアクティブなスケジュール済み更新を編集できなくなりました。

<!-- ACP2E-65-->

* 権限が制限されている管理者は、スケジュールされた更新後に、CMS階層内のCMSページを表示できるようになりました。

### 設定可能な製品

<!-- ACP2E-687-->

* Adobe Commerceの製品詳細ページで、設定可能な製品の正しい製品価格を、選択したオプションで数量を変更した後で表示するようになりました。 以前は、数量が変更された後に価格が初期値にリセットされていました。

<!-- ACP2E-461-->

* `products` クエリは、**表示 Stock外** 構成設定を正確に反映するコンフィギュレーション可能製品の価格を取得するようになりました。以前は、クエリは正確な価格を返しませんでした。

<!-- ACP2E-412-->

* 設定可能なオプションが、`POST /V1/configurable-products/configurable1/child` を使用して管理で作成される設定可能な製品にリンクされるようになりました。

<!-- ACP2E-360-->

* 製品の編集中に複数選択の属性が正しく保存されるようになりました。 以前は、Adobe Commerceは、商品を保存する際に、選択されていない属性と選択された属性に対するデフォルトオプションを保存していました。

<!-- ACP2E-55-->

* Adobe Commerceは、パッチスクリプトを使用してグローバル `select` 属性を作成する際に、設定可能な属性を期待どおりに表示するようになりました。 以前は、適格なグローバル属性は非表示でした。

<!-- AC-2521-->

* `addConfigurableProductsToCart` ミューテーションを使用して、カスタムオプションを持つ設定可能な製品を追加できるようになりました。 以前は、Adobe Commerceは次のエラーをスローしていました：`Magento 2.3.4 graphql Notice: Undefined index: option_value in /var/www/html/mg234/vendor/magento/module-configurable-product-graph-ql/Model/Resolver/ConfigurableCartItemOptions.php on line 62`。 [GitHub-28860](https://github.com/magento/magento2/issues/28860)

<!-- ACP2E-43-->

* Adobe Systems Commerce は、スケジュールされた更新によってコンフィギュレーション可能製品の子製品の 1 つの可用性が変更されたときに、コンフィギュレーション可能製品の在庫ステータス、利用可能なコンフィギュレーション、および表示される価格を正しく表示するようになりました。 以前は、コンフィギュレーション可能製品に 2 つの子があり、1 つの子製品の可用性がスケジュールされた更新で無効にされている場合、更新がアクティブであったときに、親製品の在庫ステータスが **Stock 切れ** と誤って表示されていました。 更新が完了した後、表示される価格とそのコンフィギュレーションの可用性が誤って計算されていました。

* オプションのカスタムオプションを使用して選定可能製品を再注文できるようになりました。 以前は、並べ替えの試行が失敗し、平均して次のエラーが表示されていました:  `Some of the selected options are not currently available`。 [GitHub-35409](https://github.com/magento/magento2/issues/35409)

<!-- AC-959-->

* `addConfigurableProductsToCart`変異が複数の製品で期待どおりに機能するようになりました。以前は、正しくない製品情報が返されるか、無効エラーメッセージが返されていました。 [GitHub-30948](https://github.com/magento/magento2/issues/30948)

### 顧客

<!-- ACP2E-390-->

* Adobe Systems Commerce では、ストアフロントの Web サイト設定に従って、定義済みの EAV システム属性が正しく表示されるようになりました。 以前は、1 つの Web サイトで有効で別の Web サイトで無効になっている Web サイトレベルの顧客属性は、両方の Web サイトで有効として表示されていました。

### 顧客セグメント

<!-- ACP2E-473-->

* 顧客セグメント固有の関連製品ルールが期待どおりに機能するようになりました。 この問題は、特定のWebサイトの訪問者セグメント関係を追加するメソッドを呼び出すことで修正されました。 以前は、このルールのセグメントは、登録された顧客および web サイトに基づいてのみ取得されていました。

### ダウンロード

<!-- MC-40675-->

* ダウンロード可能な製品からサンプル リンクとファイルを削除できるようになりました。 [GitHub-31887](https://github.com/magento/magento2/issues/31887)

### 電子メール

<!-- ACP2E-717-->

* システム発行の E メールが、&quot;. –」というエラーメッセージが表示されます。

<!-- ACP2E-184-->

* 顧客は、放棄された買い物かごについて、正しいスケジュールに従ってリマインダーが送信されるようになりました。 新しい `TIMESTAMPDIFF(DAY, ,)` SQL 関数は、`TO_DAYS()` 関数を置き換え、日時に基づいてタイムスタンプの違いを計算します。 以前は、買い物かごの放棄（任意のタイムゾーン）とサーバー時間（UTC）の 2 つの日時値の計算が誤っているので、スケジュールごとにメールのリマインダーが送信されませんでした。

<!-- AC-776-->

* 買い物客が「注文する **をクリックした後に買い物客が無効なメールフォーマットを入力すると、Adobe Commerceで「送料」ページにエラーメッセージが表示される** うになりました。 以前は、エラーメッセージは支払いページに表示されていました。 [GitHub-33590] （https://github.com/magento/magento2/issues/33590

### フレームワーク

<!-- ACP2E-658-->

* `bin/magento setup:config:set` コマンドは、`app/etc/env.php` で既に設定されているキャッシュ ID プレフィックスを上書きしなくなりました。

<!-- ACP2E-517-->

* `bin/magento setup:static-content:deploy -s compact` コマンドに、子テーマのスタイルが期待どおりに含まれるようになりました。 以前は、デプロイメント後にテーマ CSS ファイルがストアフロントに存在しませんでした。

<!-- AC-1999-->

* `void` 要素で終了スラッシュが使用されているかどうかを確認するための新しいスニフが追加されました。

<!-- AC-2896-->

* 新しいソースを商品に割り当てて数量を変更した後、Adobe Commerceが SQL エラーをスローしなくなりました。 [GitHub-35262](https://github.com/magento/magento2/issues/35262)

<!-- AC-401-->

* 属性の並べ替え順が、更新後に `di.xml` ファイルで指定したとおりに機能するようになりました。

<!-- AC-1716-->

* `updateCartCurrency` 関数は、cart オブジェクト内のオブジェクトではなく、文字列を設定するようになりました。 以前は、Adobe Commerceは `getQuote` を使用して引用符を読み込んでいませんでした。これは、`updateCartCurrency` 関数が cart オブジェクト内の文字列ではなくオブジェクトをセットしたためです。 [GitHub-34199](https://github.com/magento/magento2/issues/34199)

<!-- AC-2428-->

* 単体テストで、`\DateTimeFormatter::formatObject()` が原因で非推奨（廃止予定）通知が発生しなくなりました。 このメソッドは、`$format` の数値で期待どおりに機能するようになりました。

<!-- AC-2893-->

* Adobe Commerceでは、管理者に `preg_replace()` エラーが表示されなくなりました。 3 番目の引数（`$subject`）の型は、`bool` ではなく `array|string` になりました。

<!-- AC-2583-->

* `isFreeShipping` メソッドは、ブール値ではなく整数を返すようになりました。[GitHub-35164](https://github.com/magento/magento2/issues/35164)

<!-- AC-2855-->

* クラス `vendor/magento/module-backend/Model/Menu.php` のいずれかのメソッドのプラグインを作成した場合、Adobe Commerceが次のエラーをスローしなくなりました：`Error: Call to undefined method ReflectionUnionType::getName()`。 [GitHub-35292](https://github.com/magento/magento2/issues/35292)

<!-- AC-1518-->

* ストアフロントで `/checkout/sidebar/updateItemQty/?item_qty=error` に移動すると、Adobe Commerceが 500 エラーではなく 404 エラーを返すようになりました。 以前は、このエラーがスローされていました：`Warning: A non-numeric value encountered in /vendor/magento/module-checkout/Controller/Sidebar/UpdateItemQty.php on line 69`。 [GitHub-34380](https://github.com/magento/magento2/issues/34380)

<!-- ACP2E-847-->

* SSL 設定なしで AMPQ 接続を設定した場合に、Adobe Commerceで `trim(): Passing null to parameter #1 ($string) of type string is deprecated` エラーがトリガーされなくなりました。

<!-- AC-2414-->

* `longblog` データベース定義を `long blob` に修正しました。 [GitHub-35108](https://github.com/magento/magento2/issues/35108)

<!-- AC-1526-->

* 一重引用符を含むノックアウトテキストが変換可能になりました。 [GitHub-34319](https://github.com/magento/magento2/issues/34319)

<!-- AC-2505-->

* `magento2/app/code/Magento/Security/Model/AdminSessionsManager.php` の `TypeError` が `int` から `string` に修正されました。  [GitHub-34415](https://github.com/magento/magento2/issues/34415)

<!-- AC-2511-->

* `nginx` 設定ファイル内の禁止された場所に `.htpasswd` が追加されました。 [GitHub-35150](https://github.com/magento/magento2/issues/35150)

<!-- AC-2013-->

* `Magento_Ui/js/core/app` as a `deps` を `app/code/Magento/Ui/view/frontend/requirejs-config.js` に追加することで、カテゴリ製品リストページの読み込み時間が改善されました。 [GitHub-34847](https://github.com/magento/magento2/issues/34847)

<!-- AC-2101-->

* `ProductRepository.php:get` メソッドは、キャッシュキーを 1 回返すようになりました。 以前は、2 回返されていました。 [GitHub-34958](https://github.com/magento/magento2/issues/34958)

<!-- AC-2507-->

* cron ジョブの例外ハンドラーで作成された新しい例外にエラーメッセージを追加しました。 [GitHub-34941](https://github.com/magento/magento2/issues/34941)

<!-- AC-2247-->

* `GraphQl-GroupedProductGraphQl` モジュールの ReadMe ファイルが更新されました。 [GitHub-34951](https://github.com/magento/magento2/issues/34951)

<!-- AC-2079-->

* ストアフロントの注文/請求書/クレジットメモの印刷ページで、web サイトでの表示用に指定されたロゴではなく、デフォルトの Luma ロゴが表示されなくなりました。 [GitHub-34942](https://github.com/magento/magento2/issues/34942)

### 一般的な修正点

<!-- AC-2883-->

* 最大セッションサイズを 0 （管理者 **ストア**/**設定**/**設定 – 詳細**）に設定しても、管理者はログアウトしません。 [GitHub-35312](https://github.com/magento/magento2/issues/35312)

<!-- ACP2E-675-->

* デフォルト以外の web サイトに割り当てられている管理者から新しい顧客アドレスを追加した際に、顧客が割り当てられている web サイトに基づいて、顧客アドレス属性の設定が正しく読み込まれるようになりました。

<!-- ACP2E-630-->

* カテゴリページと製品編集ページの両方で、制限付き管理者のカテゴリの作成がブロックされるようになりました。 以前は、カテゴリの作成はカテゴリページでブロックされていましたが、製品の編集ページでは引き続き可能でした。

<!-- ACP2E-448-->

* ページビルダーからバンドル商品を追加しても、Adobe Commerceが例外をスローしなくなりました。

<!-- ACP2E-427-->

* カテゴリツリーから顧客セグメントの条件としてカテゴリを選択できるようになりました。

<!-- ACP2E-381-->

* iOS デバイスで、名前（名、ミドルネーム、姓）にアポストロフィ（&#39;）が傾斜したカスタマーアカウントを作成できるようになりました。 以前は、直線形アポストロフィのみが許可されていて、iOS 11 以降のデフォルトの傾斜アポストロフィを使用すると、`Name is not valid!` エラーが発生していました。

<!-- ACP2E-378-->

* `products` クエリは、「関連製品を表示」設定を正確に反映する製品情報を返すようになりました。 GraphQL ProductInterface の `related_products`、`upsell_products`、`crosssell_products` の各フィールドは、それぞれ Show Related Products、Show Upsell Products および Show Cross-Sell Products 設定に従って解決されるようになりました。

<!-- ACP2E-234-->

* **製品を新規開始日として設定** 属性が、製品の一括更新を使用して **製品を新規設定** 属性を設定した場合に、正しい日付が表示されるようになりました。 以前は、**製品を新開始日に設定** が **1970 年 1 月 1 日** と表示されていました。

<!-- ACP2E-277-->

* 役割が制限されているユーザーには、新しいモジュールへのアクセス権が自動的に付与されなくなりました。

<!-- ACP2E-50-->

* カテゴリに基づくターゲットルールには、ルールで宣言されたカテゴリの製品のみが表示されます。 以前は、関連製品ルールには、製品に割り当てられているがルールで定義されていないカテゴリの製品が表示されていました。

<!-- ACP2E-16-->

* 関連する製品ルール条件が、`multiselect` 属性を含む製品で期待どおりに機能するようになりました。

<!-- AC-2719-->

* マーチャントは、階層価格属性（`tier_price`）を製品の比較に追加できるようになりました。 以前は、この属性の **ストアフロントで比較する** 設定が有効になっている場合、製品比較ページがクラッシュしていました。 [GitHub-35244](https://github.com/magento/magento2/issues/35244)

<!-- AC-2441-->

* 無効な cookie ドメイン（**Store**/**Configurations**/**Web**/**Default Cookie Settings Cookie Domain**）を設定すると、Adobe Commerceでエラーメッセージが表示されるようになりました。 以前は、web サイトがクラッシュしていました。 [GitHub-35048](https://github.com/magento/magento2/issues/35048)

<!-- AC-2765-->

* 1 つの web サイトを範囲とする役割を持つ管理者が PageBuilder を使用してコンテンツ要素に商品を追加した場合に、Adobe Commerceがエラーをスローしなくなりました。 以前は、Adobe Commerceが SQL エラーをスローしていました。

<!-- AC-197-->

* 住所の編集および追加ページの番地の 2 行目に検証が追加されました。 2 番目に指定したテキストの長さの最小値と最大値が適用されるようになりました。

<!-- ACP2E-798-->

* アップグレード後、Adobe Commerceが管理者でカタログルールを作成する際に、次のエラーがスローされなくなりました。`A technical problem with the server created an error. Try again to continue what you were doing. If the problem persists, try again later`

<!-- AC-2445-->

* **ウィッシュリストを共有** をクリックする前に「**ウィッシュリストに RSS フィードをリンクするには、ここをチェック**」チェックボックスをアクティブ化しても、Adobe Commerceがエラーをスローしなくなりました。 [GitHub-34998](https://github.com/magento/magento2/issues/34998)

<!-- AC-2019-->

* 「**パスワードを表示**」チェックボックス（顧客ログイン、顧客登録、顧客編集（パスワード変更セクション）、顧客設定新しいパスワードの各フォーム）のタイトルが翻訳可能になりました。 [GitHub-34857](https://github.com/magento/magento2/issues/34857)

<!-- ENGCOM-9062-->

* `app/code/Magento/NewRelicReporting/etc/adminhtml/system.xml` のラベルとコメントの説明を更新しました。 [GitHub-31947](https://github.com/magento/magento2/issues/31947)

<!-- ENGCOM-8600-->

* 不要な `csp_whitelist.xml` ファイルを削除しました。 [GitHub-30607](https://github.com/magento/magento2/issues/30607)

### ギフトカード

<!-- AC-560-->

* `products` クエリでは、 `gift-card` URL キーを持つギフトカード商品を含む商品データが正しく返されるようになりました。

### GraphQL

<!-- AC-2361-->

* 不足している `price_range` 属性が GraphQL `BundleItemOption` タイプに追加されました。 [GitHub-35010](https://github.com/magento/magento2/issues/35010)

<!-- AC-2367-->

* `products` クエリは、&lbrack;**Search結果での使用** レイヤード ナビゲーション 設定が無効になっている場合、属性を集計として返さなくなりました。[GitHub-33318](https://github.com/magento/magento2/issues/33318)

<!-- AC-1760-->

* `price_including_tax`フィールドが`CartItemPrices`に追加されました。[GitHub-29057](https://github.com/magento/magento2/issues/29057)

<!-- AC-2520-->

* `ProductInterface` の `new_from_data` および `new_to_datefields` は廃止されなくなりました。[GitHub-34783](https://github.com/magento/magento2/issues/34783)

<!-- AC-2364 1456-->

* ファイルシステムに見つからない画像を含むカテゴリのリストを取得する場合、`categories` クエリで例外がスローされなくなりました。 以前は、Adobe Commerceは次の例外をスローしていました：`Category image not found`。 [GitHub-34266](https://github.com/magento/magento2/issues/34266)

<!-- AC-2368-->

* `products` クエリは、期待どおりに集計として `category_uid` を返すようになりました。 [GitHub-32557](https://github.com/magento/magento2/issues/32557)

<!-- AC-2373-->

* `updateCartItems` のミューテーションは、商品の在庫が最大在庫量に達した場合、期待どおりに商品を削除するようになりました。 [GitHub-30220](https://github.com/magento/magento2/issues/30220)

<!-- AC-2366 734 MC-42964 -->

* `urlResolver`クエリでは、複数のホームページが同じ識別子を持つ場合に、パス区切り文字(/)が正しく解決されるようになりました。以前は、クエリで区切り文字が解決されず、null が返されていました。 [GitHub-33615](https://github.com/magento/magento2/issues/33615)

<!-- AC-1881-->

* `customer` クエリで、注文をクエリする際に、バンドル製品の複数選択オプションが期待どおりに取得されるようになりました。 [GitHub-34717](https://github.com/magento/magento2/issues/34717)

<!-- AC-1668-->

* GraphQL リクエストが行われた後にAdobe Commerce セッションが終了しなくなりました。 以前は、`ClearCustomerSessionAfterRequest` プラグインは買い物客からログアウトしていました。 [GitHub-34550](https://github.com/magento/magento2/issues/34550)

<!-- AC-818-->

* `products` クエリは、無効なバリアントの影響を受ける設定可能な製品の `price_range` 値を返さなくなりました。 [GitHub-33629](https://github.com/magento/magento2/issues/33629)

<!-- ACP2E-634-->

* 「**在庫切れ `products` 製品を表示**」設定が有効になっている場合、クエリ応答の設定可能な製品価格範囲が正しく計算されるようになりました。 以前は、無効なオプションは最小および最大価格の計算で考慮されていました。

<!-- ACP2E-531-->

* 位置で並べ替える場合、`products` クエリは、正しくフィルタリングされた複数のカテゴリを返すようになりました。

<!-- ACP2E-499-->

* `setShippingAddressesOnCart` リクエストで、地域 ID が正常に検証されるようになりました。 以前は、リージョンコードの代わりにリージョン ID を使用した場合、Adobe Commerceがエラーをスローしていました。

<!-- ACP2E-470-->

* クエリ `products`、リクエストで渡されたストアに関連付けられたカテゴリのみを返すようになりました。

<!-- ACP2E-363-->

* `categoryList` クエリは、ヘッダーでストアが指定されている場合、クエリされたストアのルートカテゴリを反映した結果を返すようになりました。 以前は、ヘッダーで別のストアが指定されている場合でも、デフォルトのルートカテゴリのカテゴリが結果に含まれていました。

<!-- AC-1955-->

* **検索結果のレイヤー化されたナビゲーションで使用** 設定が無効になっている場合、`products` クエリは属性を集計として返さなくなりました。 [GitHub-33318](https://github.com/magento/magento2/issues/33318)

<!-- AC-2365-->

* `cart` クエリは、無料注文に対して 1 つの支払い方法のみを返すようになりました。 以前は、すべてのアクティブな支払い方法がクエリ応答で返されていました。 [GitHub-34036](https://github.com/magento/magento2/issues/34036)

<!-- AC-210-->

* `collectQuoteTotals` 呼び出しの前にプラグインを追加して、ストアクレジットが複数回適用されないようにしました。

<!-- ACP2E-636-->

* `generateCustomerTokenAsAdmin` のミューテーションで、顧客トークンが期待どおりに取得されるようになりました。 以前は、トークンが返されず、このエラーが返されていました: `Customer email provided does not exist`。

<!-- AC-2371-->

* カスタムの `type` product 属性が定義されている場合、GraphQL スキーマが有効になりました。 以前は、製品タイプの `type` 属性がカスタム `type` 属性で上書きされたため、スキーマは無効でした。 [GitHub-34929](https://github.com/magento/magento2/issues/34929)

<!-- AC-2797-->

* `createCustomer`、`createCustomerV2`、`updateCustomer` または `updateCustomerV2` のミューテーションで追加または更新された顧客は、アクティブなニュースレター購読で追加されるようになりました。 以前は、リクエストに適切な入力パラメーターが含まれている場合でも、お客様はニュースレターの購読を解除されていました。 [GitHub-33599](https://github.com/magento/magento2/issues/33599)

<!-- AC-1883-->

* 特定のストア表示の `products` クエリで、マルチサイトデプロイメントの特定の web サイトのルートカテゴリにあるカテゴリのみを返すようになりました。 以前は、クエリは、他の web サイトのルートカテゴリからカテゴリを返していました。 [GitHub-34570](https://github.com/magento/magento2/issues/34570)

<!-- AC-2712-->

* `products` クエリは、指定されたカテゴリ ID のサブカテゴリのみを返すようになりました。 以前は、すべてのカテゴリが返されていました。 [GitHub-35220](https://github.com/magento/magento2/issues/35220)

<!-- AC-2794-->

* `customerOrders` クエリは、応答で `gift_message` オブジェクトが指定されているが、ギフト メッセージが存在しない場合に、期待どおりに応答するようになりました。以前は、クエリから `Can't load gift message for order is returned` というメッセージが返されていました。 [GitHub-28957](https://github.com/magento/magento2/issues/28957)

<!-- AC-2515-->

* `products` クエリが別のストアからカテゴリを返す原因となった `catalog_category_product` インデクサーのバグ固定。[GitHub-31253](https://github.com/magento/magento2/issues/31253)

<!-- AC-2063-->

* `generateCustomerToken` のミューテーションは、顧客トークンを生成した後、期待どおりに `customer_log` にエントリを作成するようになりました。 [GitHub-33378](https://github.com/magento/magento2/issues/33378)

### Google Analytics

<!-- AC-2574 2685-->

* Google タグモジュールがコードベースに追加され、2023 年 7 月のGoogle Analytics 4 への移行をサポートします。  現在、Google Universal Analytics のプロパティで新しいデータを使用および収集できますが、Google Universal は 2023 年 7 月に提供終了になる予定です。 [GitHub-35204](https://github.com/magento/magento2/issues/35204), [GitHub-35376](https://github.com/magento/magento2/issues/35376)

### 画像

<!-- ACP2E-71-->

* 製品の詳細ページの画像がちらつくことがなくなり、画像が期待どおりに中央に配置されたままになります。 以前は、製品の詳細ページ画像の読み込みが完了すると、画像が目に見えて下向きにシフトしていました。

### インポート/エクスポート

<!-- ACP2E-676-->

* CSV の書き出し内の関連、アップセル、クロスセル製品の位置が、CSV ファイルを再生成する前に管理者からクロスセル製品を削除した後、正しくなりました。 以前は、クロスセル製品が削除された後にクロスセル製品の位置が再計算されず、製品の位置の順序が正しくありませんでした。

<!-- ACP2E-632-->

* Adobe Commerceは、レポートを書き出す際に、列をフィルタリングする前にカスタムビューを確認するようになりました。 以前は、書き出されたレポートでカスタムビューが考慮されず、書き出された列が正しくありませんでした。

<!-- ACP2E-502-->

* Adobe Commerceは、長いファイル名を持つ画像を正常に読み込むようになりました。 以前は、Adobe Commerceは画像を読み込まないので、次のエラーがスローされていました：`Imported resource (image) could not be downloaded from external resource due to timeout or access permissions in row(s):`。

<!-- ACP2E-294-->

* カテゴリ ID 属性が、スケジュールされた書き出しフィルターで使用できるようになりました。

<!-- ACP2E-59-->

* 疑問符（?）を含むバンドル製品 メソッド内のクエリビルダーが改善され、オプションののタイトルが正常に読み込まれるよう `populateExistingOptions` なりました。 オプションのタイトルも正しく表示されます。 以前は、最初の読み込みの後、読み込みを繰り返すと動作が破損し、オプションが 2 倍になっていました。 買い物客も商品を買い物かごに追加できませんでした。

<!-- ACP2E-766-->

* 読み込み時のカテゴリ名の検証を追加しました。 以前は、Adobe Commerceでカテゴリ名が検証されなかったので、カテゴリ名が 255 文字を超えるとエラーが発生していました。

<!-- AC-2096-->

* `catalog_url_rewrite_product_category` テーブル内の既存のレコードが、新しいレコードを挿入する前に削除されるようになりました。 以前は、マルチストア製品の読み込み中に、次のエラーが発生していました。`SQLSTATE[23000]: Integrity constraint violation` [GitHub-34210](https://github.com/magento/magento2/issues/34210)

### インフラストラクチャ

<!-- ACP2E-2039-->

* 非推奨（廃止予定）のコンテキストメニュープラグインがプラグインリストから削除されました。

<!-- ACP2E-2039-->

* ページビルダーモジュールの TinyMCE エディターツールバー関連のロジックが、TinyMCE にツールバーのロジック `delayedRender` 導入された結果、更新されました。

<!-- MC-42655-->

* 競合状態によって、`contentUpdated` イベントリスナーの作成が中断されることはなくなりました。 [GitHub-32068](https://github.com/magento/magento2/issues/32068)

<!-- AC-3044-->

* `getTypeID` 関数は、製品 ID ではなく、製品タイプ ID を返すようになりました。 [GitHub-35458](https://github.com/magento/magento2/issues/35458)

<!-- AC-2911-->

* jQuery UI のスライダーと `SelectMenu` マッピングが `vendor/magento/module-theme/view/base/requirejs-config.js` で修正されました。

* `sales_order_state_change_before` に配置されたオブザーバーは、注文オブジェクトからのデータの取得をサポートするようになりました。 `sales_order_state_change_before` `event` 引数が更新されました。 [GitHub-26789](https://github.com/magento/magento2/issues/26789)

<!-- AC-2239-->

* `indexer:reset` は、`$indexer->invalidate()` を呼び出すためにリファクタリングされました。 [GitHub-34988](https://github.com/magento/magento2/issues/34988)

<!-- AC-2055-->

* `htmlClass` 属性値でコロン記号を使用できるようになりました。これにより、Tailwind UI などの追加コンポーネントの使用がサポートされます。 [GitHub-34430](https://github.com/magento/magento2/issues/34430)

### 伐採

<!-- ACP2E-203-->

* 顧客、顧客住所、および注文アクションが管理者アクションレポートに正しく記録されるようになりました。 以前は、Adobe Systems Commerce は、 `postDispatch` ハンドラーが構成設定で指定されていない場合、アクションをログに記録しませんでした。

### MFTF

#### アクショングループ

次のテストでは、反復アクションがアクション グループに置き換えられました。

`AdminConfigurableProductChildrenOutOfStockTest` [GitHub-32378](https://github.com/magento/magento2/issues/32378)
`AdminCreateStoreViewTest` [GitHub-34631](https://github.com/magento/magento2/issues/34631)

#### 新しいテスト

`AdminUnlockAdminUserEntityTest`[GitHub-34836](https://github.com/magento/magento2/issues/34836)

`StorefrontNewsletterSubscriptionWithEnabledNeedToConfirmConfigTest`[GitHub-33344](https://github.com/magento/magento2/issues/33344)

#### リファクタリングされたテスト

`AdminCancelTheCreatedOrderWithCashOnDeliveryPaymentMethodTest`[GitHub-33692](https://github.com/magento/magento2/issues/33692)

### ニュースレター

<!-- ACP2E-35-->

* ログインした顧客は、管理者/**マーケティング**/**ニュースレターの購読者** でゲストとしてマークされなくなりました。

<!-- AC-2102-->

* 顧客がデフォルト以外のストアに割り当てられ、管理者が購読または購読解除すると、ニュースレターの購読確認メールの **送信者** フィールドに、ストア固有の正しいメールアドレスが表示されるようになりました。 以前は、顧客は、デフォルトのメールが記載されたメールを **From** ヘッダーで受け取っていました。 [GitHub-34963](https://github.com/magento/magento2/issues/34963)

<!-- AC-2509-->

* ニュースレターのメールテンプレートの購読解除 URL が期待どおりに動作するようになりました。 [GitHub-33310](https://github.com/magento/magento2/issues/33310)

### 順序

<!-- ACP2E-550-->

* ストアフロントで非表示になっているカスタム顧客属性を使用して、新しい注文から新しい顧客を正常に作成できるようになりました。 以前は、Adobe Commerceは、カスタム顧客属性の正しい値を保存していませんでした。

<!-- ACP2E-279-->

* 注文の編集後、ゲストの顧客の詳細が正常に保存されるようになりました。 以前は、`customer_firstname` や `customer_lastname, x_forwarded_for` など、お客様の詳細情報の一部が失われていました。

<!-- ACP2E-92-->

* マーチャントは、製品またはグローバル設定レベルで **小数数量** が無効になっている場合、小数合計数量のクレジットメモを作成できなくなりました。 以前は、マーチャントは、該当しない場合、小数点以下の合計数量のクレジットメモを作成できました。

<!-- ACP2E-56-->

* 環境設定で設定されたタイムゾーンがローカルコンピューターで設定されたタイムゾーンと異なる場合、日付によるフィルターが、請求書、出荷、クレジットメモ、CMSページおよびCMS ブロックグリッドで正しく機能するようになりました。 以前は、日付が誤って解析され、フィルター結果に、設定された日付範囲外のデータが含まれていました。

<!-- AC-1536-->

* 管理者アカウントの編集ページで顧客に割り当てられたメインのメールアドレスを変更しても、Adobe Commerceで注文に割り当てられたカスタムのメールアドレスが変更されなくなりました。 以前は、顧客のメインメールアドレスを編集すると、その顧客用に作成されたすべての注文に新しいメールアドレスが割り当てられました。 [GitHub-34397](https://github.com/magento/magento2/issues/34397)

<!-- AC-2664-->

* Adobe Commerceは、PHP 7.4 を実行している環境で、要求されたストアのレコードをクレジットメモグリッドページに表示するようになりました。以前は、Adobe Commerceがクレジットメモを作成して表示しようとすると、次のエラーが発生していました：`The store that was requested wasn't found. Verify the store and try again`。

<!-- AC-2442-->

* Adobe Commerceでは、名前の先頭に数字が付いたストアビューから作成された注文のクレジットメモグリッドページに、クレジットメモが表示されるようになりました。 以前は、Adobe Commerceには「`The store that was requested wasn't found. Verify the store and try again. Exception in /var/www/html/vendor/magento/module-store/Model/StoreRepository.php:75`」というエラーが表示されていました。 [GitHub-35122](https://github.com/magento/magento2/issues/35122)

<!-- ACP2E-31-->

* Adobe Commerceでは、管理およびストアフロントの請求書ページの合計に送料無料コスト（0）が表示されるようになりました。 以前は、注文の配送がゼロの場合、Adobe Commerceでは請求書ページの配送合計に配送額の合計が表示されていませんでした。

<!-- ACP2E-740-->

* カスタマーストアクレジットが使用されている場合、チェックアウト時にAdobe Commerceに正しい注文ステータスが表示されるようになりました。

<!-- AC-1778-->

* `sales_order` テーブルの `increment_id` 列が増えました。 以前は、`sales_order.increment_id` が 50 文字の長さを持つと想定したサードパーティモジュールで、`increment_id` の最初の 32 文字のみが保存されていました。 [GitHub-34521](https://github.com/magento/magento2/issues/34521)

### 支払い方法

<!-- ACP2E-25-->

* 管理者は、PayPal PayflowPro 支払い方法を使用して管理者に注文できるようになりました。 以前は、Adobe Commerceには「`No such entity with cartId = 0`」というエラーが表示されていました。

<!-- AC-2093-->

* チェックアウトワークフローの支払レビューページに、Venmo、PayPal Later または PayPal で支払いを行う際に、正しい支払い方法名が表示されるようになりました。

<!-- AC-1195-->

* `cart` クエリでは、無料注文に対するすべてのアクティブな支払い方法を返さなくなりました。 [GitHub-34036](https://github.com/magento/magento2/issues/34036)

#### Braintree

<!-- BUNDLE-3088-->

* マーチャントは、Braintreeを通じてApple Pay で支払われた注文に対して、部分的な返金を申請できるようになりました。 これは、Adobe Commerce 2.4.4 の既知の問題でした。

#### PayPal

<!-- ACP2E-296-->

* Adobe Commerceは、PayPal で支払われたゲスト注文に正しいお客様の名前を表示するようになりました。 以前は、顧客名は Guest と表示されていました。

<!-- AC-2606-->

* createPaypalExpressToken ミューテーションのリゾルバーが更新されて、use_paypal_credit 入力フィールドで指定された値が正しく使用されるようになりました。 以前は、無効な `paypal_credit` フィールドを使用しようとしました。 [GitHub-35180](https://github.com/magento/magento2/issues/35180)

### パフォーマンス

<!-- ACP2E-474-->

* 動的ブロックの読み込みのパフォーマンスが向上しました。 以前は、訪問者セグメントは web サイトごとにキャッシュされなかったので、同じデータに対してデータベースへの冗長なクエリが発生していました。

<!-- ACP2E-52-->

* Redis キャッシュ管理は、設定可能な製品の関連する製品データキャッシュに TTL （有効期限）を追加することで改善されました。 以前は、Redis キー削除ポリシーが揮発性削除ポリシーに設定されている場合、TTL 値が欠落しているので、これらのキャッシュは削除されませんでした。

<!-- ACP2E-464-->

* 新しい `Grid Filter Condition Type` customer/customer address 属性は、データベース内の属性値に対して属性フィルタを照合する方法を制御します。オプションには、`Partial Match`、`Prefix Match`、`Full Match` があります。

<!-- AC-1136-->

* カタログ検索フルテキスト インデクサーがストアループの外部に再配置され、インデックス再作成が効率化されました。 [GitHub-33984](https://github.com/magento/magento2/issues/33984)

<!-- AC-2508-->

* `array_merge` in ループの問題を修正しました。 [GitHub-33929](https://github.com/magento/magento2/issues/33929)

### Pricing

<!-- ACP2E-445-->

* デフォルトのスコープに値を持たない（ただし、ストアビューレベルで定義される）価格属性に対して、適切なインデックスが作成されるようになりました。 以前は、EAV テーブルから価格属性の値を取得する SQL 式では、デフォルトのスコープで値が定義されていないシナリオは考慮されていませんでした。

<!-- ACP2E-313-->

* 製品の詳細ページに表示される価格は、選択した数量によって異なる階層価格のチェックアウトワークフローに表示される価格と同じになりました（例えば、2 品目と 5 品目の購入に基づいて価格が異なる製品など）。 以前は、チェックアウト価格には最低製品数量の価格が反映されていました。

### プロモーション

<!-- ACP2E-690-->

* 割引の **使用回数** 値は、ゲスト顧客が割引で注文してからアカウントを登録する際に 2 回増分されなくなりました。

### ReCAPTCHA

* ログイン ページとアカウントを作成ページの **送信** ボタンは、ReCaptcha が完全に読み込まれるまで非アクティブになりました。

### 返品承認（RMA）

<!-- MC-40432-->

* `rma_item` エンティティのデフォルト属性セット ID がデフォルトのインストール ID と異なる場合、`GET /V1/returnsAttributeMetadata` エンドポイントは正しく機能するようになりました。 以前は、これらの ID が異なる場合、このエンドポイントは空の結果を返していました。

<!-- ACP2E-247-->

* 製品の編集ページで RMA を有効にするために使用される **デフォルトを使用** チェックボックスが、デフォルトストアで期待どおりに動作するようになりました。 以前は、製品を保存した直後にチェックボックスがオフになっていました。

### 報酬

<!-- ACP2E-433-->

* ストアクレジット機能が無効になっている場合に、報酬ポイントを返金できるようになりました。

<!-- ACP2E-757-->

* 報酬ポイントが適用される際のチェックアウトパフォーマンスが向上しました。 `entity` が null の場合、データベース・クエリは実行されません。これは、状況では `magento_reward_history` テーブルのクエリは必須ではないためです。

<!-- ACP2E-674-->

* ゲスト注文のクレジットメモで `customer_id` の確認ができなくなり、リワードポイントの `magento_reward_history` ータベーステーブルのクエリがスキップされるようになりました。 この変更により、パフォーマンスが向上しました。

### 役割

* **ストア**/**設定**/**サービス** ページの「役割のリソース」タブで「リソースアクセス」が **カスタム** に設定されている場合、Adobe Commerce Web API 情報が期待どおりに表示されるようになりました。 [GitHub-35506](https://github.com/magento/magento2/issues/35506)

### 検索 {#search-heading}

<!-- ACP2E-645-->

* レイヤーナビゲーションのカラースウォッチで商品をフィルタリングすると、修正後の商品の正しい画像が表示されます。

<!-- ACP2E-615-->

* 検索可能なバックエンド `type` 属性として設定されている場合、Elasticsearchのクエリ `int` 期待どおりに動作するようになりました。 以前は、Adobe Commerceは `Elasticsearch\Common\Exceptions\BadRequest400Exception` 例外をスローしていました。

<!-- ACP2E-99-->

* Elasticsearch クエリで、検索同義語を **一致する最小用語** パラメーターと共に使用できるようになりました。 以前は、このパラメーターが設定で指定され、特定のキーワードに検索用語が追加された場合、検索結果は返されませんでした。

<!-- ACP2E-72-->

* Adobe Systems Commerce では、Search 提案 と **表示 結果 カウント 各提案の設定が有効になっている展開のストアフロントに、正確な検索結果の提案数が表示されるようになりました** 。 以前は、キーワードの横に表示されるカウントは 0 でした。

<!-- AC-700-->

* カタログページでカスタム属性別にソートされた製品、想定された順序で表示されるようになりました。 以前は、製品は属性オプション値 ID で並べ替えられていましたが、これは属性に追加された順序を反映していました。 [GitHub-33810](https://github.com/magento/magento2/issues/33810)

<!-- AC-645-->

* レイヤーナビゲーションのカラースウォッチによる商品のフィルタリングで、正しい商品画像が表示されるようになりました。 以前は、レイヤー化されたナビゲーション `PageCache` キーには、設定可能な製品のフィルターパラメーターが含まれていませんでした。

<!-- AC-2051-->

* `catalogsearch/advanced/result` での PHP エラーを修正しました。  `catalogsearch/advanced/index` ページ。  以前は、任意の詳細検索文字列 `Warning: trim() expects parameter 1 to be string, array given | magento/module-catalog-search` で配列が渡された場合、Adobe Commerceにこのエラーが表示されていました。 [GitHub-33586](https://github.com/magento/magento2/issues/33586)

### 出荷

<!-- AC-2052-->

* Adobe Systems Commerce では、許可された配送方法が選択されていない場合に、UPS 配送料のロード時にエラーがスローされなくなりました。 以前は、買い物客がこれらの条件下でチェックアウトワークフローに配送先住所を入力すると、他の配送方法は表示されず、Adobe Systems Commerce はストアフロントにエラーを表示していました。 [GitHub-34411](https://github.com/magento/magento2/issues/34411)

<!-- AC-2621-->

* 仮想製品価格は、計算テーブルのレート配送額から除外されるようになりました。 以前は、これらの製品の送料が正しく計算されていませんでした。[GitHub-35185](https://github.com/magento/magento2/issues/35185)

<!-- ACP2E-209-->

* 割引券が適用された注文に対して、料金が 0 の表レート配送料が、チェックアウトワークフローの「注文概要」ブロックに正しく表示されるようになりました。 以前は、発送方法は表示されていませんでした。

### ステージング

<!-- ACP2E-404-->

* Adobe Commerceでは、キャッシュされたページが変更されていないセールスルールに対してステージング更新を適用した後、フルページキャッシュをクリーンアップしなくなりました。

<!-- ACP2E-304-->

* 内容ステージングダッシュボードには、非アクティブな永続的な更新が表示されなくなりました。

<!-- ACP2E-257-->

* ステージング ダッシュボードからステージング更新の終了日を変更すると、これらの変更がステージング更新とそのエンティティに正常に適用されるようになりました。 (ステージング更新の変更を処理するためのキューが導入されました)。

<!-- ACP2E-238-->

* マーチャントは、スケジュールされた更新の終了日を削除したり、更新を削除して再作成したりできるようになりました。 以前は、終了日が削除されても、その時点でエンティティのスケジュールが維持されていました。 Adobe Commerceで、削除されたロールバックの古い更新が削除されるようになりました。

<!-- ACP2E-149-->

* CMSページのアクティブなスケジュールの更新が、CMS ページの「スケジュールされた変更」セクションで期待どおりに表示されるようになりました。

<!-- ACP2E-81-->

* スケジュールされた更新が変更された場合、`custom_design_to` 属性値が期待どおりに更新されるようになりました。 以前は、終了時間のない 2 つの異なるカテゴリデザインの更新は、1 つとして扱われていました。 最初の更新の実行中にスケジュールされた更新の 1 つが削除されると、`custom_design_from` の時間の値が次にスケジュールされた更新の `custom_design_to` の時間の値よりも大きくなりました。

<!-- ACP2E-58-->

* スケジュールされた更新を編集した後、Formsに期待どおりにデータが入力されるようになりました。

<!-- ACP2E-18-->

* データベースにカスタムオプションを含む製品が含まれ、`special_from_date` 属性が設定されている場合、`vendor/magento/module-catalog-staging/Setup/Patch/Data/MigrateCatalogProducts.php` データパッチが失敗しなくなりました。

<!-- ACP2E-741-->

* 実行中の更新によって変更が追加された場合、2 回目にスケジュールされた更新中に変更が保存されるようになりました。 以前は、変更が保存されず、マーチャントは変更を再度入力して保存する必要がありました。

<!-- ACP2E-21-->

* 一括アクションログに、失敗した更新 `to be moved` スケジュールされた更新に関する情報が表示されるようになりました。 以前は、これらのエラーに関する情報は `cron.log` ファイルでのみ入手できました。

<!-- ACP2E-420-->

* マーチャントは、ロケールに関係なく、スケジュールされた更新で製品価格を編集する際に、コンマ区切りの価格の使用に制限されるようになりました。 以前は、予定されている更新にコンマが含まれる価格は、ロケールに応じて 1000 で割られていました。

<!-- AC-3214-->

* PHP 8.1 を実行する環境での DHL の国内配送に関する問題は、国際配送にのみ互換性のあるタグを要求することで解決されました。

### 税

<!-- ACP2E-735-->

* 買い物かご内の製品に対して、固定製品税（FPT）が正しく表示されるようになりました。 以前は、買い物かご内の複数の製品で **固定製品税（FPT）** および **FPT に税を適用** が有効になっている場合、すべての FPT が買い物かご内の最後の製品に割り当てられ、他の製品はリセットされていました。

<!-- ACP2E-350-->

* チェックアウトワークフローの注文概要セクションの固定製品税（FPT）の合計が正しく計算されるようになりました。

<!-- ACP2E-291-->

* Adobe Commerceでは、シンプルな商品の数量が変更された後、商品ページでシンプルな商品の免税階層価格を期待どおりに更新するようになりました。

<!-- ACP2E-182-->

* ドロップダウンリストから選択した国が EU 諸国リストに含まれているかどうかを確認するための検証がストア設定ページに追加されました。 **VAT 番号を検証** ボタンが EU 諸国にのみ表示されるようになりました。 以前は、このボタンは、英国を含むすべての国で表示されていました。

<!-- ACP2E-45-->

* **カタログに製品価格を表示** が **税抜き** または **税込みと税抜き** に設定されている場合、階層価格が正しく計算されるようになりました。 以前は、製品の詳細ページには、設定にかかわらず、階層価格と税金が表示されていました。

<!-- AC-1925-->

* ポルトガル語のロケールを使用して、ストアフロントの有効なアドレスへの注文に対して税金が正しく適用されるようになりました。 [GitHub-34271](https://github.com/magento/magento2/issues/34271)

<!-- AC-1084-->

* `subtotal_with_discount_excluding_tax` を返す際、`cart` クエリに税金が含まれなくなりました。 [GitHub-33905](https://github.com/magento/magento2/issues/33905)

<!-- ACP2E-651-->

* 注文データ（`GET /V1/orders/`）に対する Web API リクエストで、行の合計に負の値が返されなくなりました。

### テスト

<!-- AC-2004-->

* AWS Elasticsearch設定で実行した場合の `Magento.GraphQl.CatalogGraphQl.ProductSearchTest.testSearchSuggestions` のエラーを修正しました。

<!-- AC-1113-->

* `testCreateProductOnStoreLevel` 統合テストで、データベースでネストされたトランザクションが発生しなくなりました。

* PHP 8.1 で product image が設定されていない場合に、Send Friend 機能の WebAPI テストを実行しても、次の例外が発生しなくなりました。`exception main.ERROR: /var/www/html/lib/internal/Magento/Framework/DataObject.php:131 strpos(): Passing null to parameter #1 ($haystack) of type string is deprecated`。 [GitHub-34864](https://github.com/magento/magento2/issues/34864)

### 翻訳とロケール

<!-- ACP2E-537-->

* 「翻訳」インラインツールを使用して、同じ要素を 1 回以上編集できるようになりました。 以前は、このツールを使用して行われた最初の変更のみが含まれていました。

<!-- ACP2E-437-->

* 管理テキストまたはラベルを編集する際に、ストア表示セレクターで翻訳ペインがブロックされなくなりました。 翻訳ペインからこれらの機能を編集できるようになり、「**送信**」をクリックするとインターフェイスにこれらの変更が表示されます。

<!-- ACP2E-362-->

* ポルトガル語（ブラジル）とフランス語（フランス）のロケールの管理日時形式が有効になりました。

<!-- ACP2E-785-->

* グレーブアクセント（&grave;）文字を名前バリデーターに追加して、このアクセントを含む姓名の顧客アカウントを作成できるようにしました。

<!-- ACP2E-682-->

* 製品の詳細ページの **買い物かごに追加** ボタンのテキストが、関連するロケールで指定された言語に翻訳されたままになりました。 翻訳ファイルは、ア `translate_strategy=embedded` ット時に領域、テーマ、ロケールに基づいて、対応するJavaScript ファイルに変換されるようになりました。 以前は、商品が買い物かごに追加された後、テキストは英語に戻っていました。

<!-- ACP2E-752-->

* 検索シノニムで、割り当てられたストアの範囲が考慮されるようになりました。 以前は、特定のストアに割り当てられた同義語は、他のストアで検索できました。

<!-- AC-1178-->

* フィリピン語（フィリピン）ロケールに関する問題が解決されました。 [GitHub-33996](https://github.com/magento/magento2/issues/33996)

### UI

<!-- ACP2E-557-->

* **カタログ**/**製品** グリッドの長い製品名が、1 行に表示されるのではなく、ワードラップされるようになりました。

<!-- ACP2E-347-->

* 最小および最大の生年月日範囲が正しいタイムスタンプとして保存され、有効なタイムスタンプから有効な日付形式に変換されるようになりました。

<!-- ACP2E-280-->

* `magento.com` が使用できないことで、管理者ログイン中にパフォーマンスの問題が発生しなくなりました。 リリース通知を取得するリクエストのタイムアウトが追加されました。

<!-- ACP2E-88-->

* 管理注文、顧客、製品グリッドフィルターの結果が、Chrome ブラウザーに表示された際に期待どおりに保持されるようになりました。

<!-- AC-2750-->

* `Magento_LoginAsCustomerAdminUi` が有効になっており、「**ストア表示からログイン先** が手動選択に設定されている場合、管理者から顧客を作成できるようになりました。 以前は、Adobe Commerceは次のエラーをスローしていました：`(Magento\Framework\Exception\LocalizedException): Unable to get Customer ID`。 [GitHub-33096](https://github.com/magento/magento2/issues/33096)

<!-- AC-2076-->

* 買い物客が製品画像ギャラリーの最後のサムネール画像に到達した場合、「次へ」矢印が期待どおりに無効になりました。

<!-- AC-2060-->

* **キーワードで検索** 入力フィールドに、**カタログ**/**製品** ページのプレースホルダーではなく `aria-label` 要素が含まれるようになりました。

<!-- AC-3058-->

* 管理者フッターのプライバシーポリシーのリンクが、新しいAdobe プライバシーポリシーにリンクされるようになりました。

<!-- AC-2880-->

* 実稼動モードでJavaScriptのバンドルが有効な場合、管理者は管理メニューオプションにアクセスできるようになりました。  [GitHub-35325](https://github.com/magento/magento2/issues/35325)

<!-- AC-2851-->

* 管理者は、現在のユーザーの有効期限を 2038 年より後に設定して、ユーザーを正常に保存できるようになりました。 以前は、有効期限が変更されたユーザーは、ログアウト後にログインし直すことができませんでした。

<!-- AC-751-->

* 管理者が管理 **ストア**/**属性**/**顧客の住所** で住所に過度の番地を含む場合に、Adobe Commerceに情報エラーメッセージが表示されるようになりました。  管理者は追加のアドレス情報を削除し、アドレスを正常に保存できるようになりました。 以前は、Adobe Commerceは追加の行をコミットしていましたが、データは保存されませんでした。

<!-- ACP2E-546-->

* データベースおよびローカルストレージの製品リスト表示設定が更新されました。 ページの再読み込み時やビューの変更時に、カスタムグリッドビューが保存されるようになりました。

<!-- ACP2E-747-->

* Web サイト制限が有効な場合に、ストアの表示を切り替えられるようになりました。 以前は、ストア表示スイッチャーの問題により、ストア表示を切り替えることができませんでした。

<!-- AC-2042-->

* favicon アイコンのアップロードフォームで、`.ico` ファイルタイプがサポートされるようになりました。 以前は、この拡張子タイプの favicon ファイルを管理者にアップロードしようとすると、Adobe Commerceに「`Warning: imagecreatefromstring(): one parameter to a memory allocation multiplication is negative or zero, failing operation gracefully in /var/www/html/vendor/magento/module-media-storage/Model/File/Validator/Image.php on line 64`」というエラーが表示されていました。 [GitHub-34858](https://github.com/magento/magento2/issues/34858)

<!-- AC-3122-->

* 管理グリッドのドロップダウンの選択メニューに関する表示の問題を修正しました。 [GitHub-35386](https://github.com/magento/magento2/issues/35386)


### URL の書き換え

<!-- AC-2535-->

* 特定のストア表示の製品の URL のみが、特定のストア表示の属性コードの表示ステータスが **個別に表示されない** に変更された後、`url_rewrite` テーブルおよび管理者から削除されるようになりました。  以前は、`url_rewrite` テーブル内の製品について、すべての URL が削除されていました。 [GitHub-34937](https://github.com/magento/magento2/issues/34937)

### ビデオ

<!-- ACP2E-485-->

* ページビルダーでYouTubeの URL パラメーターを使用して新しいビデオを追加できるようになりました。 以前は、これらのパラメーターは URL から自動的に削除されていました。

<!-- AC-2251-->

* CSP が `restrict mode` に設定されている場合、`banner` 要素のバックグラウンドで実行されるように Vimeo ビデオを設定できるようになりました。 以前は、Adobe CommerceがJavaScript エラーをスローしていました。

### Web API フレームワーク

<!-- ACP2E-694-->

* 同時要求による更新時の競合状態を防ぐために、注文に対して Mutex が実装されました。 以前は、同時 REST API 呼び出し時の競合状態により、管理項目順序テーブルの出荷ステータス情報が上書きされていました。

<!-- ACP2E-677-->

* REST API を使用して特定のストア表示で製品を更新する際に、ペイロードで明示的に定義されていない限り、製品画像の役割の継承が保持されるようになりました。

<!-- AC-2231-->

* Swagger スキーマ（`/rest/schema`）で一意の操作 ID が使用されるようになりました。

<!-- AC-2845-->

* `POST /V1/salesRules/` エンドポイントを通じて作成された買い物かご価格ルールで、ステータスを無効から有効に変更した後、既存のクーポンコード値が保持されるようになりました。 [GitHub-35298](https://github.com/magento/magento2/issues/35298)

<!-- AC-2764-->

* `POST /V1/salesRules/` エンドポイントを通じて作成された買い物かご価格ルールに、有効な `from_date` と `to_date` の値が含まれるようになりました。 [GitHub-35265](https://github.com/magento/magento2/issues/35265)

<!-- AC-2522-->

* `CartItemInterface` に `customizable_options` が含まれるようになりました。 [GitHub-31180](https://github.com/magento/magento2/issues/31180)

<!-- AC-2898-->

* `Magento_ReCaptchaWebapiRest` モジュールが有効な場合、REST API の一括PUTおよびDELETE リクエストが期待どおりに動作するようになりました。 [GitHub-35348](https://github.com/magento/magento2/issues/35348)

<!-- AC-763-->

* Bulk Rest API は、設定可能な製品の `bySku` オプションと連携するようになりました。 以前は、500 エラーが返されていました。

<!-- AC-1169-->

* `/V1/products/base-prices` エンドポイントが、**カタログ価格モード - Web サイト** で期待どおりに動作するようになりました。 [GitHub-30132](https://github.com/magento/magento2/issues/30132)

<!-- AC-441-->

* `POST /V1/products/special-price` エンドポイントを使用した新しい特別価格スケジュールの作成が、期待どおりに動作するようになりました。 以前は、エンドポイントは次のエラーを返していました：`Future Update already exists in this time range. Set a different range and try again`。

### ウィッシュリスト

<!-- ACP2E-459-->

* ウィッシュリストページから品目数量を更新すると、製品詳細ページの数量が期待どおりに更新されるようになりました。 Adobe Commerceは、更新された値を商品 URL から取得し、ウィッシュリスト自体から商品詳細ページの `qty` フィールドに入力するようになりました。

## 既知の問題

**問題**:2.4.5 より前のバージョンからAdobe Commerce 2.4.6 以降にアップグレードすると、ステージングされた販売ルールラベルが一致しない場合があります。 **回避策**: アップグレード中に、「メタデータを更新」手順の前に ACSD-50625_2.4.5-P1.patch を適用してください。 ナレッジベースの記事 [ バージョン &lt; 2.4.5 からのアップグレード時の salesRules ラベルの問題 ](https://experienceleague.adobe.com/docs/commerce-knowledge-base/kb/troubleshooting/known-issues-patches-attached/salesrule-label-issues-when-upgrade-from-versions-under-2.4.5.html?lang=ja) を参照してください。

この問題を解決する一般的な手順は次のとおりです。

1. 必要なパッチをダウンロードします ナレッジベースの記事 [ バージョン &lt; 2.4.5 からのアップグレード時の salesRules ラベルの問題 ](https://experienceleague.adobe.com/docs/commerce-knowledge-base/kb/troubleshooting/known-issues-patches-attached/salesrule-label-issues-when-upgrade-from-versions-under-2.4.5.html?lang=ja) を参照してください。
2. アップグレードプロセスのパッケージを管理フェーズ [ アップグレードを実行 ](https://experienceleague.adobe.com/docs/commerce-operations/upgrade-guide/implementation/perform-upgrade.html?lang=ja) で説明されているアップグレード手順に従います。
3. このパッチは、アップグレード中、パッケージを管理フェーズの後、メタデータを更新フェーズの前に適用します。[Adobeが提供するコンポーザーパッチの適用方法 ](https://experienceleague.adobe.com/docs/commerce-knowledge-base/kb/how-to/how-to-apply-a-composer-patch-provided-by-magento.html?lang=ja) を参照してください。
4. アップグレードプロセスを完了します。

**問題**:Braintreeが有効な場合、管理者ユーザーは、管理者から顧客の注文の作成や並べ替えができない。 管理者ユーザーが **注文** または **並べ替え** をクリックすると、Adobe Commerceは注文を送信せず、`system.log` に次のエラーが表示されます。`report.CRITICAL: Error: Call to a member function getMethodInstance() on null in /app/vendor/paypal/module-braintree-core/Block/Form.php:174`  **回避策**:`BUNDLE-3137-composer.patch` が使用可能になりました。 この問題とパッチへのアクセスの詳細については、[Braintree支払いが有効な場合、管理者が注文を作成または並べ替えでき ](https://support.magento.com/hc/en-us/articles/8322266352525) せん」ナレッジベースの記事を参照してください。 Cloud マーチャントは、Commerce v1.0.18 のクラウドパッチをダウンロードする必要があります。修正は、Adobe Commerce 2.4.5-p1 にも含まれる予定です。<!-- AC-6222-->

**問題**:Adobe Commerce 2.4.5 の新規インストール（アップグレードではない）の後、[!DNL RabbitMQ] インフラストラクチャ要素（交換、キュー）が初期化されない。この [!DNL RabbitMQ] の設定が正しくないと、非同期操作の実行時やパフォーマンスプロファイルの生成時に重大なエラーが発生する可能性があります。 クラウドデプロイメントは影響を受けません。 **回避策**:Adobe Commerce 2.4.5 オンプレミスの新規インストールを実行するマーチャントは、`bin/magento setup:config:set` を使用して [!DNL RabbitMQ] を設定した後、`bin/magento setup:upgrade --keep-generated` を実行するか、`setup:install` コマンドに設定オプションを渡してAdobe Commerce[!DNL RabbitMQ] インストールする必要があります。 [[!DNL RabbitMQ]](../../../installation/prerequisites/rabbitmq.md) を参照。

## コミュニティの投稿

Magento Open Sourceの皆さまには深く感謝申し上げるとともに、今回のリリースに対する皆さまのご尽力を心より感謝申し上げます。

コミュニティエンジニアリングチーム [Magento貢献者](https://magento.biterg.io/app/kibana) は、月、四半期、年ごとに、貢献度の高い個人とパートナーのリストを維持しています。 その共同作成者ページから、マージされた PR へのリンクを GitHub にフォローするできます。

### パートナーの貢献

次の表に、パートナーによる貢献を示します。 この表には、プルリクエストを行ったパートナー、外部プルリクエスト番号、関連付けられた GitHub 問題番号（使用可能な場合）が一覧表示されます。

{{$include /help/_includes/release-notes/engcomm-2-4-5-partner.md}}

### 個々のコントリビューターの投稿

次の表に、コミュニティメンバーからの投稿を示します。 この表は、プルリクエストを行ったコミュニティメンバー、外部プルリクエスト番号、関連付けられた GitHub 問題番号（使用可能な場合）の一覧です。

{{$include /help/_includes/release-notes/engcomm-2-4-5-issues.md}}

## 必要システム構成

当社のテクノロジースタックは、PHPとMySQL上に構築されています。 詳しくは、 [必要システム構成](../../../installation/system-requirements.md) を参照してください。

## インストールおよびアップグレードの手順

[Composer](../../../installation/composer.md) を使用して Commerce 2.4.5 Adobe Systemsをインストールできます。
