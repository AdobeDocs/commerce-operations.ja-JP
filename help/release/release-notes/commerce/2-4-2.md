---
title: Adobe Commerce 2.4.2 リリースノート
description: 2.4.2 Adobe Commerceリリースの新機能、機能強化、バグ修正および既知の問題について説明します。
source-git-commit: 4c3a5b6462668993dcfb0ecb9327a7ffc47ced44
workflow-type: tm+mt
source-wordcount: '16459'
ht-degree: 0%

---


# Adobe Commerce 2.4.2 リリースノート

Adobe Commerce 2.4.2 では、パフォーマンスとセキュリティが強化されたほか、プラットフォームが大幅に改善されました。 セキュリティの強化には、 `SameSite` 属性を設定します。 B2B の改善は、発注書のオンライン支払いのサポートに焦点を当てています。 Elasticsearch7.9.x と Redis 6.x がサポートされるようになりました。

このリリースには、コアコードの 280 件以上の新しい修正と 35 件のセキュリティ強化が含まれています。 これには、コミュニティメンバーによる 290 件近くの GitHub の問題の解決が含まれています。 これらのコミュニティへの貢献は、コアコードの小規模なクリーンアップから、GraphQL の大幅な機能強化まで多岐にわたります。

2.4.1 で識別された既知の問題は、すべてこのリリースで修正されました。

{{bics}}

## 適用 `AC-3022.patch` DHL を輸送船に供給し続ける

DHL はスキーマバージョン 6.2 を導入し、近い将来にスキーマバージョン 6.0 を廃止します。 DHL 統合をサポートするAdobe Commerce 2.4.4 以前のバージョンでは、バージョン 6.0 のみがサポートされています。これらのリリースをデプロイするマーチャントは、次のリリースを適用する必要があります。 `AC-3022.patch` 最も早い便宜で、DHL を輸送船として提供し続ける。 詳しくは、 [パッチを適用して、DHL を配送先として提供し続けます](https://support.magento.com/hc/en-us/articles/7707818131597-Apply-a-patch-to-continue-offering-DHL-as-shipping-carrier) パッチのダウンロードとインストールに関する情報については、ナレッジベースの記事を参照してください。

## 使用可能なセキュリティパッチ

業者は、四半期ごとの完全リリースで提供される数百の機能修正や機能強化（2.4.1-p1 など）を適用することなく、時間に依存するセキュリティ修正をインストールできるようになりました。 パッチ 2.4.0.12（Composer パッケージ 2.4.1-p1）は、前四半期のリリース 2.4.1 で特定された脆弱性の修正を提供するセキュリティパッチです。2.4.1 リリースに適用されたすべてのホットフィックスが、このセキュリティパッチに含まれます。 (A) *ホットフィックス* は、特定の問題やバグに対処する、リリースされたバージョンの修正を提供します )。

セキュリティパッチの一般情報については、 [新しいセキュリティパッチリリースの概要](https://community.magento.com/t5/Magento-DevBlog/Introducing-the-New-Security-Patch-Release/ba-p/141287). セキュリティパッチ（パッチ 2.4.1-p1 を含む）のダウンロードと適用の手順については、 [オンプレミスでの迅速なインストールを開始](../../../installation/composer.md). セキュリティパッチには、セキュリティバグ修正のみが含まれ、完全なパッチに含まれる追加のセキュリティ強化は含まれません。

## その他のリリース情報

これらの機能のコードは四半期ごとのリリースにバンドルされていますが、これらのプロジェクト (B2B、Page Builder、Progressive Web Application(PWA)Studio など ) のいくつかも個別にリリースされています。 これらのプロジェクトのバグ修正は、個別のプロジェクト固有のリリース情報に記載されています。この情報は、各プロジェクトのドキュメントに記載されています。

## ハイライト

このリリースでは、次の点に注意してください。

### 大幅なセキュリティ強化

このリリースには、35 件を超えるセキュリティ修正とプラットフォームのセキュリティ改善が含まれています。 すべてのセキュリティ修正は、2.4.1-p1 および 2.3.6-p1 にバックポートされました。

#### 35 を超えるセキュリティ強化が行われ、リモートコード実行 (RCE) およびクロスサイトスクリプティング (XSS) の脆弱性を閉じるのに役立ちます。

これらの問題に関する確認済みの攻撃は、現在までには発生していません。 ただし、一部の脆弱性は、顧客情報にアクセスするために悪用されたり、管理者セッションを引き継ぐ可能性があります。 これらの問題のほとんどは、攻撃者が最初に管理者へのアクセス権を取得する必要があります。 その結果、以下の取り組みに限定されない限り、管理者を保護するために必要なすべての手順を実行するように促されます。IP許可リストに加える、 [二段階認証](https://devdocs.magento.com/guides/v2.4/security/two-factor-authentication.html)、VPN の使用、ではなく一意の場所の使用 `/admin`、およびパスワードの正常性が向上しました。 詳しくは、 [Adobeセキュリティ情報](https://helpx.adobe.com/security/products/magento/apsb21-08.html) これらの修正された問題に関する議論を

#### その他のセキュリティ強化

このリリースのセキュリティ強化には、次のものが含まれます。

* すべてのコア cookie が `SameSite` 属性。

* ユーザーが値をこれらのフィールドに保存しようとすると、悪意の可能性があるコンテンツを製品およびカテゴリの説明フィールドに識別するメッセージが表示されるようになりました。

* コンポーネント全体でのファイルシステム操作は、悪意のあるアップロードを防ぐために標準化され、堅牢化されています。

* コアコンテンツセキュリティポリシー (CSP) の違反を修正しました。

{{cve-notice}}

### インフラストラクチャの改善

このリリースには、フレームワークの品質と以下の機能領域を改善する、コア品質の機能強化が含まれています。顧客アカウント、カタログ、CMS、OMS、インポート/エクスポート、プロモーションとターゲティング、買い物かごとチェックアウト、B2B、ステージングとプレビュー。

### Platform の機能強化

* [**Elasticsearch7.9.x がサポートされました。**](../../../installation/system-requirements.md). Elasticsearch7.9.x の実行をお勧めしますが、Elasticsearch2.4.x はバージョン 7.4.x との互換性を維持します。 <!-- MC-36867-->

* 2.4.2 は [ワニス 6.4](../../../installation/system-requirements.md). バージョン 2.4.x は Vanrish 6.x との互換性を維持します。

* [**Redis 6.x がサポートされました。**](../../../installation/system-requirements.md). バージョン 2.4.x は Redis 5.x との互換性を維持します。 <!-- MC-34853-->

* 2.4.2 は、 **Composer 2.x**. マーチャントを Composer 2.x に移行することをお勧めします。Composer 1.x を使用してこのリリースをインストールできますが、Composer 1.x は近日中に提供終了となります。 Composer 2.x の機能の概要については、 [Composer 2.0 がリリースされました。](https://blog.packagist.com/composer-2-0-is-now-available/)

分割データベースを使用するようにインストールを設定する機能は、このリリースで非推奨（廃止予定）となりました。 現在分割データベースを使用しているマーチャントは、1 つのデータベースに戻るか、1 つのデータベースに移行するか、別の方法を使用する計画を開始する必要があります。 詳しくは、 [Adobe Commerceでの分割データベース機能の廃止](https://community.magento.com/t5/Magento-DevBlog/Deprecation-of-Split-Database-in-Magento-Commerce/ba-p/465187) DevBlog 投稿を参照してください。  詳しくは、 [分割データベースから単一のデータベースに戻す](../../../configuration/storage/revert-split-database.md) 移行手順を参照してください。

### パフォーマンスの強化

このリリースには、大きなカタログを含むデプロイメントの API のパフォーマンスと管理者の応答時間を向上させるコード強化が含まれています。 複数の拡張性を強化することで、2.4.2 は、以前のリリースよりも最大 20 倍大きい複雑なカタログをネイティブでサポートできます。

### GraphQL

このリリースでは、次の機能に対して GraphQL の対象を追加しました。

* 複数のウィッシュリストのサポートを追加しました。 GraphQL を使用して、 [作成](https://devdocs.magento.com/guides/v2.4/graphql/mutations/create-wishlist.html), [削除](https://devdocs.magento.com/guides/v2.4/graphql/mutations/delete-wishlist.html)、および [名前変更](https://devdocs.magento.com/guides/v2.4/graphql/mutations/update-wishlist.html) ウィッシュリスト [移動](https://devdocs.magento.com/guides/v2.4/graphql/mutations/move-products-between-wishlists.html) または [コピー](https://devdocs.magento.com/guides/v2.4/graphql/mutations/copy-products-between-wishlists.html) 項目間に配置されます。 <!-- MC-32356-->

* 返品された商品認証 (RMA) のサポートが追加されました。 買い物客が実行できる機能 [返品をリクエストする](https://devdocs.magento.com/guides/v2.4/graphql/mutations/request-return.html). マーチャントがリクエストを受け入れた場合、買い物客は次のようなタスクを実行できます。 [コメントの追加](https://devdocs.magento.com/guides/v2.4/graphql/mutations/add-return-comment.html) および [トラッキング情報を追加](https://devdocs.magento.com/guides/v2.4/graphql/mutations/add-return-tracking.html). <!-- MC-34596-->

* 次の B2B 機能のサポートが追加されました。
   * 会社。 会社を追加できます [管理者](https://devdocs.magento.com/guides/v2.4/graphql/mutations/create-company.html), [ユーザー](https://devdocs.magento.com/guides/v2.4/graphql/mutations/create-company-user.html), [役割](https://devdocs.magento.com/guides/v2.4/graphql/mutations/create-company-role.html)、および [チーム](https://devdocs.magento.com/guides/v2.4/graphql/mutations/create-company-team.html). <!-- MC-33861-->
   * 会社のクレジット。 この [会社クエリ](https://devdocs.magento.com/guides/v2.4/graphql/queries/company.html) には、会社の信用履歴の詳細が含まれます。 <!-- MC-33862-->
   * 購買依頼リスト。 以下が可能です。 [作成](https://devdocs.magento.com/guides/v2.4/graphql/mutations/create-requisition-list.html), [削除](https://devdocs.magento.com/guides/v2.4/graphql/mutations/delete-requisition-list.html)、および [更新](https://devdocs.magento.com/guides/v2.4/graphql/mutations/update-requisition-list.html) 購買依頼リスト。 サポートには、次の機能も含まれます。 [追加](https://devdocs.magento.com/guides/v2.4/graphql/mutations/add-products-to-requisition-list.html), [更新](https://devdocs.magento.com/guides/v2.4/graphql/mutations/update-products-in-wishlist.html), [削除](https://devdocs.magento.com/guides/v2.4/graphql/mutations/delete-requisition-list-items.html), [コピー](https://devdocs.magento.com/guides/v2.4/graphql/mutations/copy-items-between-requisition-lists.html)、および [移動](https://devdocs.magento.com/guides/v2.4/graphql/mutations/move-items-between-requisition-lists.html) 購買依頼リスト内の品目と購買依頼リスト項目の追加 [を買い物かごに入れます。](https://devdocs.magento.com/guides/v2.4/graphql/mutations/add-requisition-list-items-to-cart.html). <!-- MC-34312-->

* GraphQL での和集合のサポートを追加しました。 [GitHub-29425](https://github.com/magento/magento2/issues/29425) <!-- ENGCOM-8291 -->

* のサポートを追加しました。 [比較リスト](https://devdocs.magento.com/guides/v2.4/graphql/queries/compare-list.html). 買い物客が実行できる機能 [作成](https://devdocs.magento.com/guides/v2.4/graphql/mutations/create-compare-list.html) および [削除](https://devdocs.magento.com/guides/v2.4/graphql/mutations/delete-compare-list.html) 比較リスト、および [追加](https://devdocs.magento.com/guides/v2.4/graphql/mutations/add-products-to-compare-list.html) および [削除](https://devdocs.magento.com/guides/v2.4/graphql/mutations/remove-products-from-compare-list.html) 項目を比較リストに追加します。 また、ゲストとして比較リストを作成した買い物客は、顧客としてログインし、 [保持](https://devdocs.magento.com/guides/v2.4/graphql/mutations/assign-compare-list-to-customer.html) 比較リストが表示されます。

* 追加された [`generateCustomerTokenAsAdmin`](https://devdocs.magento.com/guides/v2.4/graphql/mutations/generate-customer-token-as-admin.html) 突然変異と更新 `Customer` リモートでの購入支援をサポートするオブジェクトです。

* 言語、買い物かご、通貨の変更などのタスクをサポートするために、店舗全体のローカライゼーションサポートを追加しました。 <!-- MC-37801-->

* GraphQL スキーマが強化され、多くのバリアントを持つ設定可能な製品に対して製品データの取得が最適化されました。 <!-- MC-36138-->

* 整数型のオブジェクト ID は廃止されました。代わりに `uid` タイプ ID の属性。 <!-- MC-36346-->

* 追加された `staging` 属性 [`ProductInterface`](https://devdocs.magento.com/guides/v2.4/graphql/interfaces/product-interface.html) および [`CategoryInterface`](https://devdocs.magento.com/guides/v2.4/graphql/interfaces/category-interface.html) 製品がステージングされているかどうかを判断し、関連するキャンペーン情報を表示します。 <!-- MC-33897-->

詳しくは、 [GraphQL 開発者ガイド](https://devdocs.magento.com/guides/v2.4/graphql/) を参照してください。

### B2B

2.4.2 では B2B v1.3.1 が導入されました。このリリースには、発注書のオンライン支払いおよび複数のバグ修正が含まれています。

**オンライン支払い方法を使用して発注書を入力できるようになりました**. B2B 購入者は、それぞれに希望する支払い方法を選択するよう求められます [発注](https://docs.magento.com/user-guide/stores/b2b-purchase-order-flow.html) 最初のチェックアウト時に。 発注が承認されると、購入者は支払いの詳細を入力し、発注を最終発注に変換するよう求められます。

オンライン支払いの受け入れに関する完全なワークフローをサポートするには、この機能も次のようにします。

* PCI コンプライアンスを維持するために、初回チェックアウト時に既存の支払い方法テンプレートを上書きします。

* サードパーティ、カスタム、およびコミュニティが開発した支払い方法との互換性を維持します。

* 承認済みの発注書に支払いの詳細を追加する必要がある場合は、購入者に電子メールで通知します。

* 管理者からのメールのカスタマイズを有効にして、ブランディングに合ったテンプレートをマーチャントが使用できるようにします。

* を導入する `Approved – Pending Payment` アクションが必要な場合に発注書が明確に示す状態。

* 最終の支払い手順で割引コードが追加または削除されるのを防ぎ、承認済み発注書の注文合計金額が変更されないようにします。

* 購入者は、最後の支払い手順の間に支払い方法を変更して、柔軟性を維持し、コンバージョンを増やすことができます。

このリリースには、複数のバグ修正も含まれています。 詳しくは、 [B2B リリースノート](https://experienceleague.adobe.com/docs/commerce-admin/b2b/release-notes.html).

### PWA Studio

このリリースのPWA Studioには、次が含まれます。

* 国際化とローカリゼーション。 Venia は、複数の言語と通貨をサポートするようになりました。

* 拡張機能を通じたコード変更をサポートするための拡張フレームワークを改善しました。

* マイアカウント関連機能の初期コンポーネント（ウィッシュリスト、保存済みの支払い、アドレス帳、注文履歴など）。

* 様々なパフォーマンスの最適化とバグ修正。

機能強化とバグ修正について詳しくは、 [PWA Studioリリース](https://github.com/magento/pwa-studio/releases). 詳しくは、 [互換性](https://developer.adobe.com/commerce/pwa-studio/integrations/adobe-commerce/version-compatibility/) を参照してください。

### Page Builder

このリリースには、Page Builder コンテンツの移行と、Page Builder CSS のカスタマイズに関する機能が含まれています。

* 開発者は、 `!important` ディレクティブ。

* Page Builder に移行されたコンテンツは、デフォルトのインラインスタイルでパディングされなくなりました。

* Page Builder では、すべてのコンテンツタイプを 1 行内に配置する必要がなくなりました。 この [Page Builder ステージ](https://docs.magento.com/user-guide/cms/page-builder-workspace.html#stage) は最初は空白になり、次のコンテンツタイプを直接ステージに追加できるようになりました。行、列、タブ、HTMLコード、ブロック、動的ブロック。

* コンテンツタイプでは、事前定義済みの余白と余白は不要になりました。

* 新しいモバイル [ビューポートスイッチャー](https://docs.magento.com/user-guide/cms/page-builder-workspace.html#viewports) フォームフィールド値のビューポート範囲を使用すると、ユーザーと開発者は次の操作を実行できます。

   * オーサリング時に、様々なビューポートでコンテンツを表示します。

   * 各ビューポートに対して異なるコンテンツタイプの最小高さフィールドパラメーターを最適化します。 (1 つのパラメータ（最小高さ）のみが標準でサポートされています。 他のコンテンツパラメーターに対するモバイル最適化を有効にするために必要なカスタム開発。)

   * カスタムフィールドおよびフィールドセット（開発者）にフィールド範囲を追加します。

### インタラクティブな製品内ガイダンス

インタラクティブな製品内ガイダンスは、新機能のお知らせ、ウォークスルーガイド、オンボーディング情報、ツールヒントに関する使用上のヒントと情報を管理者から提供します。  **この機能が有効になっていない場合、製品内ガイダンスを受け取るには、管理者が管理者からオプトインする必要があります**. 詳しくは、 [使用状況データの収集](https://docs.magento.com/user-guide/stores/admin.html) および [管理使用状況](https://docs.magento.com/user-guide/configuration/advanced/admin.html#admin-usage).

### Adobe Stock統合

このリリースには、Adobe Stock Integration v2.1.1 が含まれています。

### メディアギャラリー

**メディアギャラリーの新しい役割リソース**. このリリースでは、マーチャントが管理者のアクセス権をメディアギャラリーのみに制限し、次の操作を実行できるユーザーを制御できるようになりました。

* コンテンツへのメディアアセットの挿入

* アセットのアップロード

* アセットの詳細を編集

* メディアギャラリーからのアセットの削除

* フォルダー構造を管理します。

**コンテンツ内の Web に最適化された画像**. マーチャントが [web に最適化された画像レンディション](https://docs.magento.com/user-guide/cms/media-gallery-image-optimization.html) 高解像度の画像ではなくコンテンツ内で使用されます。 元の画像はメディアギャラリーで変更されず、画像がコンテンツに挿入されると、画像レンディションが動的に生成されます。

### AWS S3 サポートの強化

Amazon Simple Storage Service(AWS S3) のサポートが強化され、以下のサポートが含まれるようになりました。

* オブジェクトストレージと将来の拡張機能

* [メディアファイルの保存](../../../configuration/remote-storage/remote-storage.md) AWS S3

AWS S3 のサポートが、B2B、PageBuilder、Adobe Stock統合を含むすべてのモジュールに追加されました。

### 機能テストフレームワーク (MFTF)

MFTF 3.2.1 がリリースされました。 このリリースでは、テストとテストスイートの生成の両方でエラートレランスが導入されました。 その他の機能強化およびバグ修正については、 [機能テストフレームワーク変更ログ](https://github.com/magento/magento2-functional-testing-framework/blob/develop/CHANGELOG.md).

### 受注管理システム (OMS)

MCOM コネクタは 2.4.2 との完全な互換性があります。コネクタに関するバグの修正と機能強化については、 [Connector のリリースノート](https://omsdocs.magento.com/release-notes/connector/index.html). このリリースでは、OMS コマンドラインインターフェイスが改善され、パートナーやサポートチームがトラブルシューティングに使用できる詳細な情報が提供されるようになりました。 `retry`, `queue_prune`, `order_sync`, `message process`、および `catalog export` プロセス。

### ベンダーが開発した拡張機能

このリリースの機能と変更点に関する更新については、次の記事を参照してください。

* [Amazon Pay](https://docs.magento.com/user-guide/payment/amazon-pay.html). Amazon Pay はこのリリースで廃止され、Magento2.5.0 で削除されます。バージョン 2.4.3 以降には、互換性と重大なバグの修正のための更新のみが含まれます。

* [Braintree](https://docs.magento.com/user-guide/payment/braintree.html)

* [DotDigital Engagement Cloud](https://docs.magento.com/user-guide/marketing/dotdigital/engagement-cloud.html)

* [クラルナ](https://docs.magento.com/user-guide/payment/klarna.html)

* [頂点雲](https://docs.magento.com/user-guide/tax/vertex.html)

* [Yotpo 製品レビュー](../../../upgrade/modules/upgrade.md)

## 修正された問題

2.4.2 コアコードでの数百の問題を修正しました。

### インストール、アップグレード、導入

<!-- MC-38429-->

* 分割データベースを使用するようにインストールを設定する機能は、このリリースで非推奨（廃止予定）となりました。 詳しくは、 [Adobe Commerceでの分割データベース機能の廃止](https://community.magento.com/t5/Magento-DevBlog/Deprecation-of-Split-Database-in-Magento-Commerce/ba-p/465187) DevBlog 投稿。

<!-- MC-36472-->

* マーチャントは、MySQL 8.x を実行するオープンソースデプロイメントを、Commerce デプロイメントに正常にアップグレードできるようになりました。 以前は、アプリケーションは、 `AUTO_INCREMENT` 値は、 `row_id` がアップグレード中に追加されました。

<!-- ENGCOM-7280 -->

* 実行中にエラーが発生した場合に、パッチの作成に使用されたパスを識別するエラーメッセージがアプリケーションに表示されるようになりました `bin/magento/setup:db:generate-patch`. [GitHub-27523](https://github.com/magento/magento2/issues/27523)

<!-- ENGCOM-8029 -->

* `block_html`, `full_page`、および `layout` キャッシュは、以降、期待どおりに無効になりました `bin/magento/setup:upgrade` 実行。 [GitHub-28186](https://github.com/magento/magento2/issues/28186)

<!-- ENGCOM-8184 -->

* 最低限必要な PHP バージョンは、 `bootstrap.php` が更新されました。 [GitHub-30004](https://github.com/magento/magento2/issues/30004)

<!-- MC-38788-->

* これで、 `bin/magento/setup:upgrade` サンプルデータをインストールした後。 以前は、 `bin/magento/setup:upgrade`に設定されている場合、アプリケーションは次のエラーを表示していました： `unable to apply data patch magento\catalogrulesampledata\setup\patch\data\installcatalogrulesampledata for module magento_catalogrulesampledata`. また、システムログに次のエラーが表示されました。 `main.ERROR: Sample Data error: Unable to unserialize value. Error: Syntax error`. [GitHub-30685](https://github.com/magento/magento2/issues/30685)

<!-- MC-36785-->

* コマンドラインからYouTube API キーを期待どおりに設定できるようになりました。 以前は、を実行しようとすると、アプリケーションがこのエラーを返していました `bin/magento config:sensitive:set catalog/product_video/youtube_api_key`: `There are no sensitive configurations to fill`.

<!-- ENGCOM-8163 -->

* 現在は、このアプリケーションで `maxMessages` に定義された値 `queue_consumer.xml`. 以前は、アプリケーションはデプロイメント設定値のみを使用していました。 [GitHub-29522](https://github.com/magento/magento2/issues/29522)

<!-- ENGCOM-8243 -->

* を使用してストアを作成する場合、新しいストアの URL 生成が期待どおりに動作するようになりました `bin/magento setup:config:import`. 以前は、URL の書き換えは実稼動環境では生成されませんでした。 [GitHub-30025](https://github.com/magento/magento2/issues/30025)

<!-- ENGCOM-8230 -->

* を実行すると、この質問はアプリケーションに表示されなくなります `bin/magento setup:install` 既存のデータベースに接続するには： `Overwrite the existing configuration for db-ssl-verify?[Y/n]`. [GitHub-29612](https://github.com/magento/magento2/issues/29612)

### AdminGWS

<!-- MC-37040-->

* この **新しい評価を追加** ボタンと **保存**, **削除**, **リセット** ボタンが **ストア** > **属性** > **評価** 権限が制限されている管理者用のページ。

<!-- MC-35804-->

* 管理者は、ログイン管理者が権限を持つ Web サイトからのデータのみを表示するようになりました。 以前は、管理者には、デプロイメント内のすべての Web サイトのデータが表示されていました。

<!-- MC-35027-->

* 選択したすべての Web サイトは、 `gws_websites` web サイト ID のサイズに関係なく。 以前は、Web サイト ID は切り捨てられ、選択した Web サイトのリストはデータベースに保存されていませんでした。 ユーザーの役割が正しく保存されず、マーチャントが役割を変更して保存しようとすると、アプリケーションがこのエラーを表示しました。 `The "X" store ID is incorrect. Verify the store ID and try again`.

<!-- MC-37223-->

* 管理グリッドに、制限付き管理者ユーザーの正しい項目数が表示されるようになりました。 以前は、これらのグリッドに対して表示されたカウントはすべての国のデータを反映していましたが、グリッド自体には特定の国のデータのみが表示されていました。 （この修正により、顧客セグメント、カタログ価格ルール、買い物かごの価格ルール、すべてのユーザー、ロックされたユーザー、ユーザーの役割のグリッドの問題が修正されます）。

<!-- MC-34156-->

* 権限が除外される管理者 `Magento_Catalog::edit_product_design` （製品デザインを編集）選択したストア表示で既存の製品を新しい名前で保存することで、新しい製品を作成できるようになりました。 以前は、アプリケーションで次のエラーが表示されていました。  `Not allowed to edit the product's design attributes`. [GitHub-28106 ](https://github.com/magento/magento2/issues/28106)

<!-- MC-36406-->

* アプリケーションに「 **属性を追加** ボタン **ストア** > 属性を使用します。 以前は、適切な権限を持たない Web サイト管理者が Web サイトの **属性セット** または **顧客** 属性。

<!-- ENGCOM-8230 -->

* 変更を試みても、アプリケーションでエラーがスローされなくなりました。 `backend-frontname` の使用 `ssh` Adobe Commerceをインストールした後のコンテナ [GitHub-26762](https://github.com/magento/magento2/issues/26762)

### Adobe Stock統合

<!-- ENGCOM-8020-->

* 読み上げのサポートを追加しました `exif_image.png` または `exif-image.jpeg` メタデータ。 [GitHub-1449](https://github.com/magento/adobe-stock-integration/issues/1449)

<!-- ENGCOM-8194 8094 8147 -->

* メディアギャラリーのデフォルト表示のブックマークをクリックしたときに表示されるコンテンツは、フィルタリングされなくなりました。 以前は、デフォルトのビューには、次の場所から適用されたフィルターが含まれていました `url-filter` アプリエ。 [GitHub-1813](https://github.com/magento/adobe-stock-integration/issues/1813), [GitHub-1789](https://github.com/magento/adobe-stock-integration/issues/1789), [GitHub-1780](https://github.com/magento/adobe-stock-integration/issues/1780)

<!-- ENGCOM-8070 -->

* ロジックが WYSIWYG OnInsert コントローラから削除されました (`Magento\Cms\Controller\Adminhtml\Wysiwyg\Images\OnInsert::execute()`) を追加し、 `Model\Wysiwyg\Images\PrepareImage::execute()` モデル。 [GitHub-1504](https://github.com/magento/adobe-stock-integration/issues/1504)

<!-- ENGCOM-8081 -->

* 領域エミュレーションが `media-content:sync` コマンド (`\Magento\MediaContentSynchronization\Console\Command\Synchronize::execute`) をクリックします。 [GitHub-1784](https://github.com/magento/adobe-stock-integration/issues/1784)

### Analytics

<!-- MC-37137-->

* 高度なレポートは、同じドメイン内の複数の環境で、期待どおりに動作するようになりました。 以前は、CSV 標準の RFC4180 で必要な別の二重引用符ではなく、二重引用符がバックスラッシュでエスケープされていたので、高度なレポートで生成された CSV ファイルは失敗していました。

<!-- MC-35996-->

* この `analytics_collect_data` デフォルトまたはデフォルト以外のポートを使用して MySQL に接続する場合に、ジョブが正常に実行されるようになりました。 `env.php`. 以前は、 `analytics_collect_data` デフォルト以外のポートを使用した場合にエラーがスローされました。

<!-- MC-35407-->

* で生成された CSV ファイル `analytics_collect_data` が適切にエスケープされるようになりました。 以前は、これらのファイルが正しいエスケープを使用して生成されず、在庫レポートが生成されませんでした。

### Braintree

* 買い物客がApple Pay を使用して、仮想製品の注文を正常におこなうことができるようになりました。 以前は、アプリケーションは次のエラーをスローしていました：  `There are no shipping methods available for you right now. Please try again or use an alternative payment method`.

* デフォルトの PayPal Express Checkout 支払い方法が、Braintreeのクレジットカード支払い方法で期待どおりに動作するようになりました。 以前は、 **PayPal** 」ボタンをクリックします。

### 製品のバンドル

<!-- MC-34063-->

* アプリケーションは、固定価格バンドル製品の子項目の価格を見積もりで設定しなくなりました。

<!-- MC-38050-->

* バンドル製品に在庫切れの製品が含まれる場合、価格の並べ替えが期待どおりに機能するようになりました。 以前は、価格を降順で並べ替えても、価格が下がる順に商品が表示されませんでした。

<!-- MC-38576-->

* 多数のオプションが存在する場合、バンドル製品オプションにデフォルトの数量 1 が自動的に適用されるようになりました。 以前は、商人は各オプションにデフォルトの数量を手動で割り当てる必要がありました。

<!-- ENGCOM-8159 -->

* 注文の請求書作成ページに、バンドル製品の子製品が期待どおりに表示されるようになりました。 [GitHub-27350](https://github.com/magento/magento2/issues/27350)

<!-- MC-38460 -->

* カスタム価格でバンドル製品の一部であるシンプルな製品を再注文する際に、アプリケーションは正しい製品価格を割り当てるようになりました。 以前は、バンドル製品にカスタム価格を設定すると、再注文時に付属のシンプル製品で誤った価格が表示されていました。 [GitHub-30343](https://github.com/magento/magento2/issues/30343)

<!-- MC-30348 -->

* 呼び出しPOST `/V1/order/{orderId}/ship` バンドル製品を含む注文を出荷する場合、注文が期待どおりに完了したことを示します。 以前は、アプリケーションに次のエラーメッセージが表示されていました。 `You can't create a shipment without products`. [GitHub-9762](https://github.com/magento/magento2/issues/9762)

### 買い物かごとチェックアウト

<!-- MC-34264-->

* チェックアウトワークフローの出荷手順にカスタム住所属性が存在する場合、発送方法見積もりが期待どおりに機能するようになりました。 以前は、アプリケーションに次のエラーメッセージが表示されていました。 `{"message":"Error occurred during \"custom_attributes\" processing. A custom attribute is specified with a missing attribute code. Verify the code and try again."}` [GitHub-27505](https://github.com/magento/magento2/issues/27505)

<!-- MC-35783-->

* これで、アプリケーションに「 `You have no items in your shopping cart` 買い物客が買い物かご内の唯一の項目を削除した場合に、ミニカート内のメッセージが期待どおりに表示されます。 以前は、買い物かごのデータは `checkout/cart/removeFailed` 買い物客が単一の品目を削除し、アプリケーションが次のメッセージを表示したとき： `1 product requires your attention`.

<!-- MC-36088-->

* 適用されない出荷方法の注文に対する出荷原価が表示されなくなりました。 以前は、チェックアウトワークフローで、該当しない発送方法の価格が 0 と表示されていました。

<!-- MC-36598-->

* 顧客のデフォルトの請求先住所が **請求先住所と配送先住所が同じです** チェックアウトワークフローのチェックボックスがオフになっている。

<!-- MC-36685-->

* 管理者は、管理者からリダイレクトされることなく、管理者から SKU で製品を買い物かごに追加できます。 管理者がストアフロントページにリダイレクトされなくなり、アプリケーションが「買い物かごの項目を管理」セクションに期待どおりに製品を表示します。

<!-- MC-36750-->

* 製品を SKU で買い物かごに追加する際に、複数のタイプのエラーを含む CSV ファイルをアップロードすると、情報のエラーメッセージがアプリケーションに表示されるようになりました。 以前は、「 **ファイルを選択** オン **買い物かごを管理** > **SKU で買い物かごに追加**.

<!-- MC-37351-->

* 買い物客が別のドメインであるストアから別のストアに切り替えても、買い物かごのコンテンツが失われなくなりました。

<!-- MC-38000-->

* 複数の発送方法を使用する場合に、複数の住所でチェックアウトを使用して注文を正常に完了できるようになりました。 以前は、アプリケーションで次のエラーが表示されていました。 `There has been an error processing your request`. [GitHub-30197](https://github.com/magento/magento2/issues/30197)

<!-- MC-38048-->

* 買い物客が買い物かごからの店舗表示を変更した場合、アプリケーションで、チェックアウトワークフローの出荷ページに正しいデフォルトの国が表示されるようになりました。

<!-- MC-38309-->

* ゲスト買い物客がログインしたときにログアウト後のパスワードがリセットされた後に顧客セッションをクリーンアップする際、アプリケーションは現在のセッションを除外するようになりました。 以前は、買い物客がパスワードをリセットすると、アプリケーションが買い物かごを空にしていました。

<!-- MC-36884-->

* 買い物客が買い物かごの店舗表示を変更した場合に、アプリケーションに店舗表示の正しいデフォルトの国が表示されるようになりました。 以前は、買い物かご内のストア表示を変更した場合、デフォルトの国が正しくありませんでした。

<!-- MC-38723-->

* カタログ権限が設定される順序によって、適切な権限を持つ管理者が製品を買い物かごに追加できなくなりました。 以前は、アプリケーションは `addToCart` 現在の顧客グループの設定。 その結果、管理者が買い物かごに製品を追加しようとすると、アプリケーションがエラーをスローしました。

<!-- MC-38746-->

* への冗長な呼び出し `/rest/V1/guest-carts/cart_id/totals-information` 買い物かごのエンドポイントが削除され、買い物かごのパフォーマンスが向上しました。 以前は、買い物客が買い物かごに製品を追加し、その後買い物かごを表示したときに、アプリケーションは `collectAddressTotals` メソッドを複数回実行します。

<!-- MC-38833-->

* アプリケーションに「 **地域** チェックアウトワークフローの国のフィールド ( **国のオプションの場合に州を選択することを許可** の設定は無効です。 [GitHub-30747](https://github.com/magento/magento2/issues/30747)

<!-- MC-38813-->

* 管理者から注文が並べ替えられた場合、ストアフロントのチェックアウトワークフローで配送先住所が繰り返されなくなりました。

<!-- MC-38814-->

* の設計に関する問題を修正しました。 `AdminMediaGalleryInsertLargeImageFileSizeTest`.

<!-- MC-37321-->

* 内のすべての新しいレコード `quote` ゲスト用のテーブルが、 `customer_is_guest field`. 以前は、買い物かごに製品を追加した新規ゲストごとに、レコードには`quote.customer_is_guest` フィールドに入力します。

<!-- ENGCOM-8091 -->

* この **送信** ボタンが、チェックアウトワークフローの「Review &amp; Payments」セクション内に移動しました。 `<form id="purchaseorder-form"...></form>`:JavaScript を変更することなく、暗黙のフォーム送信を可能にします。 [GitHub-27925](https://github.com/magento/magento2/issues/27925)

<!-- ENGCOM-8428 -->

* アプリケーションに「 **地域** フィールドの値をチェックアウトする際に **国のオプションの場合に州を選択することを許可** の設定は無効です。 [GitHub-30747](https://github.com/magento/magento2/issues/30747)

<!-- ENGCOM-8442 -->

* 買い物客がクリックしたときに、アプリケーションが買い物かごの品目の小計を正しく更新するようになりました。 **買い物かごの更新** 複数のアドレスをチェックアウトする場合。 [GitHub-30408](https://github.com/magento/magento2/issues/30408)

<!-- ENGCOM-8283 -->

* アプリケーションで `config.xml` ノードは、現在インストールされていない支払い方法に存在します。 以前は、アプリケーションはチェックアウト中に例外をスローしていました。 [GitHub-29555](https://github.com/magento/magento2/issues/29555)

<!-- ENGCOM-8215 -->

* ミニカートに特殊文字を含む製品名が正しくレンダリングされるようになりました。 [GitHub-29075](https://github.com/magento/magento2/issues/29075)

<!-- ENGCOM-8308 -->

* これで、表レートに対する正しい割引パッケージが設定されます。 以前は、表レートを計算する際に、買い物かごに割引を設定する買い物かごルールが適用されていませんでした。 [GitHub-30169](https://github.com/magento/magento2/issues/30169)

### 買い物かごの価格ルール

* 税を組み込まずに注文の小計を計算する場合、買い物かごの価格ルールが期待どおりに適用されるようになりました。 新しい `Subtotal (Incl. Tax)` オプションが買い物かご価格ルール条件として追加されました。

<!-- MC-37884-->

* GraphQL を使用したクーポンでの価格ルールの適用が、 **買い物かご全体の固定金額の割引** アクションが使用されます。

### カタログ

<!-- MC-34100-->

* これで、再有効化されたすべての製品が期待どおりにストアフロントに表示されます。 以前は、製品を無効にしてから再度有効にした場合、製品を再度有効にした後にページキャッシュが無効化されなかったため、Vanish ページのキャッシュがクリアされるか、ストアが再びインデックスされるまで、アプリケーションは製品を表示しませんでした。

<!-- MC-37745-->

* 大きなカタログの部分的なインデックス再作成が、期待どおりに動作するようになりました。 以前は、 `catalogsearch_fulltext` 部分的なインデクサーです。

<!-- MC-35123-->

* 買い物客は、カスタマイズ可能なオプションを指定して、期待どおりに商品の請求済み注文を並べ替えることができるようになりました。 以前は、買い物客が再注文しようとすると、アプリケーションは次のエラーをスローしていました。 `{"0":"The product's required option(s) weren't entered. Make sure the options are entered and try again`.

<!-- MC-35212-->

* これで、 **レイアウト** 設定を **レイアウトを更新しません**. 以前は、 **カテゴリ — 全幅** : **レイアウトを更新しません** の値です。

<!-- MC-35490-->

* ストアフロントでの製品の並べ替え順に関する問題が解決されました。 以前は、アプリケーションが製品の価格をインデックス付けする際に、設定可能な製品の `min_price` および `max_price` 0 に `catalog_product_index_price` ストアフロントの価格の並べ替え順に影響するテーブル。

<!-- MC-35608-->

* ラベル付けされた属性が正常に更新されるようになりました。 `Product Type`. 以前は、 `product_type` 属性がコード内で予約されている場合、アプリケーションは、 `Product Type` 属性： `An attribute with the same code (product_type) already exists.`

<!-- MC-36214-->

* 製品を保存する際に、製品の詳細ページの「画像とビデオ」セクションにあるアップロードされたビデオの位置が変更されなくなりました。 以前は、新しい画像の位置にインデックス値（リスト内の位置）が割り当てられていましたが、既存の画像の位置がインデックス値と一致しない場合、新しい画像はリスト内で誤って配置されていました。

<!-- MC-36548-->

* この **買い物かごに追加** 機能は、常に期待どおりに動作するようになりました **買い物かごに追加** ボタン ia をクリックします。 以前は、製品ページの読み込みを待っている間にこのボタンを複数回クリックすると、アプリケーションは次のエラーをスローしていました。 `Invalid Form Key. Please refresh the page`.

<!-- MC-37006 36835-->

* マーチャントがカテゴリに対して無効な製品を追加または削除した場合、アプリケーションはカテゴリキャッシュをフラッシュしなくなりました。 以前は、製品のステータスにかかわらず、アプリケーションは関連カテゴリのキャッシュをフラッシュしていました。 カテゴリの保存時にカテゴリの割り当ても解除され、カテゴリのキャッシュがフラッシュされました。

<!-- MC-37347-->

* 内でのカタログ製品のフィルタリング **すべてのストア表示** 範囲が正しく機能するようになりました。 以前は、ステータスが「 `Enabled` または `Disabled` がグリッドに表示される問題を修正しました。

<!-- MC-38038-->

* 部分的なインデックス再作成によって、製品や空のカテゴリが見つからなくなりました。

<!-- MC-38315-->

* 並べ替えが、次の場合に期待どおりに動作するようになりました **JavaScript カレンダーを使用** が有効 (**ストア** > **設定** > **カタログ** > **日付と時間のカスタムオプション**) をクリックします。 以前は、この設定が有効になっている場合、以前に配置された注文を管理者から並べ替えようとすると、アプリケーションで次のエラーが表示されていました。 `Please specify date required option(s)`.

<!-- MC-38719-->

* 階層価格の作成中に、マルチサイトデプロイメントでアプリケーションに正しい通貨が表示されるようになりました。

<!-- MC-38914-->

* 製品画像のカスタム属性が正しくエスケープされるようになりました。 この `data-src` 属性の値が `src` 属性を指定します。 以前は、URL の特殊記号はエスケープされていました。

<!-- MC-37665-->

* REST API を使用してカテゴリを更新しても、 **デフォルト値を使用** を設定します。

<!-- MC-36832-->

* 管理者からカテゴリ権限を有効にしても、カテゴリページへの繰り返し訪問中に、カテゴリページをフルページキャッシュにキャッシュできなくなりました。 以前は、ページへの以降の訪問はキャッシュから期待どおりに提供されず、パフォーマンスが低下していました。

<!-- MC-35363-->

* カテゴリを保存すると、このカテゴリに関連するブロックキャッシュのみがフラッシュされるようになりました。 以前は、アプリケーションは、すべてのカテゴリブロックのキャッシュをフラッシュしていました。

<!-- MC-30626-->

* パーセント価格のカスタムオプションの価格が、マルチストアデプロイメントでのアクティブなストアの基本通貨に期待どおりに変換されるようになりました。 以前は、パーセント価格のカスタムオプションの価格が正しく変換されていませんでした。 [GitHub-26432](https://github.com/magento/magento2/issues/26432)

<!-- MC-38890-->

* アプリケーションは画像を正常に再作成するようになりました。これらの画像は、商人がPOSTを使用してメディアギャラリーデータを送信した場合は常に、想定どおりに管理者に表示されます `rest/all/V1/products`. 以前は、アプリケーションは画像を再作成しましたが、マーチャントがPOST経由でメディアギャラリーデータを送信すると、画像を削除しました `rest/all/V1/products` 画像が `pub/media` しかし、メディアにはまだこれらの画像に関する記録が残っていました。 その結果、商人は更新プロセス中に画像が作成および削除されたので、管理でプレースホルダーのみを見つけました。

<!-- MC-36903-->

* Web サイトから項目の割り当てを解除すると、レコードが期待どおりに削除されるようになりました。 以前は、画像の複製時にPOST `rest/all/V1/products` が実行されました。

<!-- MC-38413-->

* この `/V1/categories/{categoryId}/products` を呼び出すと、親カテゴリに属するすべての製品のリストが期待どおりに返されるようになりました。 以前は、製品が親カテゴリの複数のサブカテゴリに属していた場合、アプリケーションは次のタイプのエラーをスローしていました。 `Internal Error. Details are available in the application log file. Report ID: webapi-5f8579e37db54`.  [GitHub-30461](https://github.com/magento/magento2/issues/30461)

<!-- MC-32996-->

* この `/V1/products/attributes/:attributeCode/options` REST エンドポイントで、既存の属性オプションの更新がサポートされるようになりました。

<!-- MC-30626 ENGCOM-8475-->

* パーセント価格のカスタムオプションの価格が、マルチストアデプロイメントでのアクティブなストアの基本通貨に期待どおりに変換されるようになりました。 以前は、パーセント価格のカスタムオプションの価格が正しく変換されていませんでした。 [GitHub-26432](https://github.com/magento/magento2/issues/26432)

<!-- ENGCOM-8395 -->

* 商人は、製品の作成時に新しい属性を正常に保存できるようになりました。 以前は、属性を保存しようとした際に、アプリケーションが属性を保存せず、マーチャントがストアビューのホームページにリダイレクトされていました。 [GitHub-30362](https://github.com/magento/magento2/issues/30362)

<!-- ENGCOM-7997 -->

* 上の製品グリッド **セールス** > **注文** および **カタログ** > **製品** ページには、最近作成されたストアだけでなく、関連するすべてのストアが一覧表示されるようになりました。 [GitHub-29267](https://github.com/magento/magento2/issues/29267)

<!-- ENGCOM-6698 -->

* 製品リポジトリが `store_id` 既存の製品の属性値を保存できる場合。  以前は、製品リポジトリクラスは製品ストア ID を上書きし、常にデフォルトのストア ID を割り当てていました。 [GitHub-29933](https://github.com/magento/magento2/issues/29933)

### カタログルール

<!-- MC-35065-->

* 製品の詳細ページのカスタムオプションで、カタログ価格ルールが期待どおりに機能するようになりました。 以前は、このページの製品価格には、該当するカタログ価格ルールが反映されていませんでした。 [GitHub-22856](https://github.com/magento/magento2/issues/22856)

<!-- MC-34265-->

* 製品キャッシュとカタログキャッシュが、スケジュールに従って期限切れになりました。 以前は、期限切れのキャッシュは、 `сron` 走った `catalogrule_apply_all` 1 日に 1 回のタスク。すべてのカタログルールと依存インデクサーのインデックスを再作成し、すべての製品とカテゴリのキャッシュをクリアします。

### クリーンアップ

#### 誤字および文法的なクリーンアップ

<!-- ENGCOM-7967 -->

* 正確性を考慮して、注文失敗ページのタイトルが修正されました。 以前は、このページのタイトルは次のようになっていました。 **ご注文を受け取りました！**.  [GitHub-29416](https://github.com/magento/magento2/issues/29416)

<!-- ENGCOM-8101 -->

* 内の不要なスペースを削除しました。 `app/code/Magento/Contact/view/frontend/templates/form.phtml`. [GitHub-29779](https://github.com/magento/magento2/issues/29779)

<!-- ENGCOM-7716 -->

* ヘルプメッセージの誤植を修正し、 `bin/magento/setup:config:set` サブコマンド。 [GitHub-28802](https://github.com/magento/magento2/issues/28802)

<!-- ENGCOM-8058 -->

* PHPDoc の文法を `framework/Registry.php` ファイル。 [GitHub-29661](https://github.com/magento/magento2/issues/29661)

<!-- ENGCOM-8273 -->

* 不要な空白をから削除しました `app/code/Magento/Catalog/Helper/Product/View.php`. [GitHub-30601](https://github.com/magento/magento2/issues/30601)

<!-- ENGCOM-8181 -->

* で関数名の誤植を修正しました。 `app/code/Magento/Ui/view/base/web/js/form/element/ui-select.js`. [GitHub-29987](https://github.com/magento/magento2/issues/29987)

<!-- ENGCOM-8478 -->

* ミニ買い物かごとチェックアウト注文の概要の「項目」の複数化を修正しました。 [GitHub-29920](https://github.com/magento/magento2/issues/29920)

<!-- ENGCOM-8309 -->

* マークアップレイヤーナビゲーションフィルター内のインライン要素に空白が含まれていなかった問題を修正しました。 [GitHub-30448](https://github.com/magento/magento2/issues/30448)

<!-- ENGCOM-8056 -->

* `rl` は次の値に修正されました： `url` in  `\Magento\Framework\Filter\Template\Tokenizer\Parameter`.  [GitHub-29185 ](https://github.com/magento/magento2/issues/29185)

#### コードのクリーンアップ

<!-- MC-37922-->

* 不要なHTML `<br>` タグが  **システム**  >  **インポート** ページ。

<!-- ENGCOM-8028 -->

* `ChangeQuoteControl` がリファクタリングされました。 [GitHub-29673](https://github.com/magento/magento2/issues/29673)

<!-- ENGCOM-8027 -->

* `AccessChangeQuoteControl` また、単体テストもリファクタリングされています。 [GitHub-29672](https://github.com/magento/magento2/issues/29672)

<!-- ENGCOM-8053 -->

* 戻り値の型宣言のコードスタイルを修正しました。 `app/code/Magento/Captcha/CustomerData/Captcha.php`. [GitHub-29712](https://github.com/magento/magento2/issues/29712)

<!-- ENGCOM-8288 -->

* 「新規属性」ページでのボタンリストの位置を修正しました。

<!-- ENGCOM-8315 -->

* フロントエンドに適したブロッククラスを追加しました。 `viewModel` の参照例 `\Magento\Framework\View\Element\Template` クラス。 [GitHub-30450](https://github.com/magento/magento2/issues/30450)

<!-- ENGCOM-8090 -->

* 「販売ルール」フォーム内の重複したフィールドセットが削除されました。 [GitHub-29599](https://github.com/magento/magento2/issues/29599)

<!-- ENGCOM-8448 -->

* 不要なコードが `hierarchy/edit.phtml` テンプレート。

<!-- ENGCOM-8446 -->

* で PHPdoc コメントを修正しました。 `app/code/Magento/CatalogImportExport/Model/Export/Product.php`. [GitHub-30833](https://github.com/magento/magento2/issues/30833)

<!-- ENGCOM-8277 -->

* のドキュメントブロック注釈 `PublisherInterface` メッセージが修正されました。 [GitHub-30190](https://github.com/magento/magento2/issues/30190)

<!-- ENGCOM-8264 -->

* 修正された引数 `getStatusByState` メソッド。 [GitHub-30173](https://github.com/magento/magento2/issues/30173)

<!-- ENGCOM-8235 -->

* で修正されたメソッドの説明 `app/code/Magento/Quote/Model/Cart/Totals/ItemConverter.php`. [GitHub-30125](https://github.com/magento/magento2/issues/30125)

<!-- ENGCOM-8242 -->

* 複数のファイルの同じ行にある冗長な変数の割り当てを削除しました。 [GitHub-30133](https://github.com/magento/magento2/issues/30133)

<!-- ENGCOM-8263 -->

* 変更済み `@param string $attribute` から `@param AbstractAttribute|string[]|string $attribute` in `EntityAbstract.php`. [GitHub-30191](https://github.com/magento/magento2/issues/30191)

<!-- ENGCOM-8142 -->

* 無効なタグ ( 例： `@package` および `@subpackage`) は、コードベース全体で docblock から削除されました。 [GitHub-30061](https://github.com/magento/magento2/issues/30061)

<!-- ENGCOM-8117 -->

* の構文内の未使用のパラメーター `AdvancedPricing` クラスが削除されました。 [GitHub-29531](https://github.com/magento/magento2/issues/29531)

### 設定可能な製品

<!-- MC-35016-->

* 在庫切れの設定可能な製品を価格でフィルタリングすると、正しい価格範囲の結果が表示されるようになりました。

<!-- MC-38930-->

* ステータスが「有効」から「無効」に変わった場合（またはその逆の場合）、仮想製品のタイプが変更されなくなりました。 以前は、アプリケーションのステータスが変更されると、製品のタイプが仮想からシンプルに変更されていました。

<!-- MC-38197-->

* この `getValue()` メソッドでは、買い物かごの更新時に致命的なエラーがトリガーされなくなりました。

<!-- MC-34444-->

* 複数の Web サイトで使用可能な設定可能な製品では、特定の Web サイトに割り当てられていない単純な子製品が表示されなくなりました。 [GitHub-28291](https://github.com/magento/magento2/issues/28291)

<!-- ENGCOM-8202 -->

* ストアフロントの製品ページに、税が想定どおりに含まれない階層価格が表示されるようになりました。 [GitHub-12225](https://github.com/magento/magento2/issues/12225)

<!-- ENGCOM-8134 8174-->

* 設定可能な製品の MSRP 価格が、選択された通貨に正しく変換されるようになりました。 以前は、アプリケーションが間違った通貨で価格を表示し、次のエラーをスローしていました。  `Call to a member function setAppliedTaxes() on null`. [GitHub-26526](https://github.com/magento/magento2/issues/26526), [GitHub-29603](https://github.com/magento/magento2/issues/29603)

<!-- ENGCOM-8234 -->

* マーチャントは、0（ゼロ）の値を持つ店舗固有のテキストスウォッチ属性オプションラベルを保存できるようになりました。 以前は、値 0 は管理ラベルオプション値に置き換えられていました。 [GitHub-30073](https://github.com/magento/magento2/issues/30073)

<!-- ENGCOM-8117 -->

* の構文内の未使用のパラメーター `AdvancedPricing` クラスが削除されました。 [GitHub-29531](https://github.com/magento/magento2/issues/29531)

### cron

<!-- MC-37712-->

* システムメッセージリストに、製品のアップデートが正確に反映されるようになりました。 `cron` が実行され、アプリケーションが製品をスケジュールどおりに更新しました。

<!-- ENGCOM-8164 -->

* に基づくインデックス `schedule_id` および `status` が `cron_schedule` 表。 [GitHub-29601](https://github.com/magento/magento2/issues/29601)

### カスタム顧客属性

<!-- MC-23545-->

* アプリケーションにタイプの顧客属性が表示されるようになりました `file` をクリックします。 以前は、このタイプの新しい属性を保存しようとすると、次のエラーが表示されていました。 `The "newAttribute" attribute value is empty. Set the attribute and try again` および `Validation is failed`.

<!-- MC-23544-->

* 複数行のカスタム顧客属性値が正しく表示されるようになりました。 以前は、すべてのデータが表示されていませんでした。

<!-- MC-36978-->

* アカウントの作成時に無効な生年月日を入力したときに買い物客にアラートが表示されるようになりました。 以前は、ロケール設定が無視され、買い物客は無効な日付エラーで新しい顧客アカウントを作成ページにリダイレクトされていました。

<!-- MC-38846-->

* カスタム住所属性が、チェックアウトワークフローの支払い手順に期待どおりに含まれるようになりました。

<!-- MC-38114-->

* 複数選択のカスタムアドレス属性が、ゲストのチェックアウト時、および管理者とアカウントの注文の詳細ページに正しく表示されるようになりました。

<!-- MC-37581-->

* 「マイアカウント」領域と「管理者の注文の詳細」ページに、カスタム住所属性が正しく表示されるようになりました。

<!-- MC-37101-->

* カスタム顧客属性で、 `Input Type` が `Text` および `Input Validation` が `Numeric Only`.

<!-- MC-36721-->

* これで、カスタム性別属性値を含む顧客データが正常に書き出されました。

<!-- MC-34650-->

* B2B ユーザーのカスタム顧客属性値が期待どおりに保存されるようになりました。 以前は、会社ユーザーを追加または編集するために作成されたカスタム顧客属性は、新しいユーザーを追加フォームに結び付けられず、その結果、属性値は保存されませんでした。 また、カスタムの日付属性は、データベースから文字列として取得されたので、ストアフロント表示用の適切な日付形式に変換されませんでした。

### 顧客

<!-- MC-35771-->

* 生年月日フィールドのストアフロント顧客アカウントページ日付のカレンダーウィジェットで、指定されたストアのロケールが使用されるようになりました。

<!-- MC-38498-->

* 管理者からの既存の顧客の注文の再注文のチェックアウト中に、顧客アドレスの重複エントリが保存されなくなりました。

<!-- MC-37393-->

* 複数の顧客からすべての住所を管理者から削除すると、顧客住所リストからすべての住所が削除され、デフォルトの請求先住所と配送先住所が削除されるようになりました。 以前は、顧客の住所リストから住所が削除されましたが、デフォルトの請求先住所と配送先住所は削除されませんでした。

<!-- MC-37377-->

* 管理者がアドレスの一括削除を実行した後、「管理者のお客様の住所」タブに住所数が正しく表示されるようになりました。 以前は、削除されたアドレスがアプリケーションの数に含まれていました。

<!-- MC-36718-->

* の DateTime 形式 **生年月日** 顧客登録ページのフィールドが修正されました。 以前は、1 桁の日の前にある先頭のゼロが見つかりませんでした。

<!-- MC-36024-->

* の日付形式の検証 **生年月日** 買い物客が **アカウントの作成** 」ボタンをクリックします。 以前は、買い物客が無効な形式で値を入力した場合は、 **アカウントの作成** 」ボタンが表示されない場合、買い物客は、日付エラーが無効な新しい顧客アカウントを作成ページにリダイレクトされていました。

<!-- MC-33867-->

* 管理者が属性の無効なデータを含む新しい顧客アカウントを保存しようとした際に、アプリケーションが致命的なエラーをスローしなくなりました。

<!-- MC-36258-->

* Magento Shippingが以前にインストールされ、デフォルトの Luma テーマが現在デプロイされているデプロイメントで、顧客が買い物かごにアクセスしようとしたときに、アプリケーションが 400 エラーをスローしなくなりました。 以前は、サーバーにリクエストを送信する前に、管理でサポートされていない、以前にインストールまたは有効にしたモジュールで作成されたセクション名が、アプリケーションで除外されなかったので、エラーが発生しました。

<!-- MC-35812-->

* 現在は、買い物客がゲストアカウントを作成したときに、 **メールの確認が必要** 設定が有効で、 `Magento\Customer\Controller\Account\CreatePost` が上書きされました。 以前は、アプリケーションではこのタイプのユーザー登録プロセスのカスタマイズが許可されず、この状態で、ユーザーの E メール確認ステータスが完了したと見なされ、新しいユーザーが自動的にログインし、エラーメッセージは表示されませんでした。

<!-- ENGCOM-8039 -->

* 現在は、買い物客がデフォルト以外の顧客グループを持つ注文をストアに配置する際に、アプリケーションは買い物客を正しい顧客グループに割り当てます ( **顧客グループへの自動割り当ての有効化** が有効になっている。 [GitHub-26976](https://github.com/magento/magento2/issues/26976)

<!-- MC-39783-->

* インデックスが **スケジュール別に更新**. 以前は、アプリケーションはグリッドを表示せず、次のエラーをスローしていました。  `[2020-12-09 11:31:54] report.CRITICAL: The website with id 2 that was requested wasn't found. Verify the website and try again. \{"exception":"[object] (Magento\\Framework\\Exception\\NoSuchEntityException(code: 0): The website with id 2 that was requested wasn't found. Verify the website and try again. at /var/www/html/magento24ee/vendor/magento/module-store/Model/WebsiteRepository.php:110)"}`

### dotdigital

* DotDigital Engagement Cloud からプログラムのリストを取得する際のエラー処理を改善しました。

* ゲスト同期中にストア名列で同期された値が、期待どおりにストアビュー名になりました。 以前は、Web サイト名はこの列に含まれていました。

* オーダーの保存後に、オーダーステータスの自動化をループする前の配列チェックが追加されました。

* DotDigital モジュールの依存関係に起因する Composer のアップグレードの問題を解決しました。 `magento/module-authorization`.

### ダウンロード可能

<!-- ENGCOM-7679 -->

* ダウンロード可能な製品が部分的に払い戻された後、アプリケーションがダウンロード可能な製品を [ マイダウンロード ] タブにリストしなくなりました。 [GitHub-28388](https://github.com/magento/magento2/issues/28388)

### ダイナミックブロック（旧バナー）

<!-- MC-23938-->

* ブロックに関連付けられている顧客セグメントを削除すると、ストアフロントに動的ブロックは表示されなくなります。

<!-- MC-37322-->

* 動的ブロックを表示するかどうかを決定する際に、アプリケーションでカタログ価格ルールが正しく考慮されるようになりました。

### 房室

<!-- MC-35934-->

* カスタム属性 `\Magento\Eav\Model\Entity\Attribute\Backend\ArrayBackend` 製品が API 呼び出しで作成されたときにペイロードに値が指定されない場合、デフォルト値を使用するようになりました。

### 電子メール

<!-- ENGCOM-7961 -->

* `\Magento\Config\Model\Config\Source\Email\Template::toOptionArray` が `setPath()` が次の値より前に呼び出されていません： `toOptionArray()`. [GitHub-29315](https://github.com/magento/magento2/issues/29315)

<!-- MC-36777-->

* クリックしたときに、アプリケーションがプレーンテキストをHTMLに正しく変換するようになりました。 **Html バージョンを返す** 電子メールテンプレートの読み込み時。

<!-- MC-34803-->

* 一部の請求書を含む顧客に送信された E メールに、正確な品目の小計が含まれるようになりました。 以前は、この E メールの小計は、請求済数量の合計金額ではなく、注文済数量の合計でした。

<!-- MC-38337-->

* 有効な電子メールアドレスを持つすべての関連顧客に、電子メールリマインダーを送信するようになりました。 以前は、1 つの無効なアドレスに遭遇した顧客へのリマインダー E メールの送信が停止されていました。

<!-- ENGCOM-7517 -->

* 製品がカタログから削除された後、非同期モードでの販売メールの送信が期待どおりに動作するようになりました。 以前は、非同期の E メール送信がブロックされ、アプリケーションで次のエラーが表示されていました。  `main.ERROR: Cron Job sales_send_order_invoice_emails has an error: Call to a member function getData() on null. Statistics: {"sum":0,"count":1,"realmem":0,"emalloc":0,"realmem_start":73400320,"emalloc_start":37177640} [] []main.CRITICAL: Error when running a cron job {"exception":"[object] (RuntimeException(code: 0): Error when running a cron job at /var/www/html/vendor/magento/module-cron/Observer/ProcessCronQueueObserver.php:327, Error(code: 0): Call to a member function getData() on null at /var/www/html/vendor/magento/module-catalog/Helper/Image.php:502)"} []`. [GitHub-26878](https://github.com/magento/magento2/issues/26878)

<!-- ENGCOM-8381 -->

* 次の場合、アプリケーションは注文確認 E メールで顧客をコピーしなくなりました： `sales_email/order_comment/enabled` が無効で、 `sales_email/order_comment/copy_method` が `bcc`. [GitHub-29915](https://github.com/magento/magento2/issues/29915)

### フレームワーク

<!-- MC-24195-->

* カスタマイズされたフィルターグループが、顧客の検索時に正しく適用されるようになりました。 以前は、 `afterSearch` 関数は、期待どおりに OR フィルターを実行しませんでした。 [GitHub-24576](https://github.com/magento/magento2/issues/24576)

<!-- MC-36942-->

* ストアのホームページ上の画像が正常にレンダリングされるようになりました。 以前は、画像の base64 コードの 3 つの連続するスラッシュがコメントと誤って解釈されていたので、ページソースHTMLが破損していました。

<!-- MC-37369-->

* アラビア語ロケール (`ar_SA - Saudi Arabia`) をクリックします。

<!-- MC-38344-->

* マーチャントが展開に買い物かご価格ルールを保存した後、DatePicker に正しい日付が表示されるようになりました。 [GitHub-30382](https://github.com/magento/magento2/issues/30382)

<!-- MC-31085-->

* 現在は、アラビア語の千単位区切り文字とアラビア語の小数点区切り文字の記号が正しく表されています。 以前は、アラビア語の記号はトリミングされていました。 [GitHub-26676](https://github.com/magento/magento2/issues/26676)

<!-- MC-30631-->

* アプリケーションは、期限切れのデータベースセッションをデータベースから削除するようになりました `session` テーブルが期待どおりに表示されます。

### 一般的な修正点

<!-- MC-38105-->

* で定義されているハンドラーとは異なるネイティブセッションハンドラーを設定できるようになりました。 `php.ini`. 以前は、 `SessionManager` memcache を次のように設定しませんでした： `save_handler`を使用していた場合、その代わりにファイルの `session_handler`. アプリケーションが次のエラーをスローしました： `main.CRITICAL: Warning: SessionHandler::read(): open(127.0.0.1:11211/sess_0imeeaqmnvemdg4e3h57tat0ik, O_RDWR) failed: No such file or directory (2) in../vendor/magento/framework/Session/SaveHandler/Native.php on line 22 {"exception":"[object] (Exception(code: 0): Warning: SessionHandler::read(): open(127.0.0.1:11211/sess_0imeeaqmnvemdg4e3h57tat0ik, O_RDWR) failed: No such file or directory (2) in ../vendor/magento/framework/Session/SaveHandler/Native.php on line 22 at ../vendor/magento/framework/App/ErrorHandler.php:61)"}`. [GitHub-24717](https://github.com/magento/magento2/issues/24717)

<!-- ENGCOM-8052 -->

* に対して、次の改善がおこなわれました。 `LoginAsCustomer` モジュール：

   * 次を `around` ～とのプラグイン `after`

   * 冗長コードを削除

   * 置換済み `(bool)->getValue()` と `isSetFlag`. [GitHub-29689](https://github.com/magento/magento2/issues/29689)

<!-- ENGCOM-8093 -->

* すべての顧客データセクションをワイルドカード (*) で再読み込みしても、リクエストが `customer/section/load` 400 エラーをスローする [GitHub-28154](https://github.com/magento/magento2/issues/28154)

<!-- ENGCOM-7994 -->

* レイアウトが実稼働モードでレンダリングされたときに発生する例外をに渡すようになりました。 `var/report`. [GitHub-29606](https://github.com/magento/magento2/issues/29606)

<!-- MC-38587-->

* ストアビューを変更する際に、顧客がホームページにリダイレクトされなくなりました。 この `\Magento\VersionsCmsUrlRewrite\Model\StoreSwitcher::switch()` メソッドで、 `$urlPath` は、2 番目のストア表示で見つかりません。

<!-- ENGCOM-7527 -->

* 存在しない顧客がパスワードのリセットをリクエストすると、アプリケーションで例外がスローされるようになりました。 [GitHub-26288](https://github.com/magento/magento2/issues/26288)

<!-- MC-33687 ENGCOM-8497-->

* この属性値が含まれるファイルをアップロードする際に、管理者が顧客属性に対する無効な値を含む顧客アカウントを保存しようとすると、情報エラーメッセージが表示されるようになりました。 以前は、アプリケーションは致命的なエラーをスローしていました。 [GitHub-30295](https://github.com/magento/magento2/issues/30295)

<!-- ENGCOM-8400 -->

* アプリケーションが **HTML印刷表示のロゴ** 設定を設定して、期待どおりに前面の請求書PDFを保存します。 [GitHub-24730](https://github.com/magento/magento2/issues/24730)

<!-- ENGCOM-8425 -->

* `static::` は、 `self::` を介してプライベート定数にアクセスする。 [GitHub-30781](https://github.com/magento/magento2/issues/30781)

<!-- ENGCOM-8395 -->

* 商人が **新しい属性を作成** ボタンを 2 回クリックします。 以前は、アプリケーションで空のページが表示され、エラーがスローされていました。 [GitHub-30361](https://github.com/magento/magento2/issues/30361)

<!-- ENGCOM-8426 -->

* アプリケーションに「 `The coupon code has been accepted` クーポンが削除された後のメッセージ。 [GitHub-30255](https://github.com/magento/magento2/issues/30255)

<!-- ENGCOM-8396 -->

* 管理者は、特定のカテゴリにウィジェットを割り当てることができるようになりました。 [GitHub-30009](https://github.com/magento/magento2/issues/30009)

<!-- ENGCOM-8216 -->

* 属性セレクター `input[type=datetime]` は、より具体的でない入力タイプセレクターに置き換えられました。 [GitHub-30064](https://github.com/magento/magento2/issues/30064)

<!-- ENGCOM-8282 -->

* カスタムカテゴリ属性に関連付けられたストア固有の値が期待どおりに表示されるようになりました。 [GitHub-13440](https://github.com/magento/magento2/issues/13440)

<!-- ENGCOM-8287 -->

* これで、 **VAT 番号の検証** ボタンをクリックします。 [GitHub-29652](https://github.com/magento/magento2/issues/29652)

<!-- ENGCOM-8031 -->

* この `\Magento\Catalog\Model\ImageUploader` 新しい `moveFileFromTmp`  メソッド。 [GitHub-29598](https://github.com/magento/magento2/issues/29598)

<!-- ENGCOM-8178 -->

* マーチャントが `product_type` および `type_id` コードがわかりやすくなります。 [GitHub-28479](https://github.com/magento/magento2/issues/28479)

<!-- ENGCOM-8135 -->

* 次の項目の検証ロジックを修正しました： **顧客トークンの有効期間（時間）**  および **管理トークンの有効期間（時間）** 管理者のフィールド **ストア**  >  **設定** >  **サービス**  > **OAuth** ページ。 [GitHub-29502](https://github.com/magento/magento2/issues/29502)

<!-- ENGCOM-8132 -->

* 現在は、 `}}` をクリックします。 [GitHub-12087](https://github.com/magento/magento2/issues/12087)

<!-- ENGCOM-8098 -->

* 製品カテゴリページからフィルターを削除できるようになりました。 以前は、フィルターを削除しようとした際に、アプリケーションはフィルターを削除できず、次のエラーを表示していました。  `Something went wrong`. [GitHub-8538](https://github.com/magento/magento2/issues/8538)

<!-- ENGCOM-8050 -->

* `Magento\Framework\MessageQueue\ConfigInterface` オプションのモジュールでインスタンス化できるようになりました `Magento_MessageQueue` は無効です。 以前は、アプリケーションは次のエラーをスローしていました： `PHP Fatal error:  Uncaught Error: Cannot instantiate interface Magento\Framework\MessageQueue\ConfigInterface in /var/www/magento2/magento2/lib/internal/Magento/Framework/ObjectManager/Factory/AbstractFactory.php:121`. [GitHub-26080](https://github.com/magento/magento2/issues/26080)

<!-- ENGCOM-7312 -->

* アプリケーションが永続ストレージから E メール値を取得できるタイミングを決定するロジックが改善されました。 以前は、電子メールフィールドに入力した後、未登録のユーザーがチェックアウトページに戻ると、アプリケーションがチェックアウトページに入力されたパスワードフィールドを表示していました。 [GitHub-26903](https://github.com/magento/magento2/issues/26903)

<!-- ENGCOM-7777 -->

* 見つからない `aclResource` 属性が管理ヘッダーに追加されました `AdminNotification` ツールバーブロック 以前は、管理者ユーザーが表示する役割リソース権限を持っていない場合でも、管理者通知ツールバーエントリが表示されていました。 [GitHub-29067](https://github.com/magento/magento2/issues/29067)

<!-- ENGCOM-8022 -->

* この `framework/database/select` `where` 関数は現在 `type` 正しく。 [GitHub-29590](https://github.com/magento/magento2/issues/29590)

<!-- ENGCOM-8260 -->

* の非効率的な使用 `array_merge` コードベース全体で in ループが改善され、静的コンテンツデプロイメントプロセスを含め、複数の場所でパフォーマンスが向上しました。 [GitHub-30183](https://github.com/magento/magento2/issues/30183)

<!-- ENGCOM-8445 -->

* デフォルトの管理者セッションの有効期間が、暗号化モジュールからセキュリティモジュールに移動されました。 [GitHub-30859](https://github.com/magento/magento2/issues/30859)

<!-- ENGCOM-8425 -->

* クラス内のプライベート定数を確認し、存在する場合は警告を表示するようになりました `static::` を呼び出します。 以前は、アプリケーションは次のエラーをスローしていました： `Undefined class constant`.

<!-- ENGCOM-8219 -->

* にルールを追加しました。 `editorconfig` を使用して、JSON ファイルと YAML ファイルのインデントを 2 つのスペースでサポートします。 [GitHub-30066](https://github.com/magento/magento2/issues/30066), [GitHub-30063](https://github.com/magento/magento2/issues/30063)

<!-- ENGCOM-8079 -->

* この `FlushCacheByTags` クラスが、プラグインの代わりに after-plug-ins を使用するように更新されました。 [GitHub-29558](https://github.com/magento/magento2/issues/29558)

<!-- ENGCOM-8358 -->

* `MessageValidator` を含まないハッシュ配列では失敗しなくなりました。 `0` 要素。 [GitHub-30563](https://github.com/magento/magento2/issues/30563)

<!-- ENGCOM-8370 -->

* 内の `checkout_index_index.xml` ファイルは `sortOrder` から `messages`, `authentication`, `progressBar`, `estimation`、および `sidebar checkout` コンポーネント。 [GitHub-30550](https://github.com/magento/magento2/issues/30550)

<!-- ENGCOM-8379 -->

* コンテンツ `calc` はエスケープされ、正しい結果が得られます。 `calc` の値を指定します。 以前は、アプリケーションが誤った `calc` の値です。 [GitHub-30542](https://github.com/magento/magento2/issues/30542)

<!-- ENGCOM-8030 -->

* URL 書き換えジェネレーターがカテゴリオブジェクトを設定するようになりました。 `url_key`, `url_path`、および  `store_id` をデフォルトのストア値に変更します。 以前は保存されていました `url_key`, `url_path`、および `store_id` を、最後に処理したストア ID の値に置き換えます。 [GitHub-29585](https://github.com/magento/magento2/issues/29585)

<!-- ENGCOM-8250 -->

* `\Magento\Widget\Controller\Adminhtml\Widget\Instance\Validate` では、フレーズ結果値をエラーメッセージとして認識し、ウィジェットの検証中にユーザーに出力します。 [GitHub-27397](https://github.com/magento/magento2/issues/27397)

<!-- ENGCOM-8311 -->

* のカテゴリ属性のハードコードされたリスト  `Magento\Catalog\Model\Category\DataProvider::getFieldsMap()` は、キャッシュから生成された属性のリストに置き換えられました。 [GitHub-13440](https://github.com/magento/magento2/issues/13440)

<!-- ENGCOM-7759 -->

* の冗長ハッシュ `req.http.host/client.ip` は削除され、ハッシュは Vanrish 組み込み VCL によって処理されます。 [GitHub-29988](https://github.com/magento/magento2/issues/29988)

<!-- ENGCOM-8302 -->

* の `Magento_Ui` ファイルアップローダ。 [GitHub-29557](https://github.com/magento/magento2/issues/29557)

<!-- ENGCOM-8405 -->

* An `acl.xml` ～が起こった不整合 `Magento_LoginAsCustomerAssistance` は有効ですが `Magento_LoginAsCustomerAdminUi` または `Magento_LoginAsCustomerLog` が無効になっている場合は修正されました。 以前は、これらの資格情報を持つ管理者が管理者にログインしようとすると、アプリケーションで空白のページが表示され、次の場合にこのエラーがスローされていました。  `Exception #0 (LogicException): Could not create an acl object: Invalid Document Element 'resource': The attribute 'title' is required but missing. Line: 13`. [GitHub-30680](https://github.com/magento/magento2/issues/30680)

<!-- ENGCOM-8157 -->

* アプリケーションで `Undefined class constant` エラー： `Interceptor` は、プラグインの作成中に生成されます。 [GitHub-28981](https://github.com/magento/magento2/issues/28981), [GitHub-29879](https://github.com/magento/magento2/issues/29879)

<!-- ENGCOM-8108 -->

* 非同期一括操作のメッセージングとログが正しく処理されるようになりました。 以前は、製品は更新されていましたが、 `magento_operation` および `queue_message_status` テーブルが正しく更新されず、システムメッセージが正しく表示されませんでした。 [GitHub-29718](https://github.com/magento/magento2/issues/29718)

<!-- ENGCOM-8388 -->

* クリック時に、新しいパスワードを設定ページが期待どおりにリダイレクトされるようになりました。 **新しいパスワードの設定** (「パスワードのリセット」電子メールの **メールの確認が必要** はストアに対して有効になっています。 以前は、買い物客は **パスワードを忘れた場合** 」ボタンをクリックします。 [GitHub-27954](https://github.com/magento/magento2/issues/27954)

<!-- ENGCOM-8337 -->

* デフォルト値で行システムの設定を保存する際に、配列を文字列変換エラーに修正しました。 [GitHub-30314](https://github.com/magento/magento2/issues/30314)

<!-- ENGCOM-8440 -->

* メッセージキューの引数を設定できるようになりました。 [GitHub-30216](https://github.com/magento/magento2/issues/30216)

<!-- ENGCOM-8384 -->

* ベースファイルコレクターが `AppState->emulateAreaCode()`. [GitHub-39656](https://github.com/magento/magento2/issues/29656)

<!-- ENGCOM-8441 -->

* 新しい `BlockByIdentifier` クラスは、CMS ブロック識別子に基づくレイアウトブロックの取得をサポートします。 その結果、CMS ブロックがキャッシュから削除されると、アプリケーションはレイアウトブロックキャッシュもクリアします。 [GitHub-28309](https://github.com/magento/magento2/issues/28309)

<!-- ENGCOM-8385 -->

* キュー内の数値引数の変換に関する問題を修正しました。 以前は、数値を含むキューを宣言した場合 `type` 引数 `queue_topology.xml`の場合、引数の値は文字列にキャストされました。 [GitHub-29615](https://github.com/magento/magento2/issues/29615)

## ギフトカード

<!-- MC-38989-->

* ギフトカードコードを含む電子メールは、 **注文品目の注文時にギフトカードアカウントを作成する** 設定が有効になっています。 以前は、商品の注文時にギフトカードアカウントが生成され、仮想ギフトカードの送信後に例外が発生した場合、ギフトカードコードが再利用され、異なる顧客に送信されていました。

<!-- MC-36496-->

* 申し込みがギフトカードの注文と重複しなくなりました。 以前は、買い物客が 1 枚のギフトカードを注文すると、申込書は 2 つのギフトコードを配信していました。 これは、 `cron` ジョブ `\Magento\GiftCard\Observer\GenerateGiftCardAccountsInvoice::execute()`また、この方法では、請求書の作成時にギフトカードコードが既に生成されているかどうかは確認されませんでした。

<!-- MC-35058-->

* マーチャントは、期待どおりにカテゴリの製品の割り当てを解除できるようになりました。 以前は、アプリケーションは次のエラーと同様のエラーをスローしていました。 `Could not save product "4" with position 0 to category 3`.

<!-- ENGCOM-8326 -->

* シンボリックリンクのサポートを追加 `root` エラーページとメンテナンスモードで使用できます。 以前は、 `root` または `magento/pub` が別のディレクトリにシンボリックリンクされていた場合、エラー・プロセッサ (`Magento\Framework\Error\Processor`) が正しいビューファイル URL を生成しませんでした。 [GitHub-30296](https://github.com/magento/magento2/issues/30296)

<!-- ENGCOM-8087 -->

* 追加された欠落 `order_data` 配列を `EmailSender` クラス。 これにより、これらのクラスがMagentoの推奨と一致し、E メールテンプレート内のオブジェクトの代わりにスカラー変数を使用できます。 [GitHub-29604](https://github.com/magento/magento2/issues/29604)

### Google Tag Manager

<!-- MC-34818-->

* Google Tag Manager `productClick` 関数が期待どおりに動作するようになりました。 以前は、 `productClick` がリストページの製品でトリガーされず、Google Tag Manager がそのイベントをキャプチャできませんでした。

<!-- MC-38781-->

* Google Tag Manager で設定可能な製品オプションを、買い物かごで設定可能な製品オプションを編集した後、データレイヤーで期待どおりに更新するようになりました。 以前は、 `removeFromCart` イベントが製品オプションが変更された際に誤って書き換えられ、数量は同じままでした。

### GraphQL

<!-- MC-37615-->

* この `urlResolver` クエリで、クエリパラメーターが正しく処理されるようになりました。

<!-- ENGCOM-8422 -->

* この `urlResolver` カスタムの CMS ノードとページが入力として指定されている場合に、クエリが NULL を返さなくなりました。 [GitHub-30474](https://github.com/magento/magento2/issues/30474)

<!-- MC-38209 ENGCOM-8386-->

* この `category` クエリが無効になっている親カテゴリの子カテゴリを返さなくなりました。 [GitHub-30468](https://github.com/magento/magento2/issues/30468)

<!-- MC-38407-->

* この `category` URL の書き換えが無効な場合、クエリはカテゴリ画像の正しいパスを返すようになりました。

<!-- MC-36648 8321-->

* この `resetPassword` ミューテーションで、エラーが発生した場合に、より有益なメッセージを返すようになりました。 [GitHub-30179](https://github.com/magento/magento2/issues/30179)

<!-- MC-38078 ENGCOM-8504-->

* のキャッシュされた結果 `products` 製品の位置が変更されると、クエリが期待どおりに無効化されます。 [GitHub-30467](https://github.com/magento/magento2/issues/30467)

<!-- MC-35355 ENGCOM-8404-->

* この `products` クエリで、 `category_id` フィルターが `in` キーワード。 [GitHub-30349](https://github.com/magento/magento2/issues/30349)

<!-- ENGCOM-8373 -->

* この `categories` および `categoryList` クエリでは、カテゴリ権限の設定と親カテゴリ ID に基づいてカテゴリの可用性を考慮するようになりました。 [GitHub-29880](https://github.com/magento/magento2/issues/29880), [GitHub-30624](https://github.com/magento/magento2/issues/30624)

<!-- MC-37603-->

* この `updateProductsInWishList` ミューテーションで、wishlist 項目を適切に検証できるようになりました。 [GitHub-30467](https://github.com/magento/magento2/issues/30467)

<!-- ENGCOM-8430 PWA-1107-->

* のいくつかの属性が非推奨（廃止予定） `ProductInterface` および `CategoryInterface` 店頭での使用を防ぐために。 [GitHub-30625](https://github.com/magento/magento2/issues/30625)

* 価格は、カテゴリ権限で非表示に設定されている場合、製品クエリの結果で非表示になるようになりました。 [GitHub-29926](https://github.com/magento/magento2/issues/29926)

<!-- MC-36898 PWA-1299-->

* これで、 `addProductsToWishList` ミューテーション：ユーザー定義の数量を持つバンドル製品をウィッシュリストに追加する場合。

<!-- MC-36648 -->

* 製品を買い物かごに追加する突然変異が、カタログ権限を保持するようになりました。 [GitHub-30179](https://github.com/magento/magento2/issues/30179)

<!-- MC-36946 -->

* 買い物かごへの追加操作の GraphQL 応答時間が改善されました。

<!-- ENGCOM-8099 -->

* この `products` クエリで、期待どおりに階層価格の値が返されるようになりました。 [GitHub-29168](https://github.com/magento/magento2/issues/29168)

<!-- ENGCOM-7528 -->

* 冗長を削除 `getMappedNums` ～の環から `lib/internal/Magento/Framework/GraphQl/Query/EnumLookup.php`. [GitHub-30031](https://github.com/magento/magento2/issues/30031)

<!-- ENGCOM-8172 -->

* この `products` 問い合わせ対象の製品に無効な関連製品がある場合に、クエリがエラーを返さなくなりました。 [GitHub-28892](https://github.com/magento/magento2/issues/28892)

<!-- MC-37395 -->

* この `cart` クエリで、正しい通貨（デフォルトの表示通貨）に変換された価格が返されるようになりました。 以前は、クエリは品目価格の値を基準通貨で返し、通貨コードはデフォルトの表示通貨として返されていました。

<!-- MC-37388-->

* GraphQL でカタログ権限を使用できるようになりました。 アプリケーションは、 `products` 買い物客の顧客グループに基づくクエリ。

<!-- MC-39690-->

* 追加された `customizable_option` 属性を `CartItemInterface`.

<!-- MC-39744-->

* 追加された属性 `storeConfig` ストア、ストアグループ、web サイトの情報を返すクエリ。

<!-- MC-37414-->

* 回復済み `SelectedCustomizableOption.type` 属性。 また、 `customizable_options` 属性は `CartItemInterface` が null 以外になりました。

<!-- MC-23860-->

* の検索機能 `products` クエリが、カテゴリ権限が有効になっている項目を返さなくなりました。

<!-- MC-37726-->

* この `products` クエリは、複数の通貨を持つストア表示に対して正しい通貨を返します。

<!-- MC-37727-->

* ラベル `products` デフォルト以外のストアビューに該当する場合、クエリフィルターは、翻訳された値を返すようになりました。

<!-- MC-37728-->

* 買い物かご内のギフトカードに保存する通貨額を固定します。

<!-- MC-38443-->

* 追加された `ConfigurableProductOptionsSelection` 製品の選択可能な設定可能なオプションに対応するメタデータを含むデータタイプ。 このオブジェクトを `products` クエリを使用して、買い物客が設定可能な製品オプションを選択する際に表示されるメディアギャラリー項目の数を最小限に抑えます。

### グループ化された製品

<!-- MC-35361-->

* 製品クエリで、グループ化された製品に対して期待されるすべてのデータが返されるようになりました。 以前は、 `product_links` は空の配列です。

<!-- MC-37718-->

* すべての子シンプルな製品が在庫切れの場合、製品編集ページでグループ化された製品が在庫切れとして表示されるようになりました。

<!-- MC-37249-->

* グループ化された製品の子単純製品のステータスが在庫切れに変わった場合、製品編集ページでステータスが正しく更新されるようになりました。 以前は、グループ化された製品の親の在庫品目は、子の在庫ステータスが変更された後、更新されませんでした。

### 画像

<!-- MC-36942-->

* ストアのホームページ上の画像が正常にレンダリングされるようになりました。 以前は、画像の base64 コードの 3 つの連続するスラッシュがコメントと誤って解釈されていたので、ページソースHTMLが破損していました。

<!-- ENGCOM-8116 -->

* 依存関係は `fileinfo` 拡張機能は CMS モジュールから削除されました。 以前は、画像アップローダを使用して画像をアップロードしようとすると、アプリケーションがエラーをスローしていました。このエラーは、「 **画像を挿入** ボタンを使用してコンテンツを追加できます。 [GitHub-24332](https://github.com/magento/magento2/issues/24332), [GitHub-16531](https://github.com/magento/magento2/issues/16531), [GitHub-29852](https://github.com/magento/magento2/issues/29852)

<!-- ENGCOM-8020 -->

* 読み上げのサポートを追加しました `exif_image.png` または `exif-image.jpeg` メタデータ。 [GitHub-1449](https://github.com/magento/adobe-stock-integration/issues/1449)

<!-- MC-37042-->

* 画像は、期待どおりにアップロードした後、カタログイベントカルーセルウィジェットで表示されるようになりました。 以前は、 `catalog_event_status_checker` cron ジョブがアップロードされた画像を削除しました。

<!-- ENGCOM-8296 -->

* CMYK 画像のカラーが正しくレンダリングされるようになりました。 開いた画像が CMYK カラースペースを持つことを Imagick アダプタが検出すると、カラースペースは SRGB に変換されます。 以前は、これらのイメージは反転色でレンダリングされていました。 [GitHub-22375](https://github.com/magento/magento2/issues/22375)

<!-- ENGCOM-8251 -->

* ブール値は `image_with_border.phtml`. 冗長 `max-width` および `height` 設定が次の場所から削除されました： `.product-image-photo`. （これらの値は、リセットスタイルを使用して画像上で既にグローバルに設定されています）。 [GitHub-30186](https://github.com/magento/magento2/issues/30186)

### インポート/エクスポート

<!-- MC-35081-->

* 顧客の住所 `region_id` は現在割り当てられていません `NULL` の値は、CSV ファイル (`entity type = "customer address"` および `import behavior = "add/update"`) をクリックします。

<!-- MC-35295-->

* 読み込み時にストアフロントで製品画像を非表示にできるようになりました。

<!-- MC-35395-->

* CSV ファイルに誤ったエントリも含まれている場合、スケジュールされた製品の読み込みプロセスで、製品が正しいデータフィールドで更新されるようになりました。 以前は、 **エラー時：処理を続行** が有効になっている。

<!-- MC-35836-->

* 読み込んだ製品に `qty` 0 に設定 `is_in_stock set` を 1 に設定した場合、製品はカテゴリページに表示されず、製品の詳細ページでは在庫切れと見なされます。 以前は、これらの値を持つ製品は、読み込み後にストアフロントに表示されていました。

<!-- MC-38433-->

* CSV の読み込みで、 `dropdown` および `textarea` 追加の属性の値。 以前は、これらの属性値は読み込み時に更新されませんでした。

<!-- MC-37933-->

* 製品書き出し CSV ファイルが、書き出し CSV ファイルの管理リストに期待どおりに表示されるようになりました。 以前は、次のコマンドを実行すると、アプリケーションがエラーをスローしていました。 `bin/magento queue:consumers:start exportProcessor --single-thread --max-messages=10000`.

<!-- MC-37672-->

* ベンガル語（バングラ語）のアルファベット文字を含む CSV データを読み込む際に、アプリケーションがエラーをスローしなくなりました。

<!-- MC-36410-->

* 管理者が「 **データを確認** （Chrome でのエクスポート後に変更されたファイルのインポート時） 以前は、コンソールエラーが表示されましたが、続行方法がユーザーに示されていませんでした。

<!-- ENGCOM-8252 -->

* 同じ製品 CSV データを複数回読み込んだ場合、アプリケーションが製品画像を複製しなくなりました。 [GitHub-21885](https://github.com/magento/magento2/issues/21885)

<!-- ENGCOM-8262 -->

* 画像ファイル名の上限は 90 文字で、 `vendor/magento/framework/File/Uploader.php` が削除されました。  以前は、ディレクトリとファイル名の長さが 255 文字を超えることはできませんでした。 アプリケーションは、画像が含まれる製品を読み込み、ファイル名がこの制限を超えていますが、画像ファイルは読み込みませんでした。 [GitHub-29377](https://github.com/magento/magento2/issues/29377)

<!-- ENGCOM-8153 -->

* クーポンコードを CSV または XML に正常に書き出せるようになりました。 以前は、「 **CSV を書き出し** または **XML を書き出し** クーポンを輸出しようとした時 [GitHub-29277](https://github.com/magento/magento2/issues/29277)

<!-- ENGCOM-8252 -->

* 画像を含む CSV ファイルを読み込んだ後、重複した製品画像が削除されるようになりました。 [GitHub-14398](https://github.com/magento/magento2/issues/14398), [GitHub-21885](https://github.com/magento/magento2/issues/21885)

## 索引

<!-- MC-38003-->

* 部分インデクサーのパフォーマンスが向上しました。 ID が 1000 回のバッチ反復ごとに変更されたキャッシュ ID がクリアされるようになりました。 キャッシュコンテキストが ID を蓄積しなくなりました。 以前は、1000 ID バッチ反復ごとにキャッシュコンテキストに蓄積されたキャッシュ ID があり、各反復で同じ ID セットをクリアしていました。

<!-- ENGCOM-7929 -->

* 部分的な再インデックスシステムと完全な再インデックスシステムとの間の不整合を修正しました。 両方のインデックス作成システムで同じコードが使用されるようになり、正しく機能します。 以前は、インデックス作成システムは共有インデクサーに関して異なるロジックを使用していましたが、部分的なインデックス再作成システムを実行するたびにインデクサーが無効になる可能性がありました。 [GitHub-29478](https://github.com/magento/magento2/issues/29478), [GitHub-29297](https://github.com/magento/magento2/issues/29297)

<!-- MC-38168-->

* 手動インデクサーで、カテゴリページが空になるか、カテゴリページでの製品数が減少する問題を解決しました。 不完全なカテゴリページまたは製品数に関する問題が発生したのは、次の場合です。

   * の `catalogsearch_fulltext` および `catalog_product_price` 部分インデクサーは、大きなカタログで、これらのインデクサーの実行が完了するまで実行されました。

   * 部分インデクサーが `catalog_category_product` または `catalog_product_category` インデックスと同時に、1 つのインデックスに対して完全な再インデックスが実行されました。 これら 2 つのインデックス作成プロセスが競合し、製品がカテゴリページに表示されなくなる可能性があります。

   * `bin/magento indexer:reindex inventory` が大きなカタログで実行されました。 が `catalogsearch_fulltext` 部分的なインデクサーの実行が完了しました。

<!-- MC-39700-->

* インデクサーが `Magento_Bulk` MySQL テーブル。一括操作のパフォーマンスが向上しました。

<!-- MC-38806-->

* データベーステーブルのコメントで、インデックス再作成後にテーブルのステータスが正確に反映されるようになりました (`bin/magento indexer:reindex`) をクリックします。 以前は、インデックス再作成後のテーブルコメントには、新規インストール後のコメントと同じ値が含まれていました。

<!-- ENGCOM-7542 -->

* この `SELECT entity_id IN` MariaDB v.10.3.18 を実装するデプロイメントで文が改善され、カタログカテゴリのインデックス作成のパフォーマンスが向上しました。 [GitHub-25199](https://github.com/magento/magento2/issues/25199)

<!-- ENGCOM-8237 -->

* Adobe Commerceでは、インデクサーインスタンスごとに複数回タグをフラッシュするのをなくし、キャッシュパフォーマンスを向上させました。 [GitHub-29890](https://github.com/magento/magento2/issues/29890)

### インフラ

<!-- MC-34353-->

* これで、 `app/etc/env.php` メッセージブローカーを MYSQL から AMQP に変更する場合。

<!-- MC-38242-->

* 関連する JavaScript ライブラリで、製品数量の小数値の残りの計算に関する問題を修正しました。 以前は、2 桁を超える小数部を誤って計算し、その後誤ったメッセージが表示されていました。

<!-- MC-38993 ENGCOM-8473-->

* この `\Magento\Authorization\Model\Rules::update` メソッドは非推奨（廃止予定）となりました。 [GitHub-29128](https://github.com/magento/magento2/issues/29128)

<!-- ENGCOM-8000 -->

* 日付オブジェクトを UTC から変換する際に、アプリケーションが致命的なエラーをスローしなくなりました。 以前は、特定の条件下で、 `convertConfigTimeToUtc` メソッドは例外をスローしました。 [GitHub-29525](https://github.com/magento/magento2/issues/29525)

<!-- ENGCOM-7987 -->

* `DataObject` は、の製品モデルに置き換えられました。 `\Magento\MediaGalleryCatalogUi\Ui\Component\Listing\Columns\Thumbnail::prepareDataSource`.[GitHub-1711](https://github.com/magento/adobe-stock-integration/issues/1711)

<!-- ENGCOM-7914 -->

* この `RequireJS` リゾルバーがブロックされたリソースの検出に失敗しなくなりました。 以前は、リゾルバーは、ページ上のすべてのリソースが適切に読み込まれたか処理されたかを正しく検出できず、ページの読み込みが維持されていました。 [GitHub-28116](https://github.com/magento/magento2/issues/28116)

<!-- ENGCOM-8229 -->

* 属性リポジトリコードの検証が次の条件に従うようになりました。 `Magento\Eav\Model\Entity\Attribute::ATTRIBUTE_CODE_MAX_LENGTH` ハードコードされた値ではなく [GitHub-29017](https://github.com/magento/magento2/issues/29017)

<!-- MC-35699-->

* HTMLの縮小で、PHTML ファイル内のHTMLー文字列から 3 つのスラッシュ (//) が削除されなくなりました。 以前は、縮小中に 3 つのスラッシュがコメントとして解釈され、デプロイ時に生成された PHTML ファイル内の残りの行が完全に削除されていました。

<!-- MC-38201-->

* マーチャントは、テーブルレベルではなく、テーブル列レベルでインデクサーの購読を設定できるようになりました。 に新しい引数が追加されました `\Magento\Framework\Mview\View\Subscription` ：特定のビューまたはテーブルの組み合わせで列を無視できるようにします。 [GitHub-30243](https://github.com/magento/magento2/issues/30243)

<!-- MC-30171-->

* クリック **買い物かごに追加** 製品ページの JavaScript が完全に初期化される前のボタンが重複しなくなりました `form_key` 値。 以前は、製品はキャッシュを使用して買い物かごに追加できました `form_key` 例外をトリガーした値。 条件 **買い物かごに追加** JavaScript が完全に初期化される前にをクリックし、 `form_key` フォームデータに送信された値がユーザーセッションと一致せず、製品が買い物かごに追加されませんでした。 [GitHub-13746](https://github.com/magento/magento2/issues/13746)

<!-- ENGCOM-8107 -->

* 現在の cURL クライアントは、大文字と小文字を区別しないヘッダー名に従うようになりました。 以前は、 `Set-Cookie` の比較では大文字と小文字が区別され、一部の HTTP サーバーで問題が発生する可能性がありました。 [GitHub-29524](https://github.com/magento/magento2/issues/29524)

<!-- ENGCOM-8360 -->

* での XSD URN 形式の更新 `api-functional` およびテストケース XML ファイル。 [GitHub-30552](https://github.com/magento/magento2/issues/30552)

<!-- ENGCOM-8295 -->

* コレクションの読み込みをカスタマイズしやすくするために、イベントプレフィックスとイベントオブジェクトがカタログ製品オプションの値コレクションに追加されました。 `\Magento\Catalog\Model\ResourceModel\Product\Option\Value\Collection`. [GitHub-29621](https://github.com/magento/magento2/issues/29621)

<!-- ENGCOM-8261 -->

* 次のすべての出現 `array_merge` は、コーディング規格で推奨される形式を使用するようにリファクタリングされています。 [GitHub-30005](https://github.com/magento/magento2/issues/30005)

<!-- ENGCOM-7718 -->

* A `head.additional` タイプのブロック `\Magento\Framework\View\Element\Text\ListText` が `adminhtml` `default` レイアウト ( `magento2/module-base`) をクリックします。 [GitHub-29165](https://github.com/magento/magento2/issues/29165)

<!-- ENGCOM-8312 -->

* レイアウトテンプレートモジュールウィジェットに、見つからないエスケープ URL メソッドを追加しました。 [GitHub-30036](https://github.com/magento/magento2/issues/30036)

<!-- ENGCOM-8127 -->

* この `\Magento\Framework\Filesystem\Io\File::read()` メソッドは `\Magento\Framework\Filesystem\Io\IoInterface::read()`. [GitHub-27866](https://github.com/magento/magento2/issues/27866)

### クラルナ

* PayPal モジュールへの依存を削除しました。 [GitHub-29421](https://github.com/magento/magento2/issues/29421)

### ログ

<!-- ENGCOM-8443 -->

* この `Magento_Logging` モジュールは、新しい値とその前にある値を正しく登録するようになりました。 以前は、「変更前の値」列の値は、最初の変更か次の変更か、デフォルト値が返された時点かに関係なく、N/A の値を表示していました。 [GitHub-26943](https://github.com/magento/magento2/issues/26943)

### メディアギャラリー

<!-- ENGCOM-8014 -->

* 管理者 **ストア**  >  **設定**  >  **詳細**  >  **システム** 正しい製品名が表示されるようにページが更新されました（メディアギャラリー）。 ユーザーインターフェイスのマイナーな再設計が含まれています。 [GitHub-1738](https://github.com/magento/adobe-stock-integration/issues/1738)

<!-- ENGCOM-8019 -->

* メディアギャラリー画像の説明の「使用されている場所」セクションのリンクに、選択した画像で期待どおりにフィルタリングされたグリッドが表示されるようになりました。 以前は、表示されたグリッドのタイトルが正しくなく、リストエントリが正確ではありませんでした。 [GitHub-1694](https://github.com/magento/adobe-stock-integration/issues/1694)

<!-- ENGCOM-8019 -->

* メディアギャラリーで複数の画像を正常に編集できるようになりました。 以前は、1 つの画像にタグを追加した後で、2 番目の画像にタグを追加することはできませんでした。 [GitHub-1755](https://github.com/magento/adobe-stock-integration/issues/1755)

<!-- ENGCOM-8015 -->

* メディアギャラリーで画像からタグを削除した後、「タグ」ドロップダウンメニューが期待どおりに空になりました。 [GitHub-1703](https://github.com/magento/adobe-stock-integration/issues/1703)

<!-- ENGCOM-8146 -->

* メディアギャラリー同期キューメッセージのバッチ処理がサポートされるようになりました。 [GitHub-1724](https://github.com/magento/adobe-stock-integration/issues/1724)

<!-- ENGCOM-8064 -->

* メディアギャラリーを開こうとすると、404 ページが期待どおりに表示されるようになりました。 **拡張メディアギャラリー** は無効です。  [GitHub-1760](https://github.com/magento/adobe-stock-integration/issues/1760)

<!-- ENGCOM-8072 -->

* `MediaGalleryMetadata` では、例外が発生した場合にセグメントリーダーをスキップし、代わりに画像メタデータを解析して期待どおりに表示するようになりました。 以前は、画像メタデータは、 `exif_read_data` セグメントリーダー。 [GitHub-1782](https://github.com/magento/adobe-stock-integration/issues/1782)

<!-- ENGCOM-8069 -->

* フォルダー名の長さにより、画像がメディアギャラリーにアップロードされなくなりました。 メディアギャラリーでパス列がタイプとして設定されるようになりました `text`. [GitHub-1778](https://github.com/magento/adobe-stock-integration/issues/1778)

<!-- ENGCOM-8217 -->

* 画像アップローダーで、メディアギャラリーからレンディションを挿入したときに、正しい画像サイズが表示されるようになりました。 [GitHub-1806](https://github.com/magento/adobe-stock-integration/issues/1806)

<!-- ENGCOM-8467 -->

* パスの検証が `Mediagallery` アップローダプラグイン。 以前は、検証に失敗し、 **古いメディアギャラリーを有効にする** が無効になっている。 [GitHub-30649](https://github.com/magento/magento2/issues/30649)

<!-- ENGCOM-8057 -->

* `Magento_Cms::media_gallery` 新しいメディアギャラリーでは、次の個別の操作に対する設定済みの権限をサポートするために、ACL サブリソースが追加および適用されました。

   * アセットのアップロード
   * コンテンツへのアセットの挿入
   * アセットの削除
   * フォルダーの作成
   * フォルダーを削除します。 [GitHub-1487](https://github.com/magento/adobe-stock-integration/issues/1487)

<!-- ENGCOM-8047 -->

* 長いメディアギャラリーのテキスト文字列とフォルダー名が切り抜かれなくなりました。 以前は、アプリケーションに切り抜かれたテキストと画像が表示され、次のメッセージが表示されていました。  `We couldn't find any records`. [GitHub-1763 ](https://github.com/magento/adobe-stock-integration/issues/1763), [GitHub-1758 ](https://github.com/magento/adobe-stock-integration/issues/1758)

<!-- ENGCOM-8042 -->

* アプリケーションに「 **選択項目を追加** ボタン（新しいページのコンテンツの編集中に画像が選択されていない場合） [GitHub-1769](https://github.com/magento/adobe-stock-integration/issues/1769)

<!-- ENGCOM-8047 -->

* フィルターが **コンテンツ**  >  **メディアギャラリー** カテゴリグリッド。 [GitHub-1763 ](https://github.com/magento/adobe-stock-integration/issues/1763)

<!-- ENGCOM-8183 -->

* ギャラリーの「ブレークポイントの乗算」オプションの設定が、期待どおりに動作するようになりました。 以前は、ブレークポイントオプションの設定が正しく機能しませんでした。 `mediaCheck` ページの読み込み時にメディアクエリ関数をトリガーしました。 [GitHub-29933](https://github.com/magento/magento2/issues/29933)

### MFTF

<!-- ENGCOM-8359 -->

* 繰り返しアクションをのアクショングループに置き換えました `CheckStaticBlocksTest`. [GitHub-30561](https://github.com/magento/magento2/issues/30561)

<!-- ENGCOM-8267 -->

* `AdminUpdateCategoryAndMakeInactiveTest` および `VerifyChildCategoriesShouldNotIncludeInMenuTest` MFTF のベストプラクティスに従ってリファクタリングされました。 [GitHub-30058](https://github.com/magento/magento2/issues/30058)

<!-- ENGCOM-8458 -->

* 重複を削除しました `AdminOpenCMSBlocksGridActionGroup`. [GitHub-30896](https://github.com/magento/magento2/issues/30896)

<!-- ENGCOM-8156 -->

* 置換済み `AdminOpentCmsBlockActionGroup` AdminOpenCmsBlockActionGroup を使用します。 [GitHub-29839](https://github.com/magento/magento2/issues/29839)

<!-- ENGCOM-8226 -->

* 非推奨 `GoToAttributeGridPageActionGroup`. [GitHub-30103](https://github.com/magento/magento2/issues/30103)

<!-- ENGCOM-8061 -->

* にアクショングループを追加しました。 `Analytics` モジュール。 [GitHub-29500](https://github.com/magento/magento2/issues/29500)

<!-- ENGCOM-7334 -->

* 更新済み `CheckCheckoutSuccessPageAsRegisterCustomerTest` および `CheckCheckoutSuccessPageAsGuestTest` ：テストの実行後に作成済のオーダーをキャンセルします。 [GitHub-28324](https://github.com/magento/magento2/issues/28324)

<!-- ENGCOM-8214 -->

* 削除済み `AdminNavigateToPageGridActionGroup` 冗長性が原因です。 [GitHub-29838](https://github.com/magento/magento2/issues/29838)

<!-- ENGCOM-8280 -->

* の問題 `StorefrontProductListWidgetWithSharedCatalogTest` その結果、テストがスキップされる原因となった問題が解決されました。 [GitHub-322](https://github.com/magento/partners-magento2b2b/issues/322)

<!-- ENGCOM-8122 -->

* 実装済み `ActionGroup` をクリックして、チェックアウトページに移動します。 [GitHub-29843](https://github.com/magento/magento2/issues/29843)

<!-- ENGCOM-8124 -->

* 実装済み `AdminOpenCreateNewCMSPageActionGroup` をクリックして、新しい CMS ページを作成します。 [GitHub-29824](https://github.com/magento/magento2/issues/29824)

<!-- ENGCOM-8268 -->

* メディアギャラリーの CMS ページの MFTF テストでスキップされた問題を修正しました。 [GitHub-30164](https://github.com/magento/magento2/issues/30164)

<!-- B2B-831 -->

* MFTF テストに、 `Company`, `CompanyCredit`, `CompanyPayment`, `CompanyShipping`、および `ConfigurableSharedCatalog` モジュール。 [GitHub-30164](https://github.com/magento/magento2/issues/30164)

#### 新しいテスト

<!-- ENGCOM-7804 -->

* 管理者で友人に電子メールを有効にするテストを追加しました。 [GitHub-29145](https://github.com/magento/magento2/issues/29145)

<!-- ENGCOM-8316 -->

* 管理者がグリッドから CMS ブロックを削除するためのテストを追加しました。 [GitHub-30372](https://github.com/magento/magento2/issues/30372)

<!-- ENGCOM-7933 -->

* 買い物かごのルールを単一のバンドル項目に適用するためのテストを追加しました。 [GitHub-28921](https://github.com/magento/magento2/issues/28921)

<!-- ENGCOM-8075 -->

* チェックするテストを追加しました。 **使用場所** メディアギャラリー画像の情報は、エンティティの削除後に表示されます。 [GitHub-1774](https://github.com/magento/adobe-stock-integration/issues/1774)

#### 新しいアクショングループ

* `AssertStorefrontCustomerLogoutSuccessPageActionGroup`. [GitHub-29841](https://github.com/magento/magento2/issues/29841) <!-- ENGCOM-8121 -->

* `AdminOpenConfigurationStoresPageActionGroup`. [GitHub-29848](https://github.com/magento/magento2/issues/29848) <!-- ENGCOM-8259 -->

* `ReloadPageActionGroup`. [GitHub-30683](https://github.com/magento/magento2/issues/30683) <!-- ENGCOM-8394 -->

* `StorefrontClickRefundTabCustomerOrderViewActionGroup`. [GitHub-30032](https://github.com/magento/magento2/issues/30032) <!-- ENGCOM-8203 -->

* `AdminOpenAdminThreeDSecurePageActionGroup`. [GitHub-29845](https://github.com/magento/magento2/issues/29845) <!-- ENGCOM-8115 -->

* `AdminCustomerClickFirstRowEditLinkActionGroup`.  [GitHub-29501](https://github.com/magento/magento2/issues/29501) <!-- ENGCOM-8043 -->

* `StorefrontClickAddToCartButtonActionGroup`. [GitHub-29823](https://github.com/magento/magento2/issues/29823) <!-- ENGCOM-8113 -->

* `AdminDeleteTaxRateActionGroup`. [GitHub-29940](https://github.com/magento/magento2/issues/29940) <!-- ENGCOM-8192 -->

* `AdminOpenWebConfigurationPageActionGroup`. [GitHub-29846](https://github.com/magento/magento2/issues/29846) <!-- ENGCOM-8126 -->

* `AdminOpenGeneralConfigurationPageActionGroup`. [GitHub-29847](https://github.com/magento/magento2/issues/29847) <!-- ENGCOM-8114 -->

* `AdminOrderClickSubmitOrderActionGroup`. [GitHub-29649](https://github.com/magento/magento2/issues/29649) <!-- ENGCOM-8023 -->

* `AdminOpenCatalogProductPageActionGroup`. [GitHub-29941](https://github.com/magento/magento2/issues/29941) <!-- ENGCOM-8209 -->

* `AdminClickInvoiceButtonIntoOrderActionGroup`. [GitHub-25399](https://github.com/magento/magento2/issues/25399) <!-- ENGCOM-8210 -->

* `AdminGridBulkActionGroup`. [GitHub-28324](https://github.com/magento/magento2/issues/28324)<!-- ENGCOM-7334 -->

* `AdminGridColumnShowActionGroup`. [GitHub-28324](https://github.com/magento/magento2/issues/28324)<!-- ENGCOM-7334 -->

* `AdminOpenIndexManagementPageActionGroup`. [GitHub-29825](https://github.com/magento/magento2/issues/29825) <!-- ENGCOM-8123 -->

* `AdminOpenCatalogSearchTermIndexPageActionGroup`. [GitHub-29844](https://github.com/magento/magento2/issues/29844) <!-- ENGCOM-8128 -->

* `AdminClickAddProductToggleAndSelectProductTypeActionGroup`. [GitHub-30917](https://github.com/magento/magento2/issues/30917) <!-- ENGCOM-8439 -->

* `StorefrontCheckoutClickSaveAddressButtonActionGroup`. [GitHub-30916](https://github.com/magento/magento2/issues/30916) <!-- ENGCOM-8454 -->

* `AdminOpenCurrencyRatesPageActionGroup`. [GitHub-30783](https://github.com/magento/magento2/issues/30783) <!-- ENGCOM-8432 -->

* `AdminClickGetShippingMethodsAndRatesActionGroup`. [GitHub-30782](https://github.com/magento/magento2/issues/30782) <!-- ENGCOM-8436 -->

* `AdminSelectFixedShippingMethodActionGroup`. [GitHub-30782](https://github.com/magento/magento2/issues/30782) <!-- ENGCOM-8436 -->

* `StorefrontClickProceedToCheckoutActionGroup`. [GitHub-30926](https://github.com/magento/magento2/issues/30926) <!-- ENGCOM-8438 -->

* `StorefrontOpenMyAccountPageActionGroup`. [GitHub-29842](https://github.com/magento/magento2/issues/29842) <!-- ENGCOM-8143 -->

### ニュースレター

<!-- MC-38789-->

* 管理者ユーザーは、顧客がキューに登録されたニュースレターを購読した場合、顧客アカウントを期待どおりに編集できるようになりました。 [GitHub-30645](https://github.com/magento/magento2/issues/30645)

<!-- ENGCOM-8034 -->

* 買い物客がニュースレターの購読を確認しなかった場合、アプリがニュースレターの購読確認を再送信するようになりました。 [GitHub-28422](https://github.com/magento/magento2/issues/28422)

<!-- ENGCOM-8429 -->

* 顧客がキューに登録されたニュースレターを購読する際、顧客アカウントを期待どおりに編集できるようになりました。 [GitHub-30645](https://github.com/magento/magento2/issues/30645)

### 支払い方法

<!-- MC-35161-->

* 支払い方法が、マルチストアデプロイメントで期待どおりに、すべての Web サイトの管理者に読み込まれるようになりました。

<!-- MC-36954-->

* アプリケーションに「 `Purchase Order number is a required field` メッセージが「クーポンコード」フィールドの上に表示され、購入注文が唯一の利用可能な支払いオプションとして設定されているデプロイメントに、買い物客が情報を入力する前に表示されます。

<!-- MC-35152-->

* 買い物客の名前にアクセント付きの文字が含まれている場合、アプリケーションは Payflow Pro の支払いを正常に完了するようになりました。 以前は、支払いが完了せず、アプリケーションがこのエラーをログに記録していました： `report.CRITICAL: String to be escaped was not valid UTF-8 or could not be converted`.

<!-- ENGCOM-8173 -->

* ゲスト買い物客が PayPal の注文を行えるようになったのは、 **顧客グループへの自動割り当て** が有効になっている。 支払いは PayPal ゲートウェイで処理され、注文はMagentoで作成され、買い物客は注文ありがとうページを表示します。 以前は、注文は PayPal ゲートウェイで正常に処理されましたが、Adobe Commerceでは注文が作成されませんでした。 買い物客は、代わりに注文のレビューページにリダイレクトされ、アプリケーションが次のエラーを表示しました。 `Failed address validation: %1" error`. [GitHub-25399](https://github.com/magento/magento2/issues/25399)

#### PayPal

<!-- MC-35692-->

* クレジットカードを使用する支払い方法からクレジットカード以外の支払い方法に切り替えた後、マーチャントは管理者から注文を正常に行うことができるようになりました。 以前は、 **注文を送信** ボタンをクリックすると、読み込みプロセスが開始しましたが、完了しておらず、順序が設定されていません。

<!-- MC-37649-->

* PayPal Express で注文が行われた場合、アプリケーションで重複注文が発生することはなくなりました。 以前は、買い物客が PayPal Express で注文を支払おうとしたが、PayPal がエラーを返した場合でも、アプリケーションは注文を作成していました。 その結果、商人のサイトで重複注文が発生していました。 [GitHub-13952](https://github.com/magento/magento2/issues/13952)

<!-- MC-38829-->

* PayPal 決済レポートが、 **レポート** > **セールス** > **PayPal 決済** 期待どおり 以前は、PayPal 決済レポートグリッドにこれらのレポートがリストされず、次のメッセージが表示されていました。 `We couldn't find any records`.

<!-- MC-39442-->

* クリック **PayPal** ボタンが冗長トリガーを解除 `web-api` 呼び出し。 以前は、2 つのリクエストがトリガーされ、製品の料金が 2 倍になりました。

### パフォーマンス

<!-- MC-37705-->

* でのパフォーマンスの問題 `module-catalog-import-export/Model/Import/Product/Option.php` 宛名が書かれている 100,000 件を超えるレコードのエクスポートまたはインポートに要する時間が短縮されました。 詳しくは、 [多数の製品オプションがある場合、読み込み/書き出しに予想より時間がかかります](https://support.magento.com/hc/en-us/articles/360050695772) ナレッジベース記事。

<!-- MC-37799-->

* `Magento_Csp/Model/BlockCache` は、メモリ消費量と、不必要に大きなキャッシュされた文字列の生成の両方を削減するためにリファクタリングされました。 以前は、動的にホワイトリストに登録されたスクリプトやスタイルを含むページは、パフォーマンスの問題で頻繁に発生していました。 [GitHub-29964](https://github.com/magento/magento2/issues/29964)

<!-- MC-37816 -->

* 消費者を使用した 10 万以上の製品を含むカタログの予定書き出しのパフォーマンスを改善しました。

<!-- MC-38306 -->

* 無効な製品をカテゴリに追加または保存する際に、アプリケーションがカテゴリキャッシュをフラッシュしなくなりました。 以前は、製品のステータスにかかわらず、アプリケーションは関連カテゴリのキャッシュをフラッシュしていましたが、これはサーバーのパフォーマンスに影響を与えました。

<!-- MC-38518 -->

* 買い物かごの製品数量を更新するためのページ読み込み時間が改善されました。 以前は、アプリケーションが買い物かごの製品ごとに複数の個別のクエリを実行していたので、ページ読み込み時間が長くなりました。

<!-- MC-39700 -->

* インデクサーが `Magento_Bulk` MySQL テーブル。一括操作のパフォーマンスが向上しました。

<!-- MC-38593 -->

* これで、アプリケーションは設定可能な製品の子 ID をキャッシュします。 これにより、データベースリクエストの数を減らし、ページ読み込みのパフォーマンスが向上しました。 [GitHub-30585 ](https://github.com/magento/magento2/issues/30585)

<!-- MC-37594 -->

* 管理ダッシュボードの読み込みを改善しました。 以前は、ページの読み込みが完了する前に、アプリケーションがタブ名をリストとして表示していました。

<!-- MC-37417 -->

* レイアウトキャッシュの有効期限制限が追加され、Redis キャッシュ管理が改善されました。 以前は、Redis キャッシュが大規模展開で割り当てられた最大メモリにすばやく到達し、アプリケーションが書き込み操作でエラーをスローしました。

<!-- ENGCOM-8016 -->

* 冗長なデータベースクエリが `app/code/Magento/Catalog/Model/CategoryLink.php`. [GitHub-29453](https://github.com/magento/magento2/issues/29453)

<!-- ENGCOM-8290 -->

* `Magento\Framework\DB\Adapter\Pdo\Mysql->isTableExists` のパフォーマンスを向上させるためにリファクタリングが行われました。 への冗長な呼び出し `SHOW TABLE STATUS` テーブルの存在が減少したかを確認する。 [GitHub-29662](https://github.com/magento/magento2/issues/29662)

<!-- ENGCOM-8258 -->

* `getPageLayoutsConfig` がキャッシュに保存されるようになりました。これにより、設定ビルダーのパフォーマンスが向上しました。 [GitHub-29546](https://github.com/magento/magento2/issues/29546)

<!-- MC-35614-->

* 3,000,000 人を超える顧客を含む顧客セグメントの編集および保存操作中のAdobe Commerceのパフォーマンスが向上しました。

### 永続的

<!-- MC-36647 -->

* 買い物客は、永続的な買い物かごが有効な場合、セッション cookie の有効期限が切れた後は注文できなくなりました。 代わりに、アプリケーションにログインページが表示され、買い物客がログインできるようになります。 以前は、アプリケーションが注文をおこなっていました。 永続的なお客様が、 `PHPSESSID` 期限切れで `customerSession` が永続的な情報から再作成されました。

<!-- MC-39127-->

* 買い物客が、永続的な買い物かごが有効になっているストアにログインした後、アプリケーションで期待どおりにようこそメッセージが表示されるようになりました。 以前は、 **君は？** ログイン後のメッセージ

<!-- MC-38269-->

* アプリケーションに「 **君は？** 顧客が **自分を記憶する** オプションを使用してログインする必要があります。

<!-- MC-37109-->

* 顧客セッションの有効期限が切れた後、アプリケーションに顧客の買い物かごの内容が表示されなくなります。 以前は、ゲスト顧客が引き続き買い物かごを有効にしたときにチェックアウトしようとすると、アプリケーションが次のエラーを表示していました。 `No such entity with cartid = 0`.

### 価格

<!-- MC-34394-->

* 非同期価格の連続更新がお互いに干渉しなくなり、各操作に正しいステータスが割り当てられます。 以前は、非同期価格更新が失敗した場合、対応するキューコンシューマーが再起動されるまで、以降のすべての非同期価格更新が失敗していました。 [GitHub-27865](https://github.com/magento/magento2/issues/27865)

### レポート

<!-- MC-36652 38925-->

* **レポート** > **マーケティング** > **買い物かご内の製品** では、レポートを生成するユーザーの許可された範囲のレコードのみが表示されるようになりました。 以前は、すべてのスコープですべてのデータが使用可能でした。

<!-- MC-38074-->

* 「買い物かご内の製品」レポートに製品通貨を表示する際、レポートを生成するマーチャントの役割範囲で指定された通貨が、アプリケーションで使用されるようになりました。

<!-- MC-37934-->

* 最近表示された製品機能と最近比較された製品機能で、マルチストアデプロイメントでの期待どおりに、管理者内の様々なストアおよび Web サイトの統計が表示されるようになりました。 以前は、これらの機能では一部のストアや Web サイトが考慮されていませんでした。

<!-- MC-37217-->

* 注文レポートの価格で、正しい通貨記号が使用されるようになりました。

<!-- ENGCOM-8314 -->

* ユーザーが管理ダッシュボードをクリックしたときに、アプリケーションがトークンの存在を検証できるようになりました **アドバンスレポートに移動** 」ボタンをクリックします。  トークンが存在する場合は、「高度なレポート」ページが表示されます。 トークンが設定されていない場合、ユーザーガイドに情報ページが表示されます。 [GitHub-25411](https://github.com/magento/magento2/issues/25411)

### 返品認証 (RMA)

<!-- MC-36057-->

* RMA を分割する際に、選択したオプションが明細品目の分割に適用されるようになりました。 以前は、「戻り値の理由」、「項目の条件」、「解像度」の値は保存されていませんでした。

<!-- MC-35360-->

* JavaScript のバンドルが有効な場合に、RMA の追跡情報と発送情報を削除できるようになりました。

<!-- MC-36757-->

* 特定の Web サイト範囲に属する製品へのアクセスが制限された管理者は、その項目が Web サイト範囲に含まれなくなった場合でも、その項目をリターンに追加できるようになりました。

### レビュー

<!-- MC-37145-->

* に表示される評価の数 **ストア** > **属性** > **評価** マルチサイト展開での評価数と一致するようになりました。 [GitHub-30258](https://github.com/magento/magento2/issues/30258)

<!-- MC-37117-->

* 「新しいレビュー」ページが、 **新規レビュー** ボタン（管理） **マーケティング** > **すべてのレビュー**. このページで製品をクリックすると、その製品に対して期待される新しいレビューフォームが開きます。

<!-- ENGCOM-8383 -->

* 管理者から注文を編集しようとしても、アプリケーションがこのエラーをスローしなくなりました。 **マーケティング**  >  **すべてのレビュー**: `Uncaught TypeError: Event.observe is not a function`. [GitHub-30388](https://github.com/magento/magento2/issues/30388)

### 報酬

<!-- MC-38257-->

* 一部の注文が完了した場合に、課税対象の注文に対して報酬ポイントが期待どおりに計算されるようになりました。

<!-- MC-37244-->

* 商人は、報酬ポイントと共に購入した注文に対して部分的な払い戻しを正常に発行し、その後も注文残りを払い戻すことができるようになりました。 以前は、商人は残りの注文の報酬ポイントを返金できませんでした。

<!-- MC-37113-->

* 買い物客が削除後に報酬ポイントを再適用した場合、アプリケーションはこのエラーを表示しなくなりました。 `You removed the reward points from this order`.

<!-- MC-37032-->

* 顧客が複数の通貨をサポートするストアに非ベース通貨を使用して注文を行った場合、報酬ポイントが正しく計算されるようになりました。

### セールス

<!-- MC-36219-->

* この `order_created_at` 列 `sales_shipment_grid` が更新されるたびに、期待どおりに更新されるようになりました。

<!-- MC-36405-->

* カスタムオプションの日付を使用して、製品を次の日付のストアで正常に並べ替えることができるようになりました。 **JavaScript カレンダーを使用** が有効になっている。 以前は、アプリケーションが並べ替えを試みても、カートに項目が追加されず、次のエラーが表示されていました。 `Could not add the product with SKU "simp1" to the shopping cart: Please specify date required option(s).`

<!-- MC-36533-->

* 小計ゼロのチェックアウト方法が有効なデプロイメントで、買い物客が合計コストが 0 ドルの仮想製品で構成される注文をチェックアウトすると、アプリケーションは直ちに注文を閉じることはなくなりました。

<!-- MC-36755-->

* アプリケーションは、処理の前に順序をアーカイブしなくなりました。 以前は、管理オーダーグリッドでの複数選択アクションが、未選択のオーダーに影響を与えていました。

<!-- MC-37371-->

* サウジリヤル (SAR) がベース通貨として設定されている場合、クレジットメモグリッドに正しい通貨記号が表示されるようになりました。

<!-- MC-37880-->

* アプリケーションで、チェックアウト時に注文ページで、配送先住所情報が期待どおりに一貫して表示されるようになりました。

<!-- MC-38666-->

* の値 `total_qty` が `total_qty_ordered` 売上請求書内。

<!-- MC-38717-->

* セールスメールの非同期送信で、最後の更新日以降に作成された注文の電子メールのみが送信されるようになりました。 以前は、非同期送信が有効な場合、アプリケーションは日付で E メールをフィルタリングしていませんでした。

<!-- MC-39135-->

* 管理者から注文がおこなわれた場合、アプリケーションは請求書の電子メールを期待どおりに送信するようになりました。

<!-- MC-38917-->

* マーチャントが管理者から顧客の新しい注文を作成すると、セッション中にアプリケーションが既存の注文データをクリアするようになりました。

<!-- MC-38915-->

* 管理注文で作成した新規顧客の顧客グループを **顧客グループへの自動割り当ての有効化** が有効になっている。 また、VAT 検証に基づいて顧客グループを割り当てることもできます。 以前は、VAT 番号を検証する際に、リクエストオブジェクトは割り当てられたリクエストを確認しませんでした `group_id`. デフォルトでは、デフォルトの `group_id`.

<!-- MC-37539-->

* アプリケーションは、 `Suspected Fraud` ステータス： `Processing` REST API を使用して商人が部分出荷を作成した後。

### セールスルール

<!-- MC-34793-->

* 買い物客が発送方法を変更した場合、発送方法に基づいて適用されたクーポンコードは適用されなくなりました。 以前は、買い物客が発送方法を切り替えた場合、アプリケーションでクーポンコードがクリアされませんでした。

<!-- MC-34649-->

* 買い物客は、 **顧客ごとの使用** 許可を設定しています。 以前は、買い物客が複数のブラウザーウィンドウを開いて複数の注文を同時におこなった場合、各注文は、 **顧客ごとの使用** 設定には次の値が含まれていました： **1**.

### 検索

<!-- MC-35095-->

* Elasticsearchが検索シノニムで検索を行った場合に、不明な修飾子エラーがスローされなくなりました。 以前は、エスケープスラッシュ記号が正規表現になかったので、致命的なエラーが発生していました。

<!-- MC-37577-->

* 詳細検索で、表示設定がに設定されている子製品が個々の検索結果として設定可能な製品の子が返されなくなりました。 **個別に表示されない**.

<!-- MC-37954-->

* 検索結果のElasticsearchの種類の製品名で、大文字と小文字が区別されなくなりました。

<!-- ENGCOM-8329 -->

* 検索結果ページは、 **キャッシュする上位の検索結果の数を 0 に設定** 設定は管理で有効になっています **ストア**  >  **設定**  >  **カタログ**  >  **カタログ**  > **カタログ検索**.

<!-- MC-36807-->

* カタログ検索インデクサーは、Elasticsearchフィールドの制限により、エラーをスローせずに実行されるようになりました。 以前は、アプリケーションは次のエラーをスローしていました： `Limit of total fields [xxx] in index [m24dev_product_1_v10] has been exceeded`.

<!-- MC-35491-->

* カタログ検索のパフォーマンスが向上しました。 無効化 **検索候補を有効にする** (**ストア** > **設定** > **カタログ** > **カタログ検索** ) は期待どおりに動作します。 以前は、アプリケーションは MySQL を照会していました `search_query` オートコンプリートの検索候補のElasticsearchの代わりにテーブルを使用する。 [GitHub-25534](https://github.com/magento/magento2/issues/25534)

<!-- MC-35256-->

* Elasticsearchは、MySQL と同じ製品価格をフィルタリングするようになりました。 フィールドタイプ `price_*`  は次の日から変更されました： `float` から `double` の精度を向上させ、浮動小数点エラーを修正するためにElasticsearchインデックスを使用します。

<!-- ENGCOM-8393 -->

* キーダウンイベントリスナーが管理者に追加され、フォワードスラッシュを入力したときにグローバル検索フォームをアクティブ化できるようになりました。 [GitHub-29551](https://github.com/magento/magento2/issues/29551)

<!-- MC-24217-->

* Elasticsearchでエラーがスローされなくなり、 `string` 値は、 `integer` または `decimal` バックエンドのタイプ。 以前は、アプリケーションで次のエラーが表示されていました： `exception.log`: `number format exception`.

<!-- ENGCOM-8303 -->

* Elasticsearchで、検索語句に  `/`.  [GitHub-25886](https://github.com/magento/magento2/issues/25886), [GitHub-25110](https://github.com/magento/magento2/issues/25110)

* 製品クエリで選択した顧客グループに対して、 **カタログ検索の許可を解除** 一般的なカテゴリ権限の設定が有効になっています。 [GitHub-29927](https://github.com/magento/magento2/issues/29927)

<!-- ENGCOM-8466 -->

* 検索結果に同じ単語を複数引用符で囲むことはできなくなりました。 [GitHub-30104](https://github.com/magento/magento2/issues/30104)

### 送料

<!-- MC-38247 -->

* ネットワークの中断が DHL 発送方法への接続を中断した場合に、チェックアウトプロセスが失敗しなくなりました。 代わりに、他の使用可能な発送方法が表示されます。 以前は、DHL 配送への接続が中断されたときにチェックアウトプロセスが停止し、アプリケーションが次のエラーを表示していました。 `Sorry, no quotes are available for this order at this time`. [GitHub-29902](https://github.com/magento/magento2/issues/29902)

<!-- MC-35194-->

* 管理者の UPS 配信方法を説明するフィールド **ストア** >  **設定** > **セールス** > **配信方法** が期待どおりに有効になりました。

<!-- MC-35633-->

* POST `/rest/V1/shipment` エンドポイントで、注文が正しく更新されるようになりました。 以前は、アプリケーションで出荷が作成されましたが、出荷ステータスは処理状態のままでした。

<!-- MC-37120-->

* 複数の住所に出荷でチェックアウトする前に別の製品が買い物かごから削除された場合に、アプリケーションが買い物かごから単純な製品を削除しなくなりました。 [GitHub-30259](https://github.com/magento/magento2/issues/30259)

<!-- MC-38031-->

* 「受注レビュー」ページに、複数の住所に出荷される受注に対して、期待通りに出荷前の税額が表示されるようになりました。

<!-- ENGCOM-8257 -->

* UPS 出荷トラッキングが、次のステータスを示すようになりました： `Delivered On` パッケージが配信された場合にのみ有効です。 [GitHub-30032](https://github.com/magento/magento2/issues/30032)

<!-- MC-38825-->

* 買い物客が複数のアドレスを持つチェックアウトを行わないで買い物かごに戻ったときに、仮想製品を含む注文に対して正しい買い物かごの小計が表示されるようになりました。

<!-- MC-38682-->

* JavaScript のバンドルが有効な場合に FedEx の出荷を使用する既存の注文の出荷ページから、出荷ラベルを作成できるようになりました。 以前は、マーチャントが **発送ラベルを作成** 」ボタンをクリックします。

<!-- MC-36953-->

* 顧客に送信された出荷確認 E メールの出荷追跡リンクが、期待どおりに機能するようになりました。 以前は、このリンクは 404 エラーを返していました。

<!-- ENGCOM-8025 -->

* 買い物客が複数のアドレスを使用してチェックアウトし、仮想製品以外のすべての製品を削除した場合に、情報エラーメッセージが表示されるようになりました。 [GitHub-25595](https://github.com/magento/magento2/issues/25595)

<!-- ENGCOM-8253 -->

* 部分注文の出荷ラベルを期待どおりに作成できるようになりました。 以前は、1 つの注文から 1 つの品目に対して発送ラベルを作成しようとすると、すべての製品がパッケージに追加され、検証に失敗していました。 [GitHub-29552](https://github.com/magento/magento2/issues/29552)

<!-- ENGCOM-8154 -->

* 呼び出し時に発送方法の検証がバイパスされなくなりました `/V1/guest-carts/:cartId/totals-information`. [GitHub-25147](https://github.com/magento/magento2/issues/25147)

### サイトマップ

<!-- MC-37306-->

* によって生成されるサイトマップ `cron` に正しい画像 URL が含まれるようになりました。 以前は、生成されたキャッシュされた画像パスがマルチストアデプロイメントで正しくありませんでした。

### ステージング

<!-- MC-39046 -->

* ホームページの予定更新を確認すると、[ ホームページを編集 ] ページに、予定されているすべての更新が期待どおりに表示されるようになりました。 以前は、アプリケーションにスケジュールされた更新のうち 1 つのみが表示されていました。

<!-- MC-34988 -->

* 0 を `/rest/V1/products/special-price-information` 特別な価格エンドポイントで価格が保存され、期待どおりにスケジュールが返されるようになりました。

<!-- MC-35362 -->

* インポート CSV ファイルにバイトオーダーマーク (BOM) が含まれる場合、スケジュールされたインポートが期待どおりに実行されるようになりました。

<!-- MC-38026 -->

* マーチャントがカテゴリの更新をスケジュールする際に、アプリケーションがレイアウト本文クラスを削除しなくなりました。

<!-- MC-38234 -->

* 再スケジュールされた製品の変更が、 `cron` 実行

<!-- MC-38759-->

* カテゴリの更新をスケジュールしようとしても、アプリケーションでエラーがスローされなくなりました。 以前は、「 **保存** 「新しい更新をスケジュール」ページで、次の操作を実行します。 `Something went wrong while saving the Magento\Catalog\Api\Data\CategoryInterface`.

<!-- MC-38455-->

* この `rest/V1/products/special-price` API を使用して、複数の店舗での製品の特別価格のスケジュールを設定できるようになりました。 以前は、同じ店舗の複数店舗の価格更新をマーチャントがスケジュールした場合に、アプリケーションがエラーをスローしていました `from` および `to` 新しいスケジュールの開始時にロールバックが使用可能になる時刻。

### ストア

<!-- ENGCOM-7543 -->

* 管理者およびメインストアの切り替えボタンが、管理者でのストアの並べ替え順に加えられた変更を反映するようになりました。 [GitHub-13401](https://github.com/magento/magento2/issues/13401)

<!-- ENGCOM-8274 -->

* ストア表示の最上位 URL キーが変更された後、アプリケーションは、カテゴリと製品に対して正しい URL を作成するようになりました。 以前は、ストアビューのカテゴリツリーに変更が含まれていた場合  `url_keys`カテゴリキーが変更されず、カテゴリの親キーが変更された場合、元のコードは URL の作成時にカテゴリのデフォルトのストア表示を使用していました。 [GitHub-28633](https://github.com/magento/magento2/issues/28633)

### ターゲットルール

<!-- MC-34998-->

* 製品の詳細ページの読み込みが最適化されました。 多くの場合にターゲットルール条件のクエリを最適化するデータベーステーブルのインデックスを追加しました。

<!-- MC-36288-->

* 関連製品のターゲットルールが、 `is one of` 「表示する製品」(Products to Display) 機能に使用される条件には、複数の条件が含まれています。 以前は、この条件に複数の値が含まれていた場合、解析されませんでした。

### 税

<!-- MC-37666-->

* ゲスト注文に対する VAT 検証で、申し込みが見積もりを間違った顧客税区分で保存する結果にならなくなりました。 [GitHub-30018](https://github.com/magento/magento2/issues/30018)

<!-- MC-37761-->

* FPT が設定されている場合、複数のアドレスに出荷される注文をチェックアウト時に保存できるようになりました。 以前は、複数のアドレスの注文を完了すると、注文成功ページではなく空白のページが表示されていました。

<!-- ENGCOM-8158 -->

* ストアフロント製品の詳細ページに、期待どおりに税金を含む古いおよび新しい価格と含まない価格が表示されるようになりました。 [GitHub-27500](https://github.com/magento/magento2/issues/27500), [GitHub-11998](https://github.com/magento/magento2/issues/11998)

### テスト

<!-- MC-37364-->

* `bin/magento dev:tests:run` では、次のテストが期待どおりに起動します。all、unit、integration、integration-all、static、static-all、integrity、legacy および default

<!-- MC-38488-->

* `AdminMediaGalleryInsertLargeImageFileSizeTest` がリファクタリングされました。

<!-- ENGCOM-8158 -->

* 単体テストは、PHPUnit 8 と互換性を持つようになりました。 [GitHub-29779](https://github.com/magento/magento2/issues/29779)

<!-- ENGCOM-8009 -->

* `\Magento\TestFramework\TestCase\WebapiAbstract` には、テストでの期待される結果と実際の結果の大きなネストされた配列の比較をサポートする関数が含まれるようになりました。 結果内の無関係なキーを無視できるようになりました。 [GitHub-29498](https://github.com/magento/magento2/issues/29498)

<!-- ENGCOM-8024 -->

* `AdminMediaGalleryCatalogUiEditCategoryGridPageTest` は、ランダムに失敗しなくなりました。 [GitHub-1764](https://github.com/magento/adobe-stock-integration/issues/1764)

<!-- ENGCOM-8041 -->

* `dev/tests/integration/testsuite/Magento/Customer/Controller/AccountTest` が改善されました。 (`assert` が次の値に基づいています： `XPath` セレクターの代わりに `assertStringContainsString`.) [GitHub-29700](https://github.com/magento/magento2/issues/29700)

<!-- ENGCOM-8017 -->

* テスト対象を `AdminAnalytics` モジュール。 [GitHub-29500](https://github.com/magento/magento2/issues/29500)

<!-- ENGCOM-8266 -->

* 統合および API 機能テストは、PHPUnit 9.3 と互換性があるようになりました。 [GitHub-30146](https://github.com/magento/magento2/issues/30146)

<!-- MC-35798 8109-->

* GraphQL の問題を修正しました `testRequestCacheTagsForCategoryListOnMultipleIds` テスト。 [GitHub-29372](https://github.com/magento/magento2/issues/29372)

<!-- ENGCOM-8327 -->

* 会社クレジットの通貨の可用性テストが自動化されました。

<!-- ENGCOM-7762 -->

* URL を含むヘッダー値が、 `ApiFunctional TestFramewor`k. [GitHub-26425](https://github.com/magento/magento2/issues/26425)

<!-- ENGCOM-8382 -->

* `—no-tablespaces` は、 `mysqldump`：統合テストを、 `PROCESS` 権限（MySQL 5.7.31/8.0.21 以降で実行に必要） `mysqldump` （デフォルト）。 [GitHub-30566](https://github.com/magento/magento2/issues/30566)

### テーマ

<!-- ENGCOM-8419 -->

* 新しい `--no-parent` フラグが `bin/magento setup:static-content:deploy` コマンドを使用して、テーマの親がコンパイルされるのを防ぎます。 この新しいフラグを使用すると、不要なコンパイルを回避して、静的コンテンツデプロイメントプロセスのパフォーマンスを大幅に向上できます。 この新しいフラグは、 `compact` 戦略。 [GitHub-30184](https://github.com/magento/magento2/issues/30184)

<!-- MC-37630 -->

* 設計構成で DDL 操作が生成されなくなりました。 以前は、デザイン構成が更新されると、MySQL エラーをトリガーする DDL 文がアプリケーションで生成されていました。

<!-- ENGCOM-8112 -->

* の冗長コード `Magento_ConfigurableProduct` 管理テーマ内のモジュールが削除されました。  [GitHub-29857](https://github.com/magento/magento2/issues/29857)

<!-- ENGCOM-8144 -->

* 空のテーマの冗長なスタイル数の少ないナビゲーションと使用されていないプロパティが削除されました。 [GitHub-29914](https://github.com/magento/magento2/issues/29914)

<!-- ENGCOM-8285 -->

* モバイル表示の空白のテーマに、折りたたみ可能なナビゲーション機能を追加しました。 [GitHub-30237](https://github.com/magento/magento2/issues/30237)

<!-- ENGCOM-7803 -->

* テーマの Web フォントの読み込みが最適化されました。  [GitHub-29526](https://github.com/magento/magento2/issues/29526)

<!-- ENGCOM-8068 -->

* テーマでカスタムフォントを宣言する際に、フォントの種類を指定できるようになりました。 [GitHub-29719](https://github.com/magento/magento2/issues/29719)

### 翻訳とロケール

<!-- MC-36836 -->

* 管理ロケールがアラビア語 (`ar_SA - Saudi Arabia`) をクリックします。

<!-- MC-38476 -->

* 新しいアドレスの登録または追加時に買い物客がアルゼンチンの住所に有効なポストコードで入力すると、アプリケーションでエラーメッセージが表示されなくなりました。 以前は、アプリケーションで次のエラーが表示されていました。 `Provided Zip/Postal Code seems to be invalid. Example: 1234. If you believe it is the right one you can ignore this notice.`

<!-- MC-38663-->

* 買い物客が韓国語の住所の 5 桁の郵便番号を入力した場合、アプリケーションでエラーがスローされなくなりました。

<!-- ENGCOM-8244 -->

* ウルグアイ地域のサポートを追加しました。 [ISO 3166-2:UY](https://en.wikipedia.org/wiki/ISO_3166-2:UY). [GitHub-29729](https://github.com/magento/magento2/issues/29729)

<!-- ENGCOM-8220 -->

* `zip_codes.xml` は、ブラジルの郵便番号に 8 桁の数字を適用するように更新されました。 [GitHub-29984](https://github.com/magento/magento2/issues/29984)

<!-- ENGCOM-8304 -->

* ローカライズされていない残りのフレーズのローカリゼーションを改善しました。 [GitHub-11175](https://github.com/magento/magento2/issues/11175)

<!-- ENGCOM-8380 -->

* グリッド検索入力プレースホルダーを翻訳できるようになりました。 [GitHub-30510](https://github.com/magento/magento2/issues/30510)

<!-- ENGCOM-8018 -->

* インライン翻訳が有効な場合にのみ、JavaScript モジュールをダウンロードするようになりました。  [GitHub-29553](https://github.com/magento/magento2/issues/29553)

### UI

<!-- MC-38509-->

* この **アカウントの作成** ボタンをクリックしても、買い物客が無効なデータを入力した場合、新規アカウントを作成ページがアクティブなままになります。 以前は、このボタンは無効になっていたので、エラー発生後に買い物客がアカウントを作成し直そうとすることはありませんでした。 これは 2.4.1 での既知の問題です。 [GitHub-30513](https://github.com/magento/magento2/issues/30513)

<!-- MC-38698-->

* 管理注文編集ページでの出荷グリッドの読み込みが改善されました。

<!-- MC-37870-->

* これで、アプリケーションに「  **請求先住所と同じ** 製品が SKU で買い物かごに追加された場合の、注文ページの期待どおりにチェックボックスをオンにします。

<!-- ENGCOM-8007 -->

* 幅の制限を定義した CSS クラスが、 **開始時間** 管理者のフィールド **ストア**  >  **設定**  >  **カタログ**  >  **XML サイトマップ**  >  **生成設定**.  [GitHub-29496](https://github.com/magento/magento2/issues/29496)

<!-- ENGCOM-7992 -->

* 利用条件チェックボックスのラベルの表示の問題を修正しました。  [GitHub-24060](https://github.com/magento/magento2/issues/24060)

<!-- ENGCOM-7948 -->

* 層価格が使用できない場合、製品ページの層価格ブロックの CSS コードがアプリケーションに表示されなくなりました。 [GitHub-29194](https://github.com/magento/magento2/issues/29194)

<!-- ENGCOM-8084 -->

* 画像ビューの詳細ページでのボタンの位置は、ユーザーインターフェイスのガイドラインに従って並べ替えられました。  [GitHub-1783](https://github.com/magento/adobe-stock-integration/issues/1783)

<!-- ENGCOM-8342 -->

* Internet Explorer/EDGE ブラウザーで、クーポンコードテキストフィールドが適切な幅で表示されるようになりました。

<!-- ENGCOM-7630 -->

* この `@button__border-radius` 変数が `lib/web/css/source/lib/variables/_buttons.less` ライブラリ。  `border-radius` のデフォルト値は `3px`. 以前は、 `border-radius` はハードコードされていました。  [GitHub-28674](https://github.com/magento/magento2/issues/28674)

<!-- ENGCOM-8067 -->

* 検索文字列の長さの下限に達するまで、ミニ検索フィールドの送信検索ボタン（虫眼鏡）は無効になります。 [GitHub-29704](https://github.com/magento/magento2/issues/29704)

<!-- MC-38807-->

* この **テンプレートをプレビュー** 「キューを編集」ページでボタンが期待どおりに機能するようになりました。

<!-- MC-35624-->

* カーソルの位置を、 **メッセージ** ～に関して **マイアカウント** > **ギフトレジストリ** > **ギフトレジストリの共有**.

<!-- MC-33497-->

* スケジュール済み書き出しを追加ページの列レイアウトの問題を解決しました。

<!-- MC-31892-->

* 属性をグループ間で移動する際に、アプリケーションが属性の値を保持するようになりました。

<!-- MC-37635-->

* アプリケーションで、 **日付** ストアフロントで期待どおりに入力フィールドアカウントを作成します。

<!-- ENGCOM-8085 -->

* フォントの重い変数を `lib/web/css/source/lib/variables/_typography.less`. [GitHub-29778](https://github.com/magento/magento2/issues/29778)

<!-- ENGCOM-8211 -->

* 管理グリッドで期待どおりにフィルターの表示が列の表示に対して機能するようになりました。  [GitHub-30345](https://github.com/magento/magento2/issues/30345)

<!-- ENGCOM-7977 -->

* ユーザーがスクロールしたときに、アプリケーションが顧客ログインページに表示されるバナーが、ページの先頭に残ったままになりました。 [GitHub-29354](https://github.com/magento/magento2/issues/29354)

<!-- ENGCOM-8152 -->

* UI 選択コンポーネントオプションが、 `this.disabled(true)` が設定されている。 [GitHub-29098](https://github.com/magento/magento2/issues/29098)

<!-- ENGCOM-7901 -->

* この `@font-family-name__base` 変数は、Open Sans フォントの読み込み時に使用されなくなりました。 [GitHub-29515](https://github.com/magento/magento2/issues/29515)

<!-- ENGCOM-8120 -->

* WAI-ARIA 属性 `aria-atomic="true"` がエラーコンテナタグに追加されました。 [GitHub-29560](https://github.com/magento/magento2/issues/29560)

<!-- ENGCOM-8175 -->

* UI コンポーネントのグリッドに、選択した項目の正確な数が表示されるようになりました。 以前は、キーワードによる検索ですべてのグリッド項目が選択され、買い物客がその後一部の項目を選択解除してヘッダーチェックボックスを選択すると、グリッドの選択範囲が正しくなくなっていました。 [GitHub-29968](https://github.com/magento/magento2/issues/29968)

<!-- ENGCOM-8118 -->

* 請求書および出荷の概要ページにレンダリングされていないHTMLが表示されなくなりました。 [GitHub-29958](https://github.com/magento/magento2/issues/29958)

<!-- ENGCOM-8066 -->

* クリック **オプション** 管理者 **ストア**  >  **通貨レート**  「システム設定」ページの拡張通貨オプションセクションに移動するようになりました。 [GitHub-29336](https://github.com/magento/magento2/issues/29336)

<!-- ENGCOM-8361 -->

* 別の条件に応じたウィジェットの表示のサポートを改善 `adminhtml` ウィジェット（選択ウィジェットタイプを使用する場合） [GitHub-13316](https://github.com/magento/magento2/issues/13316), [GitHub-7252](https://github.com/magento/magento2/issues/7252), [GitHub-6868](https://github.com/magento/magento2/issues/6868)

<!-- ENGCOM-8336 -->

* Luma テーマの確認ポップアップダイアログでのテキストのパディングを改善しました。 [GitHub-30452](https://github.com/magento/magento2/issues/30452)

### Vault

<!-- MC-39109-->

* この `Vault` モジュールは、支払い情報管理サービスのリクエストから支払い方法コードを認識するようになりました。 以前は、買い物客が保存済みのBraintreeクレジットカードを使用して注文した場合、有効な支払い方法が使用されていた場合でも、アプリケーションはこのエラーをスローしていました。 `The requested Payment Method is not available`.

### 頂点

* アドレスが変更されると、アドレス候補が期待どおりに削除されるようになりました。

* 一部の顧客が自分のアカウントパネルに住所を保存できなかった競合状態が解決されました。

* 頂点アドレスの検証で、特定の条件で、アドレスの編集ページがフルページキャッシュに追加されなくなりました。

* 税の額を含む金額に対して無料配送が設定された場合、頂点計算税が考慮されるようになりました。

### Web API フレームワーク

<!-- MC-23904 ENGCOM-8421-->

* これで、POST `V1/invoice/:invoiceId/refund` 製品の数量がゼロで、送料がゼロの請求書 ( 例えば、 `{"items": [{"qty": 0, "orderItemId": 6, "extensionAttributes": {}}], "appendComment": false, "notify": true, "isOnline": true, "arguments": {"adjustment_negative": 0.0, "adjustment_positive": 0.99, "shipping_amount": 0}}.` ) 以前は、アプリケーションは次のエラーをスローしていました。 `You can't create a creditmemo without products`. [GitHub-23069](https://github.com/magento/magento2/issues/23069)

<!-- MC-33732 -->

* これで、POST `V1/categories` をクリックして、カテゴリを作成または更新します。 以前は、 `default_sort_by` の値が配列として設定されました。 次の場合に `default_sort_by` の値が文字列として設定された場合、アプリケーションは次のエラーをスローしました： `Error occurred during \"custom_attributes\" processing. Attribute \"default_sort_by\" has invalid value. The \"string\" value's type is invalid. The \"string[]\" type was expected. Verify and try again.`

<!-- MC-35740 -->

* 使用POST `V1/invoices/:id/capture` 支払い情報をキャプチャする機能が期待どおりに動作するようになりました。 以前は、申込者は注文を承認しましたが、支払いゲートウェイのサイトでのみ取り込みました。

<!-- MC-37794 -->

* POST `V1/order/:orderId/ship` 部分出荷を作成するために、エンドポイントは正しい出荷済製品数を返します。

<!-- MC-38425-->

* POST `V1/order/:orderID/invoice` 店舗クレジット別の部分的な支払いを正確に反映するようになりました。 以前は、店舗クレジットで注文が部分的に支払われた場合、店舗クレジットを考慮せずに請求書を作成していました。

<!-- MC-36830-->

* GET `rest/all/V1/categories` およびGET `rest/all/V1/categories?rootCategoryId=2` 呼び出しが返されるようになりました `name` および `product_count` フィールドは、ツリー内のすべてのカテゴリで期待どおりに表示されます。 以前は、カテゴリフィールドの値は空でした。 テーブル名リゾルバープラグインが、カテゴリ別の製品数を取得するために、正しくないテーブル名を返しました。

<!-- ENGCOM-8286 -->

* PUT `V1/categories/:id` エンドポイントで、 `save_rewrites_history` カスタム属性が指定されます。 [GitHub-29174](https://github.com/magento/magento2/issues/29174), [GitHub-30240](https://github.com/magento/magento2/issues/30240)

### ウィッシュリスト

<!-- MC-33626-->

* 買い物客は、製品がカスタム在庫ソースに割り当てられたときに、製品をウィッシュリストに追加できるようになりました。 [GitHub-3018](https://github.com/magento/inventory/issues/3018)

<!-- MC-35416-->

* 管理者は、顧客がストアフロントからウィッシュリストに製品を追加した後、管理顧客ページから買い物かごを管理ページにアクセスできるようになりました。 以前は、管理者が **買い物かごを管理** ボタン： `An error has occurred. See error log for details`.

<!-- MC-35573-->

* この **買い物かごに追加** 共有ウィッシュリストページのボタンが、匿名ユーザー、ゲストユーザー、ログインしていないユーザーで、期待どおりに機能するようになりました。

<!-- MC-34411-->

* 買い物客は、あるウィッシュリストから別のウィッシュリストに製品を正常に移動できるようになりました。

<!-- ENGCOM-8062 -->

* ウィッシュリストページに、選択した設定可能な製品属性オプションが期待どおりに表示されるようになりました。 [GitHub-24091](https://github.com/magento/magento2/issues/24091),  [GitHub-22503](https://github.com/magento/magento2/issues/22503)

<!-- ENGCOM-7779 -->

* 実装済み `ActionInterface` 対象 `\Magento\Wishlist\Controller\Shared\Allcart`. [GitHub-29537](https://github.com/magento/magento2/issues/29537)

## 既知の問題

**問題**:この `[magento_root]/index.php` ファイルが削除され、アプリケーションが次の場所から実行されました： `/pub` Apache 設定の場合はデフォルトです。 サブフォルダーから提供されたストアが期待どおりに動作せず、404 エラーが表示される場合があります。 **回避策**:symlinks を使用して、インストールをサブフォルダにエミュレートします。 次の例では、2 つのストア (`https://shop01.com/shop/` および `https://shop02.com/shop/`) を参照してください。

1. のサブディレクトリを作成 `https://shop01.com/shop/`:

   ```bash
   mkdir magento_root/pub/shop01
   ```

   ```bash
   cd magento_root/pub/shop01
   ```

1. 新しく作成したディレクトリにストアの親ディレクトリのシンボリックリンクを作成します。

   ```bash
   ln -s ../media media
   ```

   ```bash
   ln -s ../static static
   ```

   ```bash
   ln -s ../../../pub pub
   ```

   ```bash
   ln -s ../.htaccess .htaccess
   ```

   ```bash
   ln -s ../health_check.php health_check.php
   ```

1. の作成 `index.php` ファイルを新しいディレクトリ (`magento_root/pub/shop01/index.php`) をクリックし、次のコンテンツを追加します。

```php
   <?php
   require realpath(__DIR__) . '/../../../app/bootstrap.php';

   switch ($_SERVER['HTTP_HOST']) {
       case 'shop01.com':
       case 'www.shop01.com':
           $params = $_SERVER;
           $params[\Magento\Store\Model\StoreManager::PARAM_RUN_CODE] = 'shop01';
           $params[\Magento\Store\Model\StoreManager::PARAM_RUN_TYPE] = 'website';
           $bootstrap = \Magento\Framework\App\Bootstrap::create(BP, $params);
           $app = $bootstrap->createApplication(\Magento\Framework\App\Http::class);
           $bootstrap->run($app);
           break;

       default:
           $bootstrap = \Magento\Framework\App\Bootstrap::create(BP, $_SERVER);
           /** @var \Magento\Framework\App\Http $app */
           $app = $bootstrap->createApplication(\Magento\Framework\App\Http::class);
           $bootstrap->run($app);
       break;
   }
```

1. Apache サーバーを設定して新しいサブディレクトリを指すようにします。 デプロイメント設定は、大きく異なる場合があります。 サーバー設定の例を次に示します。

```xml
   <VirtualHost *:80>
       DocumentRoot "magento_root/pub/shop1"
       ServerName shop01.com
   </VirtualHost>
```

**問題**:マーチャントは、すべてのストアページでグローバル HTTP から HTTPS へのリダイレクトを有効にするために、管理者から Fastly Force TLS 機能を有効にする必要があります。 詳しくは、 [Cloud 上のすべてのページで HTTP を HTTPS にリダイレクト（TLS を強制）](https://support.magento.com/hc/en-us/articles/360006296953) ナレッジベース記事。 <!-- MC-39988-->

**問題**:次を使用することはできません： `addConfigurableProductToCart` GraphQL ミューテーション（Inventory を実行するマルチストアデプロイメントのデフォルト以外のストア表示で、設定可能な製品を買い物かごに追加するため）。 （Luma ストアフロントは影響を受けません。） 次のエラーが表示されます。 `Could not add item to cart. Please check required options and try again`. **回避策**:以下を使用： `addProductsToCart` ミューテーションに置き換えられます。 [GitHub-31660](https://github.com/magento/magento2/issues/31660)<!-- PWA-1298-->

**問題**:買い物客が最初に「支払い」ページの「 CAPTCHA 」フィールドに正しいコードを入力したときに、アプリケーションが支払い情報を期待どおりに送信しないが、次のエラーが表示される。 `There has been an error processing your request`. これは、買い物客が CAPTCHA コードを入力せずに、または CAPTCHA コードを誤って入力して、注文を行おうとした場合にのみ発生します。  **回避策**:ページを更新します。 <!-- MC-40506-->

**問題**:買い物客がクリックすると、Braintreeが期待どおりに注文が作成されます **Venmo で支払う**&#x200B;を使用する必要がありますが、管理者で注文を作成することはできません。 **回避策**:なし。 詳しくは、 [2.4.2 既知の問題：BraintreeVenmo の支払いが機能しません](https://support.magento.com/hc/en-us/articles/360054662652/)  ナレッジベース記事。  <!-- BUNDLE-2894-->

### B2B の既知の問題

**問題**:B2B 購入者は、通常の発注フローを回避するために、オンライン支払い方法を使用できます。 このシナリオは、購入者がチェックアウトの合計を 0 に（例えば、プロモコードやギフトカードで）減らし、その後コードやギフトカードを削除できる場合に発生する可能性があります。 その場合でも、割り当てられたカタログ内の項目の価格に基づいて、適切な金額の注文を行います。 **回避策**:オンライン支払い方法で発注書の承認を有効にする場合、ギフトカードおよびクーポンコードを無効にします。 <!-- B2B-1603-->

**問題**:PayPal Express Checkout を使用して注文を行おうとすると、購入者は買い物かごにリダイレクトされ、 **コンテキスト内モード** は無効です。 <!-- B2B-1604-->

**問題**:購入者が発注を作成し、その後チェックアウトページに移動すると、アプリケーションで 404 エラーが表示されることがあります。 このエラーは、購入者が以前の購入を完了せずにチェックアウトページに移動する前に、オンライン支払い方法で別の発注書を作成した場合に発生します。 購入者は引き続き発注書を配置できます。 **回避策**:なし。 <!-- B2B-1605-->

**問題**:特定の支払い方法の割引は、購入者が最終チェックアウト時に支払い方法を変更した場合でも、発注のチェックアウト時に保持されます。 その結果、顧客は権利のない割引を受ける場合があります。 これは、支払い方法が変更されたにもかかわらず、元の支払い方法の買い物かごルールが適用されているためです。 **回避策**:なし。 詳しくは、 [2.4.2 B2B の既知の問題：支払い方法が変更された後、オンライン発注の割引が残ります](https://support.magento.com/hc/en-us/articles/360054667312) ナレッジベース記事。 <!-- B2B-1012 -->

**問題**:この `deleteRequisitionListOutput` 「問合せ」では、残りの購買依頼リストの代わりに、削除した購買依頼リストに関する詳細が戻されます。 <!-- MC-39894-->

## コミュニティへの貢献

私たちは、より広いMagento Open Sourceコミュニティに感謝し、このリリースに対する彼らの貢献を認めたいと思います。

コミュニティエンジニアリングチーム [Magento寄稿者](https://magento.com/magento-contributors) は、貢献度の高い個人およびパートナーのリストを月、四半期、年別に管理しています。 寄稿者ページから、GitHub 上の結合された PR へのリンクをたどることができます。

### パートナーへの貢献

次の表に、パートナーによる貢献の概要を示します。 この表は、プル要求に貢献したパートナー、外部プル要求、およびそれに関連付けられている GitHub 問題番号（使用可能な場合）を示しています。

{{$include /help/_includes/release-notes/engcomm-2-4-2-partner.md}}

### 個々の投稿者への投稿

次の表に、コミュニティメンバーからの投稿を示します。 この表は、外部のプルリクエスト、関連付けられている GitHub の問題番号（使用可能な場合）、およびプルリクエストを寄稿したコミュニティメンバーを示しています。

{{$include /help/_includes/release-notes/engcomm-2-4-2-issues.md}}

### 必要システム構成

当社の技術スタックは、PHP および MySQL 上で構築されています。 詳しくは、 [必要システム構成](../../../installation/system-requirements.md).

### インストールおよびアップグレードの手順

Adobe Commerce 2.4.2 は、 [コンポーザー](../../../installation/composer.md).

## 移行ツールキット

データ移行ツールは、既存のMagento1.x のストアデータをMagento2.x に転送するのに役立ちます。このコマンドラインインターフェイスには、検証、進行状況の追跡、ログ、テストの各機能が含まれます。 インストール手順については、 [データ移行ツールのインストール](../../../tools/data-migration-tool/install.md). 詳細を調べたり、 [データ移行リポジトリ](https://github.com/magento/data-migration-tool).

この [コード移行ツールキット](https://github.com/magento-commerce/code-migration) は、既存のMagento1.x のストア拡張機能とカスタマイズをMagento2.x に転送するのに役立ちます。コマンドラインインターフェイスには、Magento1.x のモジュールとレイアウトを変換するためのスクリプトが含まれています。
